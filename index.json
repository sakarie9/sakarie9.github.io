[{"content":"","date":"2025-08-21","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"2025-08-21","externalUrl":null,"permalink":"/tags/games/","section":"Tags","summary":"","title":"Games","type":"tags"},{"content":" Introduction # PFS is a proprietary archive format utilized by the Artemis visual novel engine. It functions as a container for game assets, enabling efficient packaging and distribution of multiple files within a single archive.\nThis document presents a comprehensive technical specification of the PFS file format, derived from reverse-engineering analysis. It aims to assist developers in building tools for extracting, inspecting, and modifying PFS archives.\nRelated Tools # I have developed the following tools to facilitate working with PFS files:\npf8: A Rust library offering robust encoding and decoding capabilities for PFS files. pfs-rs: A command-line utility for packing and unpacking PFS archives. sakarie9/pfs-rs Artemis .pfs file unpacker and packer written in rust Rust 16 1 PFS File Format Structure # The PFS format employs a straightforward structure to organize file metadata and content. It begins with a Header section that indexes all contained files, followed immediately by the File Data section. This layout supports efficient random access to any file within the archive.\nNote: All multi-byte integer values in PFS files are stored in little-endian byte order. Header Structure # The header contains global archive information and the index of all files.\nTo represent the variable-length sections, we define the following symbols:\nN: The number of files (value of File Count). S_Entries: The total size in bytes of the File Entries array. S_Offsets: The total size in bytes of the File Size Offsets array (equal to 8 * N). Offset Size Field Name Description 0x00 3 Magic Number File signature: pf8 (or pf6). 0x03 4 Index Size Size of the index data (from 0x07 to end of header). 0x07 4 File Count (N) Total number of files in the archive. 0x0B S_Entries File Entries Array of File Entry structures. 0x0B + S_Entries 4 File Size Count Number of size offsets (typically N + 1). 0x0F + S_Entries S_Offsets File Size Offsets Array of 8-byte offsets pointing to file sizes. 0x0F + S_Entries + S_Offsets 8 Padding Zero-filled padding bytes. 0x17 + S_Entries + S_Offsets 4 Index End Offset Pointer to File Size Count (relative to 0x07). %%{init: {'flowchart': {'nodeSpacing': 15, 'rankSpacing': 15}, 'themeVariables': {'fontSize': '12px'}}}%% graph TD Magic[0x00: Magic Number] --\u003e IndexSize[0x03: Index Size] IndexSize --\u003e FileCount[0x07: File Count] FileCount --\u003e FileEntries[0x0B: File Entries] FileEntries -- Size: S_Entries --\u003e FileSizeCount[File Size Count] FileSizeCount --\u003e FileSizeOffsets[File Size Offsets] FileSizeOffsets -- Size: S_Offsets --\u003e Padding[Padding] Padding --\u003e EndOffset[Index End Offset] style FileEntries fill:#d9d,stroke:#333,stroke-width:2px style FileSizeOffsets fill:#0bf,stroke:#333,stroke-width:2px File Entry Structure # Each file in the archive is described by a variable-length entry in the File Entries section.\nNote: The offsets listed below are relative to the start of the specific file entry.\nRelative Offset Size Field Name Description 0x00 4 Name Length The length of the filename in bytes. 0x04 N File Name The filename string. Length is defined by Name Length. 0x04 + N 4 Separator A separator field, typically filled with null bytes (0x00). 0x08 + N 4 Data Offset The absolute offset of the file\u0026rsquo;s data from the beginning of the PFS file. See Understanding Data Offsets. 0x0C + N 4 File Size The size of the file\u0026rsquo;s data in bytes. Understanding Data Offsets # The Data Offset field specifies the absolute position of the file\u0026rsquo;s content within the archive.\nExample: If a file entry has a Data Offset of 0xBD and a File Size of 0x100:\nThe file\u0026rsquo;s data begins at byte 0xBD of the PFS file. The data ends at byte 0x1BD (0xBD + 0x100). In Rust slice notation: archive_data[0xBD .. 0x1BD]. File Size Offset Structure # %%{init: { \"packet\": { \"bitsPerRow\": 8 } } }%% packet +8: \"File Size Offset\" +8: \"File Size Offset\" +8: \"...\" The File Size Offsets section provides a secondary way to navigate the file entries, specifically pointing to the size fields.\nEach entry is an 8-byte integer. The value is an offset relative to the start of the File Size Offsets array itself. It points to the File Size field of a specific File Entry. Example: If a File Size Offset entry contains 0x25:\nLocate the start of the File Size Offsets array (let\u0026rsquo;s say it\u0026rsquo;s at absolute offset 0xF for simplicity, though it varies). Add 0x25 to that start position. The resulting address points to the 4-byte File Size value of a file entry. Encryption # PFS archives (specifically the pf8 variant) use a custom encryption scheme to protect file data. The encryption uses a stream cipher based on XOR operations with a dynamically generated key.\nKey Generation # The encryption key is derived from the archive\u0026rsquo;s header index data using the SHA-1 hashing algorithm.\nKey Generation Process:\nSource Data: Extract the index data from the archive header\nStart Offset: 0x07 (immediately after the magic number and index size fields) Length: The value specified in the Index Size field (at offset 0x03) This includes the file count, all file entries, file size offsets, padding, and index end offset Hashing: Apply SHA-1 hash to the index data\nAlgorithm: SHA-1 Output: 20-byte (160-bit) hash digest Result: The 20-byte SHA-1 hash serves as the encryption key\n// Key generation example let index_size = read_u32_le(\u0026amp;archive_data[0x03..0x07]); let index_data = \u0026amp;archive_data[0x07 .. 0x07 + index_size as usize]; let key = sha1(index_data); // 20 bytes Encryption Algorithm # The encryption uses a simple but effective XOR stream cipher with the generated key.\nAlgorithm Characteristics:\nMethod: XOR (Exclusive OR) cipher Key Stream: The 20-byte key is repeated cyclically to match the data length Scope: Only file data is encrypted; headers and index structures remain in plaintext Per-File Encryption: Each file is encrypted independently, with the key stream starting from the beginning for each file Encryption Formula:\n$$C_i = P_i \\oplus K_{i \\bmod L}$$Where:\n\\(C_i\\) is the \\(i\\)-th byte of ciphertext (encrypted data) \\(P_i\\) is the \\(i\\)-th byte of plaintext (original data) \\(K\\) is the 20-byte encryption key \\(L = 20\\) (key length in bytes) \\(i\\) is the byte position within the current file (starting from 0 for each file) Encryption Example:\n// Each file is encrypted independently for file in files { let mut file_data = read_file_data(file); // XOR with key starting from offset 0 for this file for (i, byte) in file_data.iter_mut().enumerate() { *byte ^= key[i % key.len()]; } write_encrypted_data(file_data); } For large files that are processed in chunks, the offset is tracked within that file only:\nlet mut offset_in_file = 0; while let Some(chunk) = read_chunk() { for (i, byte) in chunk.iter_mut().enumerate() { *byte ^= key[(offset_in_file + i) % key.len()]; } offset_in_file += chunk.len(); } Decryption # Decryption is identical to encryption due to the XOR cipher\u0026rsquo;s symmetric nature:\n$$P_i = C_i \\oplus K_{i \\bmod L}$$Each file is decrypted independently using the same key, with the key stream restarting from position 0 for each file.\n","date":"2025-08-21","externalUrl":null,"permalink":"/posts/2025/artemis-pfs/","section":"Posts","summary":"A comprehensive analysis of the PFS file format structure used by the Artemis game engine, including detailed breakdowns of headers, file entries, and offset calculations.","title":"Parsing PFS Files Used by the Artemis Engine","type":"posts"},{"content":"","date":"2025-08-21","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"2025-08-21","externalUrl":null,"permalink":"/","section":"Sakari's Blog","summary":"","title":"Sakari's Blog","type":"page"},{"content":"","date":"2025-08-21","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"2025-08-21","externalUrl":null,"permalink":"/categories/%E6%8A%80%E6%9C%AF%E5%88%86%E4%BA%AB/","section":"Categories","summary":"","title":"æŠ€æœ¯åˆ†äº«","type":"categories"},{"content":"","date":"2025-08-12","externalUrl":null,"permalink":"/tags/linux/","section":"Tags","summary":"","title":"Linux","type":"tags"},{"content":"æœ‰äº›ç‰¹å®šç‰ˆæœ¬çš„ Minecraft å¯èƒ½ä¼šåœ¨ Linux/Pipewire ä¸­å­˜åœ¨æ²¡æœ‰å£°éŸ³æˆ–è€…ç›´æ¥å´©æºƒçš„é—®é¢˜\nOpenAL ä¼šä¼˜å…ˆä½¿ç”¨ JACK è€Œé PipeWire çš„ PulseAudio åç«¯ï¼Œå°†å…¶æŒ‡å®šä¸º PulseAudio å¯è§£å†³æ­¤é—®é¢˜\næ–°å»º /etc/openal/alsoft.conf (æˆ– ~/.alsoftrcï¼›æˆ– $XDG_CONFIG_HOME/alsoft.conf)\ndrivers=pulse æˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡ ALSOFT_DRIVERS=pulse ä¹Ÿç”¨åŒæ ·çš„ä½œç”¨\nå‚è€ƒï¼šArchWiki\n","date":"2025-08-12","externalUrl":null,"permalink":"/posts/2025/minecraft-pipewire-audio/","section":"Posts","summary":"","title":"Minecraft åœ¨ Pipewire ä¸Šæ²¡æœ‰å£°éŸ³çš„é—®é¢˜","type":"posts"},{"content":"","date":"2025-08-12","externalUrl":null,"permalink":"/categories/%E6%8A%80%E6%9C%AF%E9%9A%8F%E7%AC%94/","section":"Categories","summary":"","title":"æŠ€æœ¯éšç¬”","type":"categories"},{"content":"","date":"2025-07-27","externalUrl":null,"permalink":"/tags/audio/","section":"Tags","summary":"","title":"Audio","type":"tags"},{"content":" å‰è¨€ # è™½ç„¶åœ¨ Linux ä¸Šåœ¨è¾“å‡ºè®¾å¤‡ä¸Šåº”ç”¨å‡è¡¡å™¨ç­‰éŸ³æ•ˆçš„ä¸€èˆ¬å®è·µæ˜¯ä½¿ç”¨ EasyEffectsï¼Œä½†å¯¹äºç®€å•çš„å‡è¡¡å™¨æ¥è¯´ï¼ŒEE å¤ªé‡äº†ï¼Œè€Œä¸”åœ¨ä½¿ç”¨æ—¶å¶å°”ä¼šå‡ºç°éŸ³é¢‘å¡é¡¿ç­‰å¥‡æ€ªçš„ç°è±¡ã€‚æ­£å¥½ Pipewire æœ¬èº«å°±æœ‰é…ç½®éŸ³æ•ˆçš„åŠŸèƒ½ï¼Œæ‰€ä»¥æœ¬æ–‡å°è¯•ä½¿ç”¨ Pipewire å®ç°å‡è¡¡å™¨ã€‚\nå‡†å¤‡ # é¦–å…ˆç¡®ä¿ Pipewire å·²ç»å®‰è£…å¹¶æ­£å¸¸è¿ä½œã€‚\nç„¶åæ˜ç¡®è¦é…ç½®çš„ EQ çš„å‚æ•°ï¼Œä¾‹å¦‚å‚æ•°å‡è¡¡å™¨ï¼š\nFilter 1 : ON LSC Fc 105.0 Hz Gain 0.6 dB Q 0.70 Filter 2 : ON PK Fc 37.7 Hz Gain -1.0 dB Q 2.06 Filter 3 : ON PK Fc 158.4 Hz Gain -7.1 dB Q 0.69 Filter 4 : ON PK Fc 620.1 Hz Gain 2.6 dB Q 1.78 Filter 5 : ON PK Fc 1097.3 Hz Gain -2.9 dB Q 2.30 Filter 6 : ON PK Fc 2235.0 Hz Gain 3.3 dB Q 2.46 Filter 7 : ON PK Fc 3671.3 Hz Gain 6.9 dB Q 0.98 Filter 8 : ON PK Fc 5803.3 Hz Gain -7.2 dB Q 3.86 Filter 9 : ON PK Fc 8349.1 Hz Gain -2.2 dB Q 3.49 Filter 10: ON HSC Fc 10000.0 Hz Gain 8.7 dB Q 0.70 æˆ–è€…ç®€å•çš„å›¾å½¢å‡è¡¡å™¨ï¼š\n\u0026#34;31.5Hz\u0026#34; : 0.0 \u0026#34;63Hz\u0026#34; : 0.0 \u0026#34;125Hz\u0026#34; : 0.0 \u0026#34;250Hz\u0026#34; : 0.0 \u0026#34;500Hz\u0026#34; : 0.0 \u0026#34;1000Hz\u0026#34; : 0.0 \u0026#34;2000Hz\u0026#34; : 0.0 \u0026#34;4000Hz\u0026#34; : 0.0 \u0026#34;8000Hz\u0026#34; : 0.0 \u0026#34;16000Hz\u0026#34; : 0.0 å¦‚æœæ²¡æœ‰æ‰¾åˆ°é’ˆå¯¹æ‰€ç”¨çš„éŸ³é¢‘è®¾å¤‡çš„å‚æ•°è¡¨ï¼Œå¯ä»¥å°è¯•è‡ªå·±å†™ä¸€ä¸ªã€‚ç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ EasyEffectsï¼Œå…¶å¯ä»¥æ–¹ä¾¿åœ°é¢„è§ˆä¸åŒå‚æ•°çš„æ•ˆæœã€‚\næ‹¥æœ‰åˆé€‚çš„ EQ é…ç½®åï¼Œå¼€å§‹ç¼–å†™é…ç½®æ–‡ä»¶ã€‚\né…ç½® # ä»¥å‚æ•°å‡è¡¡å™¨ä¸ºä¾‹ã€‚\nåˆ›å»º ~/.config/pipewire/pipewire.conf.d/eq.confï¼Œæ–‡ä»¶åå¯ä»¥éšæ„ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š\ncontext.modules = [ { name = libpipewire-module-filter-chain args = { node.description = \u0026#34;EQ Sink\u0026#34; media.name = \u0026#34;EQ Sink\u0026#34; filter.graph = { nodes = [ { type = builtin name = eq_band_1 label = bq_lowshelf control = { \u0026#34;Freq\u0026#34; = 130 \u0026#34;Q\u0026#34; = 0.5 \u0026#34;Gain\u0026#34; = -2.0 } } { type = builtin name = eq_band_2 label = bq_highshelf control = { \u0026#34;Freq\u0026#34; = 3350 \u0026#34;Q\u0026#34; = 1.25 \u0026#34;Gain\u0026#34; = 3.5 } } ] links = [ { output = \u0026#34;eq_band_1:Out\u0026#34; input = \u0026#34;eq_band_2:In\u0026#34; } ] } audio.channels = 2 audio.position = [ FL FR ] capture.props = { node.name = \u0026#34;effect_input.eq\u0026#34; media.class = \u0026#34;Audio/Sink\u0026#34; } playback.props = { node.name = \u0026#34;effect_output.eq\u0026#34; node.passive = true } } } ] ä¸Šé¢çš„é…ç½®æœ€ç»ˆçœ‹èµ·æ¥å°±æ˜¯è¿™æ ·çš„æ›²çº¿ï¼š\nä¸‹é¢æ˜¯å‡ ä¸ªéœ€è¦å…³æ³¨çš„å‚æ•°ï¼š\nå…¶ä¸­ nodes èŠ‚ç‚¹ä¸‹é¢å°±æ˜¯æ¯ä¸ªé¢‘ç‡å¯¹åº”çš„å‚æ•°ï¼Œè¿™é‡Œåªè®¾ç½®ä¸¤ç»„ï¼š\n\u0026#34;Freq\u0026#34; = 130 \u0026#34;Q\u0026#34; = 0.5 \u0026#34;Gain\u0026#34; = -2.0 bq_lowshelf \u0026#34;Freq\u0026#34; = 3350 \u0026#34;Q\u0026#34; = 1.25 \u0026#34;Gain\u0026#34; = 3.5 bq_highshelf Freq: ä¸­å¿ƒé¢‘ç‡ã€‚ Q: å¸¦å®½æˆ– Q å€¼ (Bandwidth/Q-Factor)ï¼Œå½±å“èŒƒå›´çš„å®½åº¦ã€‚Q å€¼è¶Šé«˜ï¼Œå½±å“çš„é¢‘ç‡èŒƒå›´è¶Šçª„ï¼ˆè¶Šå°–é”ï¼‰ï¼›Q å€¼è¶Šä½ï¼Œå½±å“çš„èŒƒå›´è¶Šå®½ï¼ˆè¶Šå¹³ç¼“ï¼‰ã€‚ Gain: å¢ç›Šï¼Œæå‡æˆ–è¡°å‡å¤šå°‘åˆ†è´ (dB)ã€‚ æ»¤æ³¢å™¨: bq_lowshelf/bq_highshelf ç­‰ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ï¼Œå¯ä»¥åœ¨ EasyEffects ä¸­æµ‹è¯•ã€‚ links å°† nodes ä¸²è”èµ·æ¥ï¼Œè¿™é‡Œçš„ä½œç”¨å°±æ˜¯å°† eq_band_1 çš„è¾“å‡ºï¼Œä½œä¸º eq_band_2 çš„è¾“å…¥ã€‚å¦‚æœæœ‰æ›´å¤šåˆ™ä»¥æ­¤ç±»æ¨ï¼Œå°† eq_band_2 çš„è¾“å‡ºä½œä¸º eq_band_3 çš„è¾“å…¥ã€‚å†™æ³•ä¸ºï¼š\nlinks = [ { output = \u0026#34;eq_band_1:Out\u0026#34; input = \u0026#34;eq_band_2:In\u0026#34; } { output = \u0026#34;eq_band_2:Out\u0026#34; input = \u0026#34;eq_band_3:In\u0026#34; } ] media.name å¯ä»¥éšæ„ä¿®æ”¹ï¼Œæœ€ç»ˆä½œä¸ºè¾“å‡ºè®¾å¤‡å‡ºç°åœ¨è¾“å‡ºé€‰æ‹©ä¸­çš„å°±ä¼šæ˜¯è¿™ä¸ªåå­—ã€‚\né…ç½®å®Œæˆä¹‹åä½¿ç”¨ systemctl --user restart pipewire pipewire-pulse wireplumber é‡å¯ pipewire\næ•ˆæœ # å¦‚æœé…ç½®æ­£ç¡®ï¼Œä½ ä¼šåœ¨ pavucontrol ç­‰èƒ½å¤Ÿçœ‹åˆ°è¾“å‡ºè®¾å¤‡çš„è½¯ä»¶ä¸­å‘ç°ä¸€ä¸ªæ–°çš„è¾“å‡ºè®¾å¤‡ EQ Sinkï¼Œå°†å…¶è®¾ç½®ä¸ºé»˜è®¤è¾“å‡ºè®¾å¤‡å°±èƒ½åº”ç”¨åˆ°ä¸Šé¢é…ç½®çš„ EQ äº†ã€‚\nåœ¨ Helvum ä¸­æŸ¥çœ‹ï¼Œèƒ½å‘ç°æ­¤æ—¶ EQ Sink è¿æ¥åˆ°äº†é»˜è®¤ç¡¬ä»¶è¾“å‡ºè®¾å¤‡ä¸Šï¼š\nä¸Šé¢çš„ EQ Sink ä¸ºè¾“å…¥ï¼Œæ‰€æœ‰åº”ç”¨çš„éŸ³é¢‘è¾“å‡ºæ±‡é›†åˆ°å…¶ä¸­ï¼Œå†ç”±ä¸‹é¢çš„ EQ Sink è¾“å‡ºåˆ°ç¡¬ä»¶ã€‚\nå¤šè¾“å‡ºè®¾å¤‡ # ä¸Šè¿°æ–¹æ¡ˆå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚å½“æ‹¥æœ‰å¤šä¸ªç¡¬ä»¶éŸ³é¢‘è¾“å‡ºè®¾å¤‡æ—¶ï¼Œ EQ Sink æœ‰å¯èƒ½è¿æ¥åˆ°é”™è¯¯çš„è®¾å¤‡ä¸Šã€‚\nä¾‹å¦‚ä¸€å°åŒæ—¶æ‹¥æœ‰éŸ³å“å’Œè€³æœºè¾“å‡ºçš„è®¡ç®—æœºï¼Œä¸Šè¿°æ–¹æ¡ˆçš„ EQ Sink ä¼šé€‰æ‹©ä»–è®¤ä¸ºçš„â€œé»˜è®¤â€ç¡¬ä»¶è¾“å‡ºè®¾å¤‡è¿›è¡Œè¿æ¥ï¼Œå°±å¯èƒ½å‡ºç°é¢„æœŸè¾“å‡ºæ˜¯è€³æœºï¼Œä½†å®é™…åœ¨éŸ³å“æ’­æ”¾éŸ³é¢‘çš„æƒ…å†µã€‚\nä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°† EQ ä¸ç¡¬ä»¶è¾“å‡ºè¿›è¡Œç»‘å®šã€‚\nåœ¨é…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ playback.propsï¼š\nplayback.props = { node.name = \u0026#34;effect_output.eq\u0026#34; node.passive = true # åœ¨è¿™é‡Œæ·»åŠ ç›®æ ‡è®¾å¤‡! # å°†ä¸‹é¢çš„å€¼æ›¿æ¢ä¸ºä½ çš„å®é™…è®¾å¤‡å target.object = \u0026#34;alsa_output.pci-0000_30_00.1.hdmi-stereo\u0026#34; target.object çš„å€¼å¯ä»¥ä½¿ç”¨ pw-link -l è¿›è¡ŒæŸ¥çœ‹ã€‚\nå¦‚æ­¤é…ç½®ä¹‹åï¼Œè¾“å‡ºè®¾å¤‡ä¸­çš„ EQ Sink å°†ä¼šæ°¸è¿œä¸ target.object è¿›è¡Œç»‘å®šã€‚\nä¾‹å¦‚å°†å…¶ç»‘å®šåœ¨äº†éŸ³å“ä¸Šï¼Œé‚£ä¹ˆå¦‚æœå°† EQ Sink è®¾ä¸ºé»˜è®¤è¾“å‡ºï¼Œå£°éŸ³ä¼šä»éŸ³å“å‡ºæ¥ã€‚å½“éœ€è¦åˆ‡æ¢åˆ°è€³æœºæ—¶ï¼Œå°†è¾“å‡ºè®¾å¤‡æ›´æ”¹ä¸ºè€³æœºå³å¯ã€‚\nç»“è¯­ # è™½ç„¶ Pipewire é…ç½®èµ·æ¥ç›¸æ¯” EasyEffects æ›´ä¸ºç¹çï¼Œä½†å…¶åŸç”Ÿå®ç°çš„ç‰¹æ€§å¯ä»¥ä¿è¯éŸ³é¢‘é“¾çš„ç›¸å¯¹æ•´æ´ï¼Œå¯èƒ½ä¹Ÿæœ‰ä¸€äº›æ€§èƒ½ä¸Šçš„æé«˜ï¼Œä¹Ÿèƒ½é™ä½ç”±äº EasyEffects ä¾èµ–å›¾å½¢ç•Œé¢è€Œå¢åŠ çš„å†…å­˜å ç”¨ã€‚\nå‚è€ƒ # ä½¿ç”¨ PipeWire å®ç°è‡ªåŠ¨åº”ç”¨å‡è¡¡å™¨ - ä¾äº‘\u0026rsquo;s Blog Linuxå¥½å£°éŸ³ï¼ˆå¹²å‡€çš„å‡è¡¡å™¨ï¼‰ - çŸ¥ä¹ ","date":"2025-07-27","externalUrl":null,"permalink":"/posts/2025/pipewire-eq/","section":"Posts","summary":"","title":"ä½¿ç”¨ Pipewire å®ç°éŸ³é¢‘å‡è¡¡å™¨","type":"posts"},{"content":" é—®é¢˜ # ASUS RT-AC86U ç³»ç»Ÿæ—¥å¿—ä¸­é¢‘ç¹å‡ºç°\nJun 23 21:33:47 kernel: nf_conntrack: expectation table full Jun 23 21:33:47 kernel: nf_conntrack: expectation table full Jun 23 21:33:47 kernel: nf_conntrack: expectation table full Jun 23 21:33:47 kernel: nf_conntrack: expectation table full è§£å†³ # è¿›å…¥è·¯ç”±å™¨çš„ ssh\nä½¿ç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹åŸå§‹å€¼ï¼Œæ­¤æ—¶ä¸º 150\ncat /proc/sys/net/netfilter/nf_conntrack_expect_max ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å°†é»˜è®¤å€¼æé«˜\nnvram set ct_expect_max=1024 nvram commit é‡å¯ç”Ÿæ•ˆ\nreboot ","date":"2025-06-23","externalUrl":null,"permalink":"/posts/2025/asus-router-nf/","section":"Posts","summary":"å¦‚ä½•è§£å†³ kernel: nf_conntrack: expectation table full","title":"ASUS Router nf_conntrack expectation table full","type":"posts"},{"content":"","date":"2025-06-23","externalUrl":null,"permalink":"/tags/network/","section":"Tags","summary":"","title":"Network","type":"tags"},{"content":" å‚è€ƒ Patching packages - ArchWiki\nå‰è¨€ # ä¾‹å¦‚ï¼Œè¦å¯¹ waybar-git åº”ç”¨ä¸€ä¸ª å°šæœªåˆå¹¶çš„ pr (å‡è®¾ä¸º #114514)\nå¦‚æœä¸ä½¿ç”¨ Arch build systemï¼Œéœ€è¦æ‰‹åŠ¨æ„å»ºåŒ…ï¼Œä¸åˆ©äºè½¯ä»¶åŒ…çš„ç®¡ç†\nå› æ­¤é€šè¿‡ä¿®æ”¹ PKGBUILD çš„æ–¹å¼ï¼Œå¯¹è½¯ä»¶åŒ…è¿›è¡Œ patch\næ­¥éª¤ # è·å– patch # å¯¹äº GitHub æˆ–è€… GitLabï¼Œå¯ä»¥åœ¨ URL åé™„åŠ  .patch æ¥ä¸ºç‰¹å®šæäº¤æˆ–åˆå¹¶/æ‹‰å–è¯·æ±‚ç”Ÿæˆè¡¥ä¸\nä¾‹å¦‚ https://github.com/Alexays/Waybar/pull/114514.patch\nPKGBUILD # ä» Arch Linux GitLab æˆ–è€… AUR è·å¾—å¯¹åº”åŒ…çš„ PKGBUILDï¼Œå¦‚æœåŒ…æ‹¬å…¶ä»–æ–‡ä»¶éœ€è¦ä¸€å¹¶ä¸‹è½½\nå°†è·å–åˆ°çš„ patch é“¾æ¥æˆ–è€… patch æ–‡ä»¶æ·»åŠ åˆ°å°† PKGBUILD ä¸­çš„ source å†…ï¼ŒåŒæ—¶æ·»åŠ å¯¹åº”çš„ checksum\nç„¶ååº”ç”¨è¡¥ä¸ï¼Œåœ¨ prepare() ä¸­æ·»åŠ \nprepare() { cd $pkgname-$pkgver # edit patch -Np1 -i ../114514.patch } æ„å»º # å®Œæˆä¸Šè¿°æ­¥éª¤å’Œå°±å¯ä»¥ä½¿ç”¨ makepkg æˆ–è€… extra-x86_64-build æ„å»ºåŒ…äº†\næ³¨æ„å¦‚æœè½¯ä»¶æºä¸­çš„åŒ…æ›´æ–°åç‰ˆæœ¬æ¯” patch è¿‡çš„åŒ…æ›´æ–°ï¼Œåˆ™ patch è¿‡çš„åŒ…ä¼šè¢«è¦†ç›–ï¼Œéœ€è¦æ›´æ–° PKGBUILD åé‡æ–°æ„å»º\n","date":"2025-05-07","externalUrl":null,"permalink":"/posts/2025/arch-abs-patch/","section":"Posts","summary":"","title":"Arch åº”ç”¨è½¯ä»¶åŒ…è¡¥ä¸","type":"posts"},{"content":" å‰è¨€ # å½“ Linux ä¸­å­˜åœ¨å¤šå¼ æ˜¾å¡æ—¶ï¼Œç†æ‰€å½“ç„¶çš„ä¼šå­˜åœ¨ç¨‹åºæ˜¾å¡é€‰æ‹©ä¸Šçš„é—®é¢˜ã€‚\nä¾‹å¦‚æ¸¸æˆé€‰æ‹©äº†æ ¸æ˜¾è€Œéç‹¬æ˜¾è¿è¡Œï¼Œæµè§ˆå™¨é€‰æ‹©äº†è§£ç å•å…ƒè¾ƒå¼±ä¸”è¾ƒä¸ºè€—ç”µçš„ç‹¬æ˜¾è¿è¡Œã€‚\nè¿™äº›æ˜¯ç”¨æˆ·æ‰€ä¸å¸Œæœ›çš„è¡Œä¸ºï¼Œæ‰€å¹¸ï¼Œmesa ç»™æˆ‘ä»¬æä¾›äº†ä¸€äº›å¯ä»¥æ‰‹åŠ¨æŒ‡å®šæ˜¾å¡è®¾å¤‡çš„ç¯å¢ƒå˜é‡ã€‚\né»˜è®¤æƒ…å†µ # æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ MESA_VK_DEVICE_SELECT=list vulkaninfo æŸ¥çœ‹å½“å‰å¯ç”¨çš„æ˜¾å¡ä¿¡æ¯ã€‚\nselectable devices: GPU 0: 1002:67df \u0026#34;AMD Radeon RX 580 Series (RADV POLARIS10)\u0026#34; discrete GPU 0000:10:00.0 GPU 1: 1002:1638 \u0026#34;AMD Radeon Graphics (RADV RENOIR)\u0026#34; integrated GPU 0000:30:00.0 ä¾‹å¦‚è¿™é‡Œæ‹¥æœ‰ä¸¤å¼ æ˜¾å¡ï¼ŒGPU 0 ä¸ºç‹¬ç«‹æ˜¾å¡ (dGPU)ï¼ŒGPU 1 ä¸ºæ ¸æ˜¾ (iGPU)ã€‚\nä½¿ç”¨ glxinfo å’Œ vkcube æ¥è¿›è¡Œ opengl å’Œ vulkan åº”ç”¨çš„ç®€å•æµ‹è¯•ã€‚\nâ¯ glxinfo | rg Device Device: AMD Radeon Graphics (radeonsi, renoir, ACO, DRM 3.61, 6.14.2-2-cachyos) (0x1638) â¯ vkcube Selected WSI platform: xcb Selected GPU 1: AMD Radeon RX 580 Series (RADV POLARIS10), type: DiscreteGpu å…¶ä¸­ glxinfo é€‰æ‹©äº†æ ¸æ˜¾ï¼Œè€Œ vkcube é€‰æ‹©äº†ç‹¬æ˜¾ã€‚\næ ¹æ® mesa #24750 æ‰€è¿°ï¼Œvkcube ä¼¼ä¹æ€»æ˜¯ä¼šä¼˜å…ˆé€‚ç”¨ç‹¬æ˜¾\nç¯å¢ƒå˜é‡ # åœ¨ mesa çš„æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°å…¶ä¸­ DRI_PRIME å’Œ MESA_VK_DEVICE_SELECT è¿™ä¸¤ä¸ªå˜é‡æ˜¯å’Œè®¾å¤‡é€‰æ‹©ç›¸å…³çš„ã€‚\nDRI_PRIME\né»˜è®¤ GPU æ˜¯ Wayland/Xorg ä½¿ç”¨çš„æˆ–è¿æ¥åˆ°æ˜¾ç¤ºå™¨çš„ GPUã€‚æ­¤å˜é‡å…è®¸é€‰æ‹©ä¸åŒçš„ GPUã€‚å®ƒé€‚ç”¨äº OpenGL å’Œ Vulkanï¼ˆåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œâ€œé€‰æ‹©â€æ„å‘³ç€è¯¥ GPU å°†æ’åœ¨æŠ¥å‘Šçš„ç‰©ç†è®¾å¤‡åˆ—è¡¨çš„é¦–ä½ï¼‰ã€‚æ”¯æŒçš„è¯­æ³•æœ‰ï¼š\nDRI_PRIME=N : é€‰æ‹©ç¬¬ N ä¸ªéé»˜è®¤ GPUï¼ˆN \u0026gt; 0ï¼‰ã€‚ DRI_PRIME=pci-0000_02_00_0 : é€‰æ‹©è¿æ¥åˆ°æ­¤ PCIe æ€»çº¿çš„ GPU DRI_PRIME=vendor_id:device_id : é€‰æ‹©åŒ¹é…è¿™äº› ID çš„ç¬¬ä¸€ä¸ª GPUã€‚ å¯¹äº Vulkanï¼Œå¯ä»¥é™„åŠ  ! ï¼Œè¿™æ ·åªæœ‰é€‰å®šçš„ GPU ä¼šæš´éœ²ç»™åº”ç”¨ç¨‹åºï¼ˆä¾‹å¦‚ï¼šDRI_PRIME=1!ï¼‰ã€‚\nMESA_VK_DEVICE_SELECT\nå½“è®¾ç½®ä¸ºâ€œlistâ€æ—¶ï¼Œæ‰“å°è®¾å¤‡åˆ—è¡¨ã€‚å½“è®¾ç½®ä¸ºâ€œvid:didâ€æ—¶ï¼Œä» PCI è®¾å¤‡ä¸­é€‰æ‹©ç¼–å·ã€‚è¯¥ PCI è®¾å¤‡å°†è¢«è®¾ä¸ºé»˜è®¤è®¾å¤‡ã€‚é»˜è®¤è®¾å¤‡ä¼šåœ¨ vkEnumeratePhysicalDevices API ä¸­ä½œä¸ºç¬¬ä¸€ä¸ªè®¾å¤‡è¿”å›ã€‚ä½¿ç”¨â€œvid:did!â€çš„æ•ˆæœä¸ä½¿ç”¨ MESA_VK_DEVICE_SELECT_FORCE_DEFAULT_DEVICE å˜é‡ç›¸åŒã€‚å³è¢«è¯†åˆ«ä¸ºé»˜è®¤çš„è®¾å¤‡å°†æ˜¯ vkEnumeratePhysicalDevices API ä¸­å”¯ä¸€è¿”å›çš„è®¾å¤‡ã€‚\né…ç½® # ç”±äº DRI_PRIME å·²ç»é€‚ç”¨äº OpenGL å’Œ Vulkanï¼Œä¸€èˆ¬æƒ…å†µä¸‹åªéœ€è¦é…ç½®å®ƒå°±è¶³å¤Ÿäº†ã€‚\nç»æµ‹è¯•ï¼Œåœ¨ä¸¤è€…åŒæ—¶è®¾ç½®æ—¶ï¼ŒMESA_VK_DEVICE_SELECT ä¼¼ä¹ä¼šä¼˜å…ˆäº DRI_PRIME å¯¹ vkcube ç”Ÿæ•ˆ\nè™½ç„¶ DRI_PRIME æ”¯æŒ DRI_PRIME=N çš„å†™æ³•ï¼Œè¿™é‡Œä¸å»ºè®®è¿™æ ·ä½¿ç”¨ï¼Œå› ä¸º DRI_PRIME=N! å¹¶ä¸èƒ½å¼ºåˆ¶ä½¿åº”ç”¨ä½¿ç”¨åºå·ä¸º N çš„æ˜¾å¡ã€‚\nâ¯ DRI_PRIME=0! vkcube Selected WSI platform: xcb Selected GPU 1: AMD Radeon RX 580 Series (RADV POLARIS10), type: DiscreteGpu â¯ DRI_PRIME=1! vkcube Selected WSI platform: xcb Selected GPU 0: AMD Radeon RX 580 Series (RADV POLARIS10), type: DiscreteGpu è€Œä½¿ç”¨ DRI_PRIME=vendor_id:device_id! æ—¶æ­£å¸¸è¿ä½œã€‚\nâ¯ DRI_PRIME=1002:1638! vkcube Selected WSI platform: xcb Selected GPU 0: AMD Radeon Graphics (RADV RENOIR), type: IntegratedGpu å› æ­¤ï¼Œåœ¨æˆ‘ä»¬æƒ³è¦æŒ‡å®šæ˜¾å¡çš„åº”ç”¨ç¨‹åºè¿è¡Œå‰åŠ ä¸Š DRI_PRIME=vendor_id:device_id! å°±èƒ½å¼ºåˆ¶ä½¿å…¶ä½¿ç”¨æŒ‡å®šçš„æ˜¾å¡äº†ã€‚\næ˜¾å¡ç¡çœ  # åœ¨åŒæ—¶æ‹¥æœ‰æ ¸æ˜¾å’Œç‹¬æ˜¾çš„ç¬”è®°æœ¬ç­‰è®¾å¤‡ä¸Šï¼Œæœ‰æ—¶ç”¨æˆ·ä¼šå¸Œæœ›ä½¿ç”¨æ ¸æ˜¾å®Œæˆæ¡Œé¢æ¸²æŸ“ã€è§†é¢‘è¾“å‡ºç­‰æ‰€æœ‰å·¥ä½œï¼Œåªæœ‰åœ¨æ¸¸æˆ/AI æ—¶ï¼Œæ˜¾å¼è°ƒç”¨ç‹¬æ˜¾ï¼Œåœ¨ä¸ä½¿ç”¨ç‹¬æ˜¾æ—¶å¸Œæœ›ç‹¬æ˜¾èƒ½è¿›å…¥ç¡çœ çŠ¶æ€çœç”µã€‚\né¦–å…ˆæŸ¥çœ‹æ˜¾å¡å¯¹åº”çš„ card*ï¼š\nâ¯ ls -l /dev/dri/by-path/ lrwxrwxrwx 1 root root 8 12æœˆ 5æ—¥ 18:22 pci-0000:10:00.0-card -\u0026gt; ../card1 lrwxrwxrwx 1 root root 13 12æœˆ 5æ—¥ 18:22 pci-0000:10:00.0-render -\u0026gt; ../renderD128 lrwxrwxrwx 1 root root 8 12æœˆ 5æ—¥ 18:22 pci-0000:30:00.0-card -\u0026gt; ../card2 lrwxrwxrwx 1 root root 13 12æœˆ 5æ—¥ 18:22 pci-0000:30:00.0-render -\u0026gt; ../renderD129 â¯ lspci -nn | grep -i vga 10:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Ellesmere [Radeon RX 470/480/570/570X/580/580X/590] [1002:67df] (rev e7) 30:00.0 VGA compatible controller [0300]: Advanced Micro Devices, Inc. [AMD/ATI] Cezanne [Radeon Vega Series / Radeon Vega Mobile Series] [1002:1638] (rev c9) è¿™é‡Œå¾—åˆ°æˆ‘çš„ç‹¬æ˜¾æ˜¯ card1ï¼Œç”¨è‡ªå·±çš„æ›¿æ¢ä¸‹åˆ—å‘½ä»¤ä¸­çš„ card1ã€‚\né¦–å…ˆç¡®è®¤ cat /sys/class/drm/card1/device/power/control éœ€è¦ä¸º autoã€‚\nç„¶åç”¨ cat /sys/class/drm/card1/device/power/runtime_status æŸ¥çœ‹å½“å‰æ˜¾å¡çŠ¶æ€ï¼Œactive ä¸ºæ˜¾å¡æ­£åœ¨è¿è¡Œï¼Œsuspended ä¸ºå·²ç¡çœ ï¼Œæ­£å¸¸æƒ…å†µä¸‹é—²ç½® 5s å·¦å³å°±ä¼šè¿›å…¥ç¡çœ ã€‚\nå¦‚æœæ˜¾å¡æ— æ³•è¿›å…¥ç¡çœ ï¼Œå¯èƒ½æœ‰å¤šç§æƒ…å†µï¼š\nè¢«å ç”¨ ä½¿ç”¨ sudo fuser -v /dev/dri/renderD128 æŸ¥çœ‹å ç”¨æ˜¾å¡çš„è¿›ç¨‹ éŸ³é¢‘é©±åŠ¨å ç”¨ ä½¿ç”¨ echo '0000:10:00.1' | sudo tee /sys/bus/pci/drivers/snd_hda_intel/unbind è§£ç»‘æ˜¾å¡çš„ HDMI éŸ³é¢‘è¾“å‡ºé©±åŠ¨ï¼Œæ³¨æ„æ‰§è¡Œåæ­¤æ˜¾å¡å°†æ— æ³•è¾“å‡ºå£°éŸ³ 0000:10:00.1 ä½¿ç”¨ lspci -nn | grep -i audio è·å– Vulkan # Vulkan å­˜åœ¨çš„é—®é¢˜æ˜¯ï¼Œå…¶åœ¨åˆå§‹åŒ–æ—¶ä¼šéå†å”¤é†’æ‰€æœ‰æ˜¾å¡ï¼Œå³ä½¿ Vulkan ç¨‹åºåœ¨åç»­ä¸ä¼šä½¿ç”¨è¿™å¼ æ˜¾å¡ã€‚\nå¯¹æ­¤æ²¡æœ‰ä»€ä¹ˆå¥½çš„æ‰‹æ®µè§„é¿ï¼Œåªèƒ½é€šè¿‡ DRI_PRIME=vendor_id:device_id! çš„æ–¹å¼å¼ºè¡Œè®©ç¨‹åºåªåœ¨åˆå§‹åŒ–æ—¶å”¤é†’ä¸€æ¬¡æ˜¾å¡ï¼Œåç»­ä¸å†ä½¿ç”¨ã€‚\nå¦‚æœåªä½¿ç”¨ DRI_PRIME=vendor_id:device_idï¼Œç¨‹åºä¼šåœ¨åç»­ä¾ç„¶å ç”¨æ˜¾å¡ï¼Œè¡¨ç°ä¸ºï¼š\nâ¯ sudo fuser -v /dev/dri/renderD128 ç”¨æˆ· è¿›ç¨‹å· æƒé™ å‘½ä»¤ /dev/dri/renderD128: sakari 17133 F.... chromium sakari 18849 F.... electron sakari 60517 F...m vkcube æƒé™å¤šäº† mï¼Œå³ Mappedï¼Œæœ‰äº†å®ƒæ˜¾å¡å°±ä¸ä¼šè¿›å…¥ç¡çœ ã€‚\nåº”ç”¨ # ä½¿ç”¨ MESA_VK_DEVICE_SELECT=list vulkaninfo æŸ¥çœ‹æ˜¾å¡ idï¼Œæ›¿æ¢ä¸‹é¢æ ·ä¾‹ä¸­çš„ vid:did\nä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä½¿ç”¨å¸¦æ„Ÿå¹å· DRI_PRIME=vid:did! çš„å¹¶ä¸å¿…è¦ï¼Œå…¶ä¼šä½¿ vid:did å¯¹åº”çš„è®¾å¤‡æˆä¸ºåº”ç”¨ç¨‹åºä¸­å”¯ä¸€å¯è§çš„è®¾å¤‡ã€‚\nå»ºè®®ä»…å½“æŒ‡å®šäº†è®¾å¤‡ï¼Œä½†åº”ç”¨ä»ç„¶é»˜è®¤ä½¿ç”¨å¦ä¸€å¼ æ˜¾å¡æˆ–åŒæ—¶ä½¿ç”¨å¤šå¼ æ˜¾å¡æ—¶æ‰ä½¿ç”¨ !ã€‚\nSteam # å³é”®æ¸¸æˆ - å±æ€§ - é€šç”¨ - å¯åŠ¨é€‰é¡¹ä¸­å¡«å…¥ DRI_PRIME=vid:did %command% å³å¯ã€‚\nå‘½ä»¤è¡Œç¨‹åº # DRI_PRIME=vid:did example_binary\næˆ–\nenv DRI_PRIME=vid:did example_binary\né€šè¿‡ drun æˆ– launcher å¯åŠ¨çš„è½¯ä»¶ # ä¿®æ”¹å…¶å…¥å£ /usr/share/applications/whatever.desktopï¼Œåœ¨ Exec å­—æ®µæœ€å‰é¢æ’å…¥ env DRI_PRIME=vid:didã€‚\nä¾‹å¦‚ Exec=env DRI_PRIME=vid:did whatever %F\nå»ºè®®å°†å¯¹åº”çš„ .desktop æ–‡ä»¶å¤åˆ¶åˆ° ~/.local/share/applications/ ä¸­ï¼Œé¿å…åº”ç”¨æ›´æ–°å .desktop è¢«è¦†ç›–\nå…¨å±€ # ä¸å¤ªæ¨èï¼Œå¯èƒ½ä¼šæåä¸€äº›ä¸œè¥¿\nå¦‚æœåœ¨å°†æ˜¾å¡ Aï¼ˆä¾‹å¦‚æ ¸æ˜¾ï¼‰ç”¨ä½œæ‰€æœ‰çš„æ¡Œé¢æ¸²æŸ“ã€è§†é¢‘è¾“å‡ºï¼ˆè¿æ¥æ˜¾ç¤ºå™¨ï¼‰ï¼›æ˜¾å¡ B åªåœ¨è¿è¡Œæ¸¸æˆã€AI æˆ–å…¶ä»–æ›´é€‚åˆåœ¨ B ä¸Šè¿è¡Œçš„ä»»åŠ¡æ—¶æ‰‹åŠ¨æŒ‡å®šè°ƒç”¨ï¼Œåˆ™å¯ä»¥è€ƒè™‘å°† DRI_PRIME è®¾ç½®ä¸ºå…¨å±€å˜é‡ã€‚è¿™æ ·å¯ä»¥å°†å¤§éƒ¨åˆ†çš„æ—¥å¸¸ä»»åŠ¡è´Ÿè½½ä»æ˜¾å¡ B ä¸Šè½¬ç§»åˆ°æ˜¾å¡ Aï¼Œå¯ä»¥ç»´æŒæ˜¾å¡ B çš„é•¿æ—¶é—´ä¼‘çœ ä»¥çœä¸‹ä¸€äº›ç”µä»¥åŠé™ä½äº›è®¸æ¸©åº¦ï¼ˆç†è®ºä¸Šï¼‰ã€‚\nç¼–è¾‘ /etc/environmentï¼ˆå¯¹ç³»ç»Ÿç”Ÿæ•ˆï¼‰æˆ–è€… ~/.profile ï¼ˆå¯¹ç”¨æˆ·ç”Ÿæ•ˆï¼‰ï¼Œæ·»åŠ  DRI_PRIME=vid:didã€‚\nåŒ…è£…è„šæœ¬ # ä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªè„šæœ¬æ¥æ›´æ–¹ä¾¿åœ°ä½¿ç”¨ç¯å¢ƒå˜é‡ã€‚æˆ–è€…åŒæ—¶ä½¿ç”¨ mangohud gamemode ç­‰ã€‚\nåœ¨ ~/.local/bin ä¸­åˆ›å»ºä¸€ä¸ªè„šæœ¬ exec-dgpuã€‚\n#!/bin/bash DRI_PRIME=vid:did \u0026#34;$@\u0026#34; åœ¨è¿è¡Œè½¯ä»¶æ—¶åªéœ€è¦ exec-dgpu whatever å³å¯ã€‚\n","date":"2025-04-14","externalUrl":null,"permalink":"/posts/2025/linux-multi-gpu-select/","section":"Posts","summary":"å¤šæ˜¾å¡è®¾å¤‡ä¸­çš„æ˜¾å¡æŒ‡å®šæ–¹å¼å’Œè®¾ç½®","title":"Linux å¤šæ˜¾å¡è®¾å¤‡ä¸­çš„æ˜¾å¡æŒ‡å®š","type":"posts"},{"content":" å‰è¨€ # åœ¨ /etc/systemd/resolved.conf ä¸­é…ç½®çš„ DNSï¼Œä¼˜å…ˆçº§æ€»æ˜¯ä½äºæ¥å£é…ç½®çš„ DNS\næŒ‰ç…§ æ¥å£DNS -\u0026gt; æ¥å£DHCP DNS -\u0026gt; resolved çš„ä¼˜å…ˆçº§ä¾æ¬¡ç”Ÿæ•ˆ\nä¾‹å¦‚ä½¿ç”¨ resolvectl status\nGlobal Protocols: +LLMNR +mDNS DNSOverTLS=opportunistic DNSSEC=no/unsupported resolv.conf mode: stub Current DNS Server: 223.5.5.5#dns.alidns.com DNS Servers: 223.5.5.5#dns.alidns.com Fallback DNS Servers: 1.0.0.1#cloudflare-dns.com 9.9.9.9#dns.quad9.net 2606:4700:4700::1111#cloudflare-dns.com 2620:fe::9#dns.quad9.net DNS Domain: ~. Link 2 (enp34s0) Current Scopes: DNS LLMNR/IPv4 LLMNR/IPv6 mDNS/IPv4 mDNS/IPv6 Protocols: +DefaultRoute +LLMNR +mDNS DNSOverTLS=opportunistic DNSSEC=no/unsupported Current DNS Server: 2400:3200::1 DNS Servers: 223.5.5.5 192.168.50.1 2400:3200::1 Default Route: yes å¯ä»¥çœ‹åˆ° enp34s0 ä¸­å·²ç»å­˜åœ¨ DNSï¼Œè¿™æ˜¯ä» DHCP ä¸­è·å–çš„\nä½†æˆ‘ä»¬æƒ³è¦å…¨å±€æ§åˆ¶ DNSï¼Œåœ¨ /etc/systemd/resolved.conf ä¸­é…ç½®çš„ DNS ä½œä¸ºå…¨å±€ç”Ÿæ•ˆ\né…ç½® # systemd-networkd # åœ¨å¯¹åº”æ¥å£çš„ network æ–‡ä»¶ï¼Œä¾‹å¦‚ /etc/systemd/network/enp34s0.network ä¸­ç¦ç”¨ DHCP DNS\n[Network] DHCP=yes [DHCPv4] UseDNS=no [DHCPv6] UseDNS=no å¦‚æœåœ¨ä½¿ç”¨ IPv6AcceptRAï¼Œè¿˜éœ€è¦ç¦ç”¨å®ƒçš„ DNS\n[Network] IPv6AcceptRA = true [IPv6AcceptRA] UseDNS=no NetworkManager # è¿™é‡Œä½¿ç”¨ nmtuiï¼Œåœ¨ ç¼–è¾‘è¿æ¥-é€‰æ‹©æ¥å£ ä¸­ï¼Œåˆ†åˆ«åœ¨ IPv4 é…ç½® å’Œ IPv6 é…ç½®ä¸­ï¼Œå‹¾é€‰ å¿½ç•¥è‡ªåŠ¨è·å–çš„DNSå‚æ•°ï¼Œä½¿ç”¨ç©ºæ ¼åœ¨é€‰é¡¹ä¸Šæ‰“é’©\né…ç½®å®Œæˆååº”è¯¥å¦‚ä¸‹ï¼Œæ¥å£çš„ DNS ä¼šæ¶ˆå¤±\nGlobal Protocols: +LLMNR +mDNS DNSOverTLS=opportunistic DNSSEC=no/unsupported resolv.conf mode: stub Current DNS Server: 223.5.5.5#dns.alidns.com DNS Servers: 223.5.5.5#dns.alidns.com Fallback DNS Servers: 1.0.0.1#cloudflare-dns.com 9.9.9.9#dns.quad9.net 2606:4700:4700::1111#cloudflare-dns.com 2620:fe::9#dns.quad9.net DNS Domain: ~. Link 2 (enp34s0) Current Scopes: LLMNR/IPv4 LLMNR/IPv6 mDNS/IPv4 mDNS/IPv6 Protocols: -DefaultRoute +LLMNR +mDNS DNSOverTLS=opportunistic DNSSEC=no/unsupported Default Route: no ","date":"2025-03-12","externalUrl":null,"permalink":"/posts/2025/systemd-resolved-dns/","section":"Posts","summary":"","title":"è®© systemd-resolved å…¨å±€ç”Ÿæ•ˆ","type":"posts"},{"content":" \u0026lt;input placeholder=\"æ•°å­—é—´é€—å·åˆ†éš”\" value=\"1,3,5,7,?\" id=\"numbers\" /\u003e \u0026lt;h1\u003eè¯•ç€æ‰¾å‡ºé—®å·æ‰€ä»£è¡¨çš„æ•°\u0026lt;/h1\u003e \u0026lt;p\u003e æ­£ç¡®ç­”æ¡ˆæ˜¯\u0026lt;/p\u003e \u0026lt;mark\u003e114514\u0026lt;/mark\u003e \u0026lt;p\u003eå› ä¸ºå½“\u0026lt;/p\u003e \u0026lt;div id=\"function\"\u003e\u0026lt;/div\u003e \u0026lt;ul id=\"function-values\"\u003e\u0026lt;/ul\u003e \u0026lt;p\u003eçœŸæœ‰é€»è¾‘ï¼çœŸæ˜¯æœ‰è¶£ï¼å“‡ï¼æ•°å­¦ï¼å“‡ï¼\u0026lt;/p\u003e html, body { height: 100%; background: hsl(216, 69%, 95%); } input { border: 3px solid rgba(0, 0, 0, .09); border-radius: 8px; font-size: 45px; text-align: center; background: transparent; color: hsl(216, 90%, 43%); font-family: 'Monaco', monospace; font-weight: 700; transition: border .2s ease, background .2s ease; outline: none; background: rgba(0, 0, 0, .01); max-width: 95vw; } input:hover { border: 3px solid rgba(0, 0, 0, .23); } input:focus { border: 3px solid hsl(216, 90%, 43%); background: hsla(204, 100%, 88%, .4); } body { margin: 0; padding: 10vh 0 5vh; display: flex; flex-direction: column; align-items: center; } mark { background: hsl(138, 56%, 85%); color: hsl(138, 90%, 43%); font-family: \u0026lsquo;Monaco\u0026rsquo;, monospace; font-weight: 700; margin: 12px; padding: 0 16px; height: 64px; line-height: 64px; font-size: 40px; border-radius: 32px; }\nul \u0026gt; li { list-style: none; }\n.homo-value { color: hsl(15, 99%, 57%); }\n//çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆnå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼‰æ±‚è§£åº“ import * as linear from \"https://cdn.skypack.dev/linear-solve@1.2.1\"; const functionContainer = document.getElementById('function'); const functionValuesContainer = document.getElementById('function-values'); document.getElementById('numbers').addEventListener('input', ({target}) =\u003e { //æ¸…é™¤æ—§å‡½æ•° functionValuesContainer.innerHTML = ''; functionContainer.innerHTML = ''; const numbers = target.value.split(',').map(number =\u003e { const parsed = parseFloat(number); return isFinite(parsed) ? parsed : 114514; //NaNã€Infinityå½“é—®å·å¤„ç† }); const exponents = Array(numbers.length).fill(numbers.length - 1).map((number, exponent) =\u003e number - exponent); const products = linear.solve(Array(numbers.length).fill(0).map( (v, index) =\u003e exponents.map(exponent =\u003e (index + 1) ** exponent) ), [...numbers]) .map((solution, index, solutions) =\u003e { let product = ''; if(solution) { if(index) product += solution \u003e 0 ? '+' : '-'; product += Math.abs(solution).toFixed(3); if(solutions.length - index - 1) { product += 'x'; if(solutions.length - index - 2) product += `^${exponents[index]}`; } } return product; }); katex.render(`f(x) = ${products.join('')}`, functionContainer, { throwOnError: false }); for(let [index, number] of numbers.entries()) { const functionValue = document.createElement('li'); if(number === 114514) functionValue.classList.add('homo-value'); katex.render(`f(${index + 1}) = ${number}`, functionValue, { throwOnError: false }); functionValuesContainer.append(functionValue); } }); document.getElementById('numbers').dispatchEvent(new InputEvent('input')); ","date":"2025-02-27","externalUrl":null,"permalink":"/posts/2025/114514/","section":"Posts","summary":"çœŸæœ‰é€»è¾‘ï¼çœŸæ˜¯æœ‰è¶£ï¼å“‡ï¼æ•°å­¦ï¼å“‡ï¼","title":"è¯•ç€æ‰¾å‡ºé—®å·æ‰€ä»£è¡¨çš„æ•°","type":"posts"},{"content":" ä¸ºä»€ä¹ˆéœ€è¦è°ƒæ•´æ–‡ä»¶æè¿°ç¬¦é™åˆ¶ï¼Ÿ # 1. é»˜è®¤é™åˆ¶çš„å±€é™æ€§ # Arch Linux é»˜è®¤çš„ open files é™åˆ¶ä¸ºï¼š\n$ ulimit -n 1024 # æ™®é€šç”¨æˆ·é»˜è®¤ soft limit $ ulimit -Hn 524288 # hard limit è¿™ä¸ªé™åˆ¶å¯¹äºä»¥ä¸‹åœºæ™¯æ˜æ˜¾ä¸è¶³ï¼š\né«˜å¹¶å‘ Web æœåŠ¡ï¼ˆNginx/Apacheï¼‰ æ•°æ®åº“ç³»ç»Ÿï¼ˆMySQL/Redisï¼‰ å¤§æ•°æ®å¤„ç†ï¼ˆSpark/Hadoopï¼‰ æ¸¸æˆæœåŠ¡å™¨ï¼ˆéœ€è¦åŠ è½½å¤§é‡èµ„æºæ–‡ä»¶ï¼‰ 2. ä¸è°ƒæ•´çš„é£é™©æ¡ˆä¾‹ # # å…¸å‹é”™è¯¯æ—¥å¿—ç¤ºä¾‹ java.io.IOException: Too many open files nginx: [alert] 4096 worker_connections exceed open file resource limit: 1024 Unhandled Exception: EETypeRva:0x00667F40: Too many open files é…ç½® # æ­¥éª¤ 1ï¼šåˆ›å»ºé…ç½®æ–‡ä»¶ # åˆ›å»ºæ–‡ä»¶ /etc/security/limits.d/10-nofile-limits.confï¼š\n# - nofile - max number of open file descriptors * soft nofile 8192 # æ‰€æœ‰ç”¨æˆ· soft limit # * hard nofile 524288 # ä¿ç•™ç³»ç»Ÿé»˜è®¤ hard limit å¯¹ systemd å•å…ƒï¼Œåœ¨ /etc/systemd/system.conf å’Œ /etc/systemd/user.conf ä¸­æ·»åŠ ï¼š\nDefaultLimitNOFILE=8192:524288 æ­¥éª¤ 2ï¼šç«‹å³ç”Ÿæ•ˆé…ç½® # # å¯¹äºå·²ç™»å½•ç”¨æˆ·éœ€è¦é‡æ–°ç™»å½• ssh localhost # å¿«é€Ÿé‡æ–°å»ºç«‹ä¼šè¯ # éªŒè¯å½“å‰é™åˆ¶ ulimit -Sn \u0026amp;\u0026amp; ulimit -Hn # åº”è¾“å‡ºï¼š # 8192 # 524288 æ­¥éª¤ 3ï¼šç³»ç»Ÿçº§ç›‘æ§ï¼ˆå¯é€‰ï¼‰ # # æŸ¥çœ‹å…¨å±€æ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨ watch -n 5 \u0026#34;cat /proc/sys/fs/file-nr\u0026#34; # è¾“å‡ºç¤ºä¾‹ï¼š # 7584 0 3254236 # åˆ†åˆ«è¡¨ç¤ºï¼šå·²åˆ†é… | æœªä½¿ç”¨ | ç³»ç»Ÿä¸Šé™ é«˜çº§æŠ€å·§ä¸æ’é”™ # systemd æœåŠ¡çš„ç‰¹æ®Šå¤„ç† # ä½¿ç”¨ systemd ç®¡ç†çš„æœåŠ¡éœ€è¦é¢å¤–é…ç½®ï¼š\n# ç¼–è¾‘ systemd å…¨å±€é…ç½® sudo nano /etc/systemd/system.conf # ä¿®æ”¹ä»¥ä¸‹å‚æ•°ï¼š DefaultLimitNOFILE=8192:524288 é‡å¯æœåŠ¡ç”Ÿæ•ˆï¼š\nsudo systemctl daemon-reload sudo systemctl restart your-service å¸¸è§é—®é¢˜æ’æŸ¥ # Qï¼šä¿®æ”¹åé™åˆ¶æœªç”Ÿæ•ˆï¼Ÿ\nç¡®è®¤ç”¨æˆ·å·²é‡æ–°ç™»å½• æ£€æŸ¥ sshd_config æ˜¯å¦å¯ç”¨ UsePAM yes ä½¿ç”¨ cat /proc/\u0026lt;PID\u0026gt;/limits éªŒè¯è¿›ç¨‹å®é™…é™åˆ¶ Qï¼šåº”è¯¥è®¾ç½®å¤šå¤§çš„å€¼ï¼Ÿ\nåº”ç”¨ç±»å‹ æ¨è soft limit Web æœåŠ¡å™¨ 65535-131072 æ•°æ®åº“ 262144-524288 æ¡Œé¢åº”ç”¨ 16384-32768 ç»“è¯­ # é€šè¿‡åˆç†çš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶é…ç½®ï¼Œå¯ä»¥åœ¨ ç³»ç»Ÿç¨³å®šæ€§ å’Œ åº”ç”¨æ€§èƒ½ ä¹‹é—´å–å¾—å¹³è¡¡ã€‚å»ºè®®å®šæœŸç›‘æ§æ–‡ä»¶æè¿°ç¬¦ä½¿ç”¨æƒ…å†µï¼š\n# ç»Ÿè®¡å„è¿›ç¨‹æ‰“å¼€æ–‡ä»¶æ•° lsof -n | awk \u0026#39;{print $1}\u0026#39; | sort | uniq -c | sort -nr | head ğŸ“˜ æ‰©å±•é˜…è¯»ï¼šLinux å†…æ ¸å…³äºæ–‡ä»¶ç®¡ç†çš„ å®˜æ–¹æ–‡æ¡£\n","date":"2025-02-24","externalUrl":null,"permalink":"/posts/2025/linux-limits/","section":"Posts","summary":"","title":"æé«˜Linuxçš„æ–‡ä»¶æè¿°ç¬¦é™åˆ¶","type":"posts"},{"content":" å‰è¨€ # Joy-Con / Pro Controller ä¸ä¸»æœºçš„è“ç‰™é…å¯¹æ˜¯åŒå‘çš„ï¼Œä¸»æœºåœ¨å”¯ä¸€è¯†åˆ«æ‰‹æŸ„çš„åŒæ—¶æ‰‹æŸ„ä¹Ÿä¼šå”¯ä¸€è¯†åˆ«ä¸»æœºã€‚\nå¦‚è¦æƒ³åŒä¸€ä¸ªæ‰‹æŸ„åœ¨åŒæ—¶åŒç³»ç»Ÿä¸Šä½¿ç”¨ï¼Œå¿…é¡»è¦ä½¿æ‰‹æŸ„è®¤ä¸ºè¿™ä¸¤ä¸ªç³»ç»Ÿæ˜¯ä¸€ä¸ªç³»ç»Ÿã€‚\nå› æ­¤å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡åˆ¶ä½œè™šæ‹Ÿç³»ç»Ÿæ—¶é€šå¸¸ä¸ä¼šé‡åˆ°ä»»ä½•é—®é¢˜ï¼Œä½†åŒç³»ç»Ÿåˆ†åˆ«å‡çº§å‡ æ¬¡åæˆ–è€…æŒ‰äº†é…å¯¹æŒ‰é’®å¼ºåˆ¶é‡æ–°é…å¯¹åï¼Œæ‰‹æŸ„ä¼šå‡ºç°åªè¯†åˆ«å…¶ä¸­ä¸€ä¸ªç³»ç»Ÿçš„é—®é¢˜ã€‚\nè¿™é‡Œæˆ‘ä»¬ä¼šä½¿ç”¨å¤§æ°”å±‚ 1.5.1 æ–°åŠ å…¥çš„ enable_external_bluetooth_db æ¥è§£å†³å¤šç³»ç»Ÿæ‰‹æŸ„è“ç‰™è¿æ¥çš„åŒæ­¥é—®é¢˜ã€‚\nå‡†å¤‡å·¥ä½œ # ç†è§£åŒç³»ç»Ÿçš„ä¸€äº›åŒºåˆ«\nCFW(SYSNAND)\nåˆç§°çœŸå®ç³»ç»Ÿï¼Œä¸ºå¤§æ°”å±‚+æœºèº« eMMC çš„æ¨¡å¼\nCFW(EMUNAND)\nç ´è§£ç³»ç»Ÿ\nOFW(SYSNAND)\næ­£ç‰ˆç³»ç»Ÿ\nå¤§æ°”å±‚ \u0026gt;= 1.5.1\nç¡®ä¿ sdmc:/atmosphere/config/system_settings.ini ä¸­å­˜åœ¨ enable_external_bluetooth_db = u8!0x1ï¼Œä¸å­˜åœ¨è‡ªè¡Œå†™å…¥\nç¡®ä¿æ­£ç‰ˆç³»ç»Ÿå’Œç ´è§£ç³»ç»Ÿä¸­å‡å·²å¼€å¯é£è¡Œæ¨¡å¼\nä»¥é˜²ä¸‡ä¸€ä½ çš„çœŸå®ç³»ç»Ÿæ²¡æœ‰åšå¥½å±è”½\næ“ä½œæ­¥éª¤ # è¿›å…¥çœŸå®ç³»ç»Ÿ CFW(SYSNAND)\nè°¨è®°ï¼Œåœ¨çœŸå®ç³»ç»Ÿä¸‹ä¸è¦å®‰è£…ä»»ä½•æ¸¸æˆï¼Œä¼šé€ æˆä½ çš„æ­£ç‰ˆç³»ç»Ÿçš„ Ban æœºï¼\næ‰“å¼€ DBIï¼Œæˆ–è€…å…¶ä»–èƒ½å¤Ÿæµè§ˆæ–‡ä»¶çš„æµè§ˆå™¨\nåˆ é™¤ sdmc:/atmosphere/bluetooth_devices.db\nä¸è¦åŠ¨ä»»ä½•å…¶ä»–æ–‡ä»¶ï¼\nå°†æ‰‹æŸ„æ’å…¥ä¸»æœºï¼Œè¿›å…¥ è®¾ç½®-æ‰‹æŸ„ä¸æ„Ÿåº”å™¨-æ–­å¼€ä¸æ‰‹æŸ„çš„è¿æ¥ï¼Œæ ¹æ®æç¤ºé•¿æŒ‰ X æ–­å¼€æ‰€æœ‰æ‰‹æŸ„\nè¿›å…¥ æ‰‹æŸ„-æ›´æ”¹æ¡æ³•/é¡ºåº å¹¶å–ä¸‹æ‰‹æŸ„\né•¿æŒ‰æ‰‹æŸ„é…å¯¹é”®ï¼Œç›´åˆ°æ‰‹æŸ„æŒ‡ç¤ºç¯å¿«é€Ÿé—ªçƒ\nåœ¨å–ä¸‹æ‰‹æŸ„çš„æƒ…å†µä¸‹ä¼‘çœ ä¸»æœºï¼Œå°è¯•ç”¨æ‰‹æŸ„å”¤é†’ï¼Œå¦‚æœå”¤é†’å¤±è´¥åˆ™ä»æ­¥éª¤ 3 é‡å¤\né‡å¯åˆ°ç ´è§£ç³»ç»Ÿ CFW(EMUNAND) æµ‹è¯•æ‰‹æŸ„æ˜¯å¦èƒ½æ­£å¸¸è¿æ¥\nç»“è¯­ # é‡ç‚¹å°±æ˜¯è¦åœ¨ SYSNAND é…å¯¹æ‰‹æŸ„ä¹‹åï¼Œé€šè¿‡ CFW(SYSNAND) è·å–é…å¯¹çš„æ‰‹æŸ„ä¿¡æ¯ï¼Œå†™å…¥ bluetooth_devices.db ä¸­ï¼Œè¿™æ ·å°±èƒ½ä¿è¯åœ¨ EMUNAND ä¸‹ä¹Ÿèƒ½æ­£å¸¸è¿æ¥æ‰‹æŸ„\nåŒç³»ç»Ÿé…å¯¹æˆåŠŸåå°½é‡ä¸è¦ä½¿ç”¨é…å¯¹é”®å»é‡è¿ï¼Œè¿™æ ·ä¼šå¯¼è‡´æ‰‹æŸ„é‡æ–°é…å¯¹ï¼Œéœ€è¦é‡æ–°è¿›è¡Œä¸Šè¿°æ“ä½œ\n","date":"2025-02-08","externalUrl":null,"permalink":"/posts/2025/nx-controller/","section":"Posts","summary":"","title":"Switch å¤§æ°”å±‚åŒç³»ç»Ÿæ‰‹æŸ„è“ç‰™é…å¯¹åŒæ­¥","type":"posts"},{"content":" zram-generator # å®‰è£… zram-generator\nsudo pacman -S zram-generator ä¿®æ”¹é…ç½®ï¼Œæ ¹æ®å®é™…å†…å­˜å¤§å°è°ƒæ•´ zram-size\nsudo -e /etc/systemd/zram-generator.conf\n[zram0] compression-algorithm = lz4 zstd(level=1) (type=idle) zram-size = 16384 [zram1] compression-algorithm = lz4 zram-size = 32768 fs-type = ext4 mount-point = /tmpfs options = \u0026#34;noatime,discard,X-mount.mode=1777\u0026#34; é‡å¯å zram-generator ä¼šè‡ªåŠ¨åˆ›å»º zram è®¾å¤‡ï¼Œå¹¶å°† zram1 æŒ‚è½½åˆ° /tmpfs ç›®å½•\næ–‡ä»¶ç³»ç»Ÿä¼˜åŒ– # å¯¹äº zram è®¾å¤‡ä¸Šçš„æ–‡ä»¶ç³»ç»Ÿï¼Œæ—¥å¿—ç­‰ç‰¹æ€§å‡ ä¹æ— ç”¨ï¼Œå¹¶ä¸”ä¼šå ç”¨é¢å¤–çš„ç©ºé—´ã€‚\next2 æ²¡æœ‰æ—¥å¿—ï¼Œä½†å®ƒæ¯” ext4 ç­‰æ–‡ä»¶ç³»ç»Ÿè€å¾—å¤šï¼Œå¹¶ä¸”æœ‰ä¸€äº›é™åˆ¶ã€‚\nbtrfs éå¸¸ç°ä»£ï¼Œä½†ä»–ä»ç„¶æœ‰å¤ªå¤šæˆ‘ä»¬ä¸éœ€è¦çš„ç‰¹æ€§ã€‚\nå› æ­¤æˆ‘ä»¬ä½¿ç”¨æ— æ—¥å¿—çš„ ext4 æ–‡ä»¶ç³»ç»Ÿä½œä¸ºæˆ‘ä»¬ zram è®¾å¤‡çš„æ–‡ä»¶ç³»ç»Ÿã€‚\nåœ¨ make2fs.conf ä¸­æ·»åŠ æ–°çš„ fs ç±»å‹ï¼Œå¤åˆ¶ ext4 é…ç½®ï¼Œå¹¶åˆ é™¤ has_journal é€‰é¡¹ï¼Œç»™æ–°çš„ fs-type èµ·ä¸€ä¸ªå”¯ä¸€çš„åå­—ï¼Œæ¯”å¦‚ ext4withoutjournalã€‚\nsudo -e /etc/mke2fs.conf\n[fs_types] ext4 = { features = has_journal,extent,huge_file,flex_bg,metadata_csum,64bit,dir_nlink,extra_isize } ext4withoutjournal = { features = extent,huge_file,flex_bg,metadata_csum,64bit,dir_nlink,extra_isize } zram-generator ä¼šä½¿ç”¨ mkfs.* æ¥æ ¼å¼åŒ– zram è®¾å¤‡ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€ä¸ª mkfs.ext4withoutjournal çš„è½¯é“¾æ¥ã€‚\nsudo ln -s /usr/bin/mke2fs /usr/bin/mkfs.ext4withoutjournal\nç„¶ååœ¨ /etc/systemd/zram-generator.conf ä¸­ä¿®æ”¹ fs-type ä¸º ext4withoutjournalã€‚\n[zram1] compression-algorithm = lz4 zram-size = 32768 fs-type = ext4withoutjournal mount-point = /tmpfs options = \u0026#34;noatime,discard,X-mount.mode=1777\u0026#34; é‡å¯åç”Ÿæ•ˆã€‚\næ€§èƒ½ # ä»¥ä¸‹çš„æ€§èƒ½æµ‹è¯•éå¸¸ä¸ä¸¥è°¨ï¼Œä»…ä¾›å‚è€ƒ\nlz4ï¼šæœ€å¿«ï¼Œä½†å‹ç¼©ç‡æœ€ä½ lzoï¼šæ¬¡ä¹‹ï¼Œå‹ç¼©ç‡ç¨é«˜ zstdï¼šæœ€æ…¢ï¼Œå‹ç¼©ç‡æœ€é«˜ å¯¹äº ext4ï¼Œå…³é—­æ—¥å¿—å¯ä»¥æé«˜çº¦ 10% çš„è¯»å–æ€§èƒ½ã€‚\nReference # Arch Linux Wiki Gentoo Wiki ","date":"2024-12-19","externalUrl":null,"permalink":"/posts/2024/linux-zram/","section":"Posts","summary":"Using Zram to create a fast temporary workspace in memory","title":"Temporary Workspace with Zram","type":"posts"},{"content":" sakarie9/sway-window-switcher A Python script to help list and switch sway windows easily through Fuzzel. Python 1 0 A Python script to help list and switch sway windows easily through Fuzzel.\nRequirements # Sway A dmenu launcher, including fuzzel and rofi Python3 jq Grep Also a nerd font is required if icons not show correctly. You can change fonts in your launcher settings.\nUsage # Get sway-window-switcher.py to somewhere you can execute.\nRun sway-window-switcher.py --help to get help.\n\u0026gt; sway-window-switcher.py -h usage: sway-window-switcher.py [-h] [-t {all,floating,scratch,regular}] [--plain-output] [-l {fuzzel,rofi}] List and select windows using swaymsg and dmenu launchers like fuzzel and rofi. options: -h, --help show this help message and exit -t {all,floating,scratch,regular}, --type {all,floating,scratch,regular} Type of window to list. Defaults to \u0026#34;all\u0026#34;. --plain-output Print a plain, unbeautified list to dmenu. -l {fuzzel,rofi}, --launcher {fuzzel,rofi} Specific a dmenu launcher to use. Will use first exist launcher if not define. Bind the script to sway keybind to use it easily.\nFor example, to list all the windows in scratchpad and switch to it you can have this in sway config:\nbindsym $mod+x exec sway-window-switcher -t scratch\nMake sure sway-window-switcher is in you PATH.\nThanks to # codingotaku/fuzzel-scripts\nThis script is basically a more featured python rewrite version of codingotaku\u0026rsquo;s script.\nJas-SinghFSU/HyprPanel\nWe used the windowTitleMap from HyprPanel for a better look.\n","date":"2024-11-26","externalUrl":null,"permalink":"/posts/2024/sway-window-switcher/","section":"Posts","summary":"","title":"Sway Window Switcher","type":"posts"},{"content":"","date":"2024-11-23","externalUrl":null,"permalink":"/tags/unixporn/","section":"Tags","summary":"","title":"Unixporn","type":"tags"},{"content":" GTK 2 \u0026amp; 3 # ä½¿ç”¨ nwg-look åº”ç”¨ adw-gtk3 ä¸»é¢˜\nå®‰è£…æ‰€éœ€çš„åŒ… pacman -S nwg-look adw-gtk-theme\nåœ¨ nwg-look ä¸­çš„ç»„ä»¶ä¸€æ é€‰æ‹© adw-gtk3-darkï¼Œå³ä¾§é¢œè‰²æ–¹æ¡ˆé€‰æ‹©å€¾å‘æš—è‰²\nä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®å›¾æ ‡ä¸»é¢˜å’Œé¼ æ ‡å…‰æ ‡\nç‚¹å‡»åº”ç”¨ï¼Œä¿å­˜è®¾ç½®\nGTK4 # ä¿æŒé»˜è®¤ï¼Œä¸éœ€è¦åœ¨ ~/.config/gtk-4.0/ ä¸‹è¿›è¡Œé…ç½®\nlibadwaita # æƒ³è¦ä½¿ç”¨ libadwaita çš„åº”ç”¨ï¼Œä¾‹å¦‚ nautilusï¼Œæ­£ç¡®ä½¿ç”¨æš—è‰²ï¼Œéœ€è¦è¿›è¡Œä¸€äº›é…ç½®\nåœ¨ sway ä¸‹ï¼Œéœ€è¦å®‰è£… xdg-desktop-portal-{gtk,wlr}\n-gtk æ˜¯å¿…é¡»çš„ï¼Œå‚è€ƒ i3/#5896\nåœ¨ Arch Linux ä¸Šï¼Œä¼¼ä¹å¹¶ä¸éœ€è¦ä¸Šè¿° issue çš„é…ç½®ï¼Œåªéœ€è¦å®‰è£… xdg-desktop-portal-gtk\næ­£ç¡®è®¾ç½®ç¯å¢ƒå˜é‡\nsway wiki\néœ€è¦å¦‚ä¸‹é…ç½®ä»¥æ­£ç¡®è®¾ç½®ç¯å¢ƒå˜é‡\nexec systemctl --user import-environment WAYLAND_DISPLAY DISPLAY XDG_CURRENT_DESKTOP SWAYSOCK I3SOCK XCURSOR_SIZE XCURSOR_THEME ","date":"2024-11-23","externalUrl":null,"permalink":"/posts/2024/wm-gtk-theme/","section":"Posts","summary":"","title":"WM ä¸‹çš„ GTK ä¸»é¢˜è®¾ç½®","type":"posts"},{"content":"","date":"2024-09-10","externalUrl":null,"permalink":"/tags/android/","section":"Tags","summary":"","title":"Android","type":"tags"},{"content":" Waydroid # Waydroid çš„å®‰è£…å‚è€ƒ Arch Wiki\nå†…æ ¸æ¨¡å— # éœ€è¦å¸¦æœ‰ Binder å†…æ ¸æ¨¡å—çš„å†…æ ¸æ‰èƒ½è¿è¡Œ Waydroidã€‚\nåœ¨ Arch Linux ä¸Šå¯ä»¥é€šè¿‡å®‰è£… linux-zen åŒ…æ¥æ»¡è¶³éœ€æ±‚ã€‚\næˆ–è€…ä½¿ç”¨ DKMS æ¨¡å—ï¼Œå‚è€ƒ DKMS modulesï¼Œå¦‚æœå®‰è£…äº† linux-zen ç­‰å†…æ ¸åˆ™æ— éœ€å®‰è£… DKMS æ¨¡å—ã€‚\næ— æ³•å¯åŠ¨ # å¦‚æœ Waydroid æ— æ³•å¯åŠ¨ï¼Œå¯èƒ½æ˜¯é‡åˆ°äº† [BUG] Waydroid is not working anymore on my Arch Linux systemï¼Œéœ€è¦å¯¹ waydroid-image-gapps è¿›è¡Œé™çº§ã€‚\nå·²çŸ¥çš„æœ€æ–°çš„å¯ä»¥æ­£å¸¸è¿è¡Œçš„ç‰ˆæœ¬ä¸º 2024-02-17ï¼Œä» SourceForge è·å–ã€‚\nèŠ±å± # Waydroid éœ€è¦ä½¿ç”¨å’Œæ¡Œé¢æ··æˆåŒæ ·çš„ GPUï¼Œå½“ä½¿ç”¨äº†ä¸åŒçš„ GPU æ—¶å°±ä¼šå‡ºç°æ¸²æŸ“é”™è¯¯ã€‚\nä½¿ç”¨ waydroid-choose-gpu.sh æŒ‡å®š Waydroid ä½¿ç”¨çš„ GPUã€‚\nè½¬è¯‘ # ä½¿ç”¨ Waydroid Script å®‰è£…è½¬è¯‘å±‚ã€‚\nä¸€èˆ¬åœ¨ AMD å¤„ç†å™¨ä¸Šï¼Œlibndk è¿è¡Œè¾ƒå¥½ï¼›Intel å¤„ç†å™¨ä¸Š libhoudini è¿è¡Œè¾ƒå¥½ã€‚\nå¦‚æœå‡ºç°é—®é¢˜å¯ä»¥å°è¯•å®‰è£…å¦ä¸€ä¸ªï¼Œæ›´æ¢è½¬è¯‘å±‚ä¹‹å‰æœ€å¥½å°†æ—§çš„è½¬è¯‘å±‚å¸è½½ã€‚\nåœ¨æŸäº›æ¸¸æˆï¼Œå¦‚ Blue Archive æ—¥æœå’Œå›½é™…æœï¼Œä¼šå‡ºç°å¡ä¸»ç•Œé¢/ç›´æ¥é—ªé€€çš„æƒ…å†µï¼Œéœ€è¦å¯¹è½¬è¯‘å±‚äºŒè¿›åˆ¶æ–‡ä»¶æ‰“è¡¥ä¸ã€‚\nlibndk # https://github.com/waydroid/waydroid/issues/788#issuecomment-2167334937\nä¸‹è½½ scripton_ndk.txt é‡å‘½åä¸º scripton_ndk.shï¼Œå¹¶ä¿®æ”¹ä¸ºå¯æ‰§è¡Œ sudo ./scripton_ndk.sh scripton_ndk #!/bin/bash # \u0026lt;https://github.com/waydroid/waydroid/issues/788#issuecomment-2167334937\u0026gt; function CheckHex { # file path, Ghidra offset, Hex to check commandoutput=\u0026#34;$(od $1 --skip-bytes=$(($2 - 0x101000)) --read-bytes=$((${#3} / 2)) --endian=little -t x1 -An file | sed \u0026#39;s/ //g\u0026#39;)\u0026#34; if [ \u0026#34;$commandoutput\u0026#34; = \u0026#34;$3\u0026#34; ]; then echo \u0026#34;1\u0026#34; else echo \u0026#34;0\u0026#34; fi } function PatchHex { # file path, ghidra offset, original hex, new hex file_offset=$(($2 - 0x101000)) if [ $(CheckHex $1 $2 $3) = \u0026#34;1\u0026#34; ]; then hexinbin=$(printf $4 | xxd -r -p) echo -n $hexinbin | dd of=$1 seek=$file_offset bs=1 conv=notrunc tmp=\u0026#34;Patched $1 at $file_offset with new hex $4\u0026#34; echo $tmp elif [ $(CheckHex $1 $2 $4) = \u0026#34;1\u0026#34; ]; then echo \u0026#34;Already patched\u0026#34; else echo \u0026#34;Hex mismatch!\u0026#34; fi } ndk_path=\u0026#34;/var/lib/waydroid/overlay/system/lib64/libndk_translation.so\u0026#34; if [ -f $ndk_path ]; then if [ -w ndk_path ] || [ \u0026#34;$EUID\u0026#34; = 0 ]; then PatchHex $ndk_path 0x307dd1 83e2fa 83e2ff PatchHex $ndk_path 0x307cd6 83e2fa 83e2ff else echo \u0026#34;libndk_translation is not writeable. Please run with sudo\u0026#34; fi else echo \u0026#34;libndk_translation not found. Please install it first.\u0026#34; fi libhoudini # https://github.com/waydroid/waydroid/issues/788#issuecomment-2162386712\nä¸‹è½½ scripton.txt é‡å‘½åä¸º scripton.shï¼Œå¹¶ä¿®æ”¹ä¸ºå¯æ‰§è¡Œ sudo ./scripton.sh scripton_ndk #!/bin/bash function CheckHex { #file path, Ghidra offset, Hex to check commandoutput=\u0026#34;$(od $1 --skip-bytes=$(($2 - 0x100000)) --read-bytes=$((${#3} / 2)) --endian=little -t x1 -An file | sed \u0026#39;s/ //g\u0026#39;)\u0026#34; if [ \u0026#34;$commandoutput\u0026#34; = \u0026#34;$3\u0026#34; ]; then echo \u0026#34;1\u0026#34; else echo \u0026#34;0\u0026#34; fi } function PatchHex { #file path, ghidra offset, original hex, new hex file_offset=$(($2 - 0x100000)) if [ $(CheckHex $1 $2 $3) = \u0026#34;1\u0026#34; ]; then hexinbin=$(printf $4 | xxd -r -p) echo -n $hexinbin | dd of=$1 seek=$file_offset bs=1 conv=notrunc tmp=\u0026#34;Patched $1 at $file_offset with new hex $4\u0026#34; echo $tmp elif [ $(CheckHex $1 $2 $4) = \u0026#34;1\u0026#34; ]; then echo \u0026#34;Already patched\u0026#34; else echo \u0026#34;Hex mismatch!\u0026#34; fi } houdini_path=\u0026#34;/var/lib/waydroid/overlay/system/lib64/libhoudini.so\u0026#34; if [ -f $houdini_path ]; then if [ -w houdini_path ] || [ \u0026#34;$EUID\u0026#34; = 0 ]; then PatchHex $houdini_path 0x4062a5 48b8fbffffff 48b8ffffffff PatchHex $houdini_path 0x4099d6 83e0fb 83e0ff PatchHex $houdini_path 0x409b42 e8892feeff 9090909090 else echo \u0026#34;Libhoudini is not writeable. Please run with sudo\u0026#34; fi else echo \u0026#34;Libhoudini not found. Please install it first.\u0026#34; fi ","date":"2024-09-10","externalUrl":null,"permalink":"/posts/2024/waydroid-issues/","section":"Posts","summary":"","title":"Waydroid ç–‘éš¾æ’è§£","type":"posts"},{"content":"å¦‚ä½•ä½¿ç”¨ FFmpeg å°†éŸ³é¢‘æ–‡ä»¶è½¬æ¢ä¸º Opusï¼Œä»¥åŠè½¬æ¢è¿‡ç¨‹ä¸­é‡åˆ°çš„å„ç§å‘ã€‚\nå¬ä¸å‡ºæ¥å°±æ˜¯æ— æŸï¼\nèƒŒæ™¯ # TL;DR! å¯ä»¥ç›´æ¥è·³åˆ° è„šæœ¬\nè¿‘æ¥æ‰‹æœºå’Œ NAS å­˜å‚¨ç©ºé—´é€æ¸ä¸å¤Ÿç”¨äº†ï¼Œåœ¨æƒ³åŠæ³•å¤„ç†é‚£äº› WAV æ–‡ä»¶ï¼Œå°†å…¶è½¬æ¢ä¸º FLAC ä»¥å‹ç¼©ç©ºé—´çš„æ—¶å€™ï¼Œæƒ³åˆ°äº† Opus è¿™ä¸ªæ•ˆç‡å¾ˆé«˜çš„ç¼–ç æ ¼å¼ã€‚\nè™½ç„¶æŠŠæ‰€æœ‰æ— æŸéŸ³é¢‘ç›´æ¥è½¬æ¢ä¸ºæœ‰æŸéŸ³é¢‘ä¿å­˜æ”¶è—ä¸å¯å–ï¼Œä½†æŠŠæ‰‹æœºå†…ä¿å­˜çš„éŸ³ä¹ç»Ÿç»Ÿä½¿ç”¨å‹ç¼©ç‡æ›´å¥½çš„æ ¼å¼æ˜¯ä¸€ä¸ªä¸é”™çš„å°è¯•ã€‚\né¦–å…ˆä»‹ç»ä¸€ä¸‹æœ¬ç¯‡çš„ä¸»è§’ï¼šOpus\nOpusæ˜¯ä¸€ä¸ªæœ‰æŸéŸ³é¢‘å‹ç¼©çš„æ•°å­—éŸ³é¢‘ç¼–ç æ ¼å¼ï¼Œç”±Xiph.OrgåŸºé‡‘ä¼šå¼€å‘ã€‚Opusé›†æˆäº†ä¸¤ç§å£°éŸ³ç¼–ç çš„æŠ€æœ¯ï¼šä»¥è¯­éŸ³ç¼–ç ä¸ºå¯¼å‘çš„SILKå’Œä½å»¶è¿Ÿçš„CELTã€‚Opuså¯ä»¥æ— ç¼è°ƒèŠ‚é«˜ä½æ¯”ç‰¹ç‡ã€‚åœ¨ç¼–ç å™¨å†…éƒ¨å®ƒåœ¨è¾ƒä½æ¯”ç‰¹ç‡æ—¶ä½¿ç”¨çº¿æ€§é¢„æµ‹ç¼–ç åœ¨é«˜æ¯”ç‰¹ç‡æ—¶å€™ä½¿ç”¨å˜æ¢ç¼–ç ï¼ˆåœ¨é«˜ä½æ¯”ç‰¹ç‡äº¤ç•Œå¤„ä¹Ÿä½¿ç”¨ä¸¤è€…ç»“åˆçš„ç¼–ç æ–¹å¼ï¼‰ã€‚Opuså…·æœ‰éå¸¸ä½çš„ç®—æ³•å»¶è¿Ÿï¼ˆé»˜è®¤ä¸º22.5 msï¼‰[5]ï¼Œéå¸¸é€‚åˆç”¨äºä½å»¶è¿Ÿè¯­éŸ³é€šè¯çš„ç¼–ç ï¼Œåƒæ˜¯ç½‘ç»œä¸Šçš„å³æ—¶å£°éŸ³æµã€å³æ—¶åŒæ­¥å£°éŸ³æ—ç™½ç­‰ç­‰ï¼Œæ­¤å¤–Opusä¹Ÿå¯ä»¥é€è¿‡é™ä½ç¼–ç æ¯”ç‰¹ç‡ï¼Œè¾¾æˆæ›´ä½çš„ç®—æ³•å»¶è¿Ÿï¼Œæœ€ä½å¯ä»¥åˆ°5 msã€‚åœ¨å¤šä¸ªå¬è§‰ç›²æµ‹ä¸­ï¼ŒOpuséƒ½æ¯”MP3ã€AACã€HE-AACç­‰å¸¸è§æ ¼å¼ï¼Œæœ‰æ›´ä½çš„å»¶è¿Ÿå’Œæ›´å¥½çš„å£°éŸ³å‹ç¼©ç‡ã€‚\næ€»ä¹‹å°±æ˜¯éå¸¸ç°ä»£åŒ–çš„ä¸€ç§ç¼–ç æ ¼å¼ï¼Œèƒ½å¤Ÿåœ¨ä½ç ç‡ä¸‹ä¿æŒæé«˜çš„æ¸…æ™°åº¦ï¼ˆä¸åŒç ç‡çš„ MP3 ç›¸æ¯”ï¼‰ï¼›åœ¨ä¸­ç­‰çš„ç ç‡ä¸‹ï¼ˆ96kbps-128kbps å·¦å³ï¼‰èƒ½å¤Ÿåšåˆ°æ¥è¿‘æ— æŸçš„å¬æ„Ÿï¼›åœ¨æ›´é«˜çš„ç ç‡ä¸‹ï¼ˆ160kbps-192kbpsï¼‰å‡ ä¹å¯ä»¥è®¤ä¸ºæ— æŸã€‚\nå¬è§‰æµ‹è¯• # åœ¨è°ƒæŸ¥æ˜¯å¦åº”è¯¥é€‰ç”¨ Opus æ—¶ï¼Œè¿›è¡Œäº†ä¸€äº›ç®€å•çš„å¬è§‰æµ‹è¯•ï¼Œé€‰å–äº†ä¸¤é¦–ç”µå‰ä»–å£°å ä¸»å¯¼ä¸”éå¸¸æ¸…æ™°çš„éŸ³ä¹ä½œä¸ºæ ·æœ¬ã€‚\næœ¬æµ‹è¯•ä»…å¨±ä¹ï¼Œéå¸¸ä¸ç§‘å­¦\n1 2 3 4 A 96k-opus 320k-mp3 192k-mp3 160k-opus B 160k-opus 128k-mp3 320k-mp3 96k-opus A ç»„çš„æ ·æœ¬å‡ç”± FLAC è½¬æ¢è€Œæ¥ï¼ŒB ç»„çš„æ ·æœ¬å‡ç”± B3 çš„ 320kbps çš„ MP3 è½¬æ¢è€Œæ¥ã€‚\nä»¥ MP3 ä¸ºæºæ–‡ä»¶æ˜¯ä¸ºäº†æµ‹è¯•ä»æœ‰æŸåˆ°æœ‰æŸçš„è½¬æ¢è¿‡ç¨‹ä¸­ä¼šä¸¢å¤±å¤šå°‘ç»†èŠ‚ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„ â€œGeneration lossâ€ æœ‰å¤šä¸¥é‡ã€‚\næµ‹è¯•ç»“è®º # ç”²ï¼šå®Œå…¨å¬ä¸å‡ºæ¥\nä¹™ï¼šA3ï¼A2ï¼A4ï¼A1ï¼ŒA1ã€A4ã€B1ã€B4 æœ‰ç‚¹ç³Šï¼Œäº‹ååˆæ·»åŠ äº† 320k-opus çš„ A5ï¼Œä¾ç„¶ç³Šï¼Œæ¨æµ‹å¯èƒ½æ˜¯è®¾å¤‡çš„è§£ç å™¨å­˜åœ¨é—®é¢˜\nä¸™ï¼šA3 æœ€æ¸…æ¥šï¼ŒA4 æœ€ç³Š\nè™½ç„¶æµ‹è¯•éå¸¸ä¹‹ä¸ä¸¥è°¨ï¼Œä½†æˆ‘ä»¬ä¹Ÿèƒ½çœ‹å‡ºæ¥è‡³å°‘ 192k-mp3 å’Œ 320k-mp3 å¤§å®¶éƒ½æ˜¯åˆ†ä¸å‡ºæ¥çš„ã€‚\nå› ä¸ºæµ‹è¯•æ‰€ç”¨çš„ç½‘ç«™æ˜¯ä¸´æ—¶æ“å‡ºæ¥çš„ï¼Œä¹™å’Œä¸™çš„è®¾å¤‡ä¸Šåªæœ‰ MP3 æ ¼å¼çš„æ ·æœ¬ä¼šæ˜¾ç¤ºéŸ³é¢‘æ—¶é•¿ï¼ŒOpus çš„æ ·æœ¬ä¼¼ä¹æ˜¯ä¸²æµè¿‡å»çš„ï¼Œè¿™ä¼šå¯¹éŸ³è´¨é€ æˆå¤šå°‘å½±å“æš‚æ—¶å­˜ç–‘ã€‚\nä½†æ€»ä¹‹ï¼Œä¸ªäººæ˜¯å®Œå…¨å¬ä¸å‡ºæ¥ 96k-opus å’Œ 320k-mp3 çš„åŒºåˆ«çš„ã€‚æ‰€ä»¥è½¬ç ç­–ç•¥å°±æ˜¯ï¼šå­˜åœ¨æ— æŸæ–‡ä»¶çš„ï¼Œè½¬ä¸º 128kbps æˆ–è€… 160kbps çš„ Opusï¼›æºæ–‡ä»¶åªæœ‰æœ‰æŸçš„ï¼Œç»Ÿç»Ÿè½¬ä¸º 96kbps Opusã€‚\nè¿™é‡Œå¼•ç”¨ä¸€å¥è¯ï¼š\nSubjectively, though, if you can\u0026rsquo;t hear the difference, then by definition there was no quality loss, which is the whole point of these codecs: fooling you in that way.\nç¼–å†™è„šæœ¬ # ä½¿ç”¨ FFmpeg è¿›è¡ŒéŸ³é¢‘è½¬ç ç†è®ºä¸Šæ˜¯å®Œå…¨æ²¡æœ‰éš¾åº¦çš„ï¼Œffmpeg -i input.flac output.opus ç†è®ºä¸Šå°±èƒ½ç›´æ¥å®Œæˆäº†ã€‚\nã—ã‹ã—ã€\nã ãŒã€\nButtã€\nè¿™å…¶ä¸­å­˜åœ¨ç€å¾ˆå¤šå¾ˆå¤šçš„å‘ï¼Œä¸‹é¢æˆ‘ä»¬ä»å¤´å¼€å§‹ä¸€æ­¥æ­¥è¸è¿›æ¯ä¸€ä¸ªå‘ã€‚\nå¤šçº¿ç¨‹å¹¶è¡Œ # ä¼—æ‰€å‘¨çŸ¥ï¼ŒFFmpge æ˜¯æ²¡æœ‰å†…ç½®çš„åŒæ—¶å¤„ç†å¤šæ–‡ä»¶ã€æˆ–è€…åˆ©ç”¨å¤šæ ¸å¿ƒçš„æ–¹å¼çš„ï¼Œåœ¨æˆ‘ä»¬å¤„ç†ä¸Šåƒä¸ªéŸ³é¢‘æ–‡ä»¶çš„æ—¶å€™ä¼šéå¸¸éå¸¸æ…¢ã€‚\næ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨ GNU Parallel åƒæ»¡ CPUï¼Œä¸€ä¸ªç®€å•çš„ç”¨æ³•å¦‚ä¸‹ã€‚\nfind . -type f -name \u0026#34;*.flac\u0026#34; | parallel ffmpeg -i {} {.}.opus å°†å½“å‰ç›®å½•ä¸‹çš„ FLAC è½¬æ¢ä¸º Opusï¼Œä¹ä¸€çœ‹æ˜¯æ²¡é—®é¢˜çš„ï¼Œä»–ä¹Ÿç¡®å®å¯ä»¥å·¥ä½œã€‚\nä½†æ˜¯å…¶å­˜åœ¨ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ï¼Œç›®å‰ FFmpeg ä¸æ”¯æŒ OGG/Opus æ–‡ä»¶çš„ä¸“è¾‘å°é¢å†™å…¥ã€‚\nä¸“è¾‘å°é¢ # æ­¤äº‹åœ¨ #4448 Support writing album cover art image embedded in ogg / opus metadata ä¸­äº¦æœ‰è®°è½½ã€‚\nå¾ˆéš¾æƒ³è±¡ä¸€ä¸ªä¹å¹´å‰å°±å­˜åœ¨çš„é—®é¢˜ç›´åˆ°ä»Šæ—¥ä¾ç„¶æœªè§£å†³ã€‚\nå°±è·Ÿä¸Šè¿° Issue æè¿°çš„ä¸€æ ·ï¼ŒFFmpeg æ— æ³•ä¸º Opus æ–‡ä»¶åµŒå…¥ä¸“è¾‘å°é¢ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¦è¾Ÿè¹Šå¾„ã€‚\nç»è¿‡ä¸€ç•ªæœç´¢ï¼Œå‘ç°äº†ä½¿ç”¨ opusenc å‘½ä»¤è¿›è¡Œè½¬æ¢å¯ä»¥ä¿ç•™æ‰€æœ‰çš„å…ƒæ•°æ®ä»¥åŠä¸“è¾‘å°é¢ã€‚\nç®€å•ç”¨æ³•å¦‚ä¸‹ï¼š\nffmpeg -i input.mp3 -f flac - | opusenc - output.opus å°† MP3 å…ˆè½¬ä¸º FLACï¼Œå†é€šè¿‡ç®¡é“ç”± opusenc è½¬ä¸º Opusï¼Œè¿™æ ·å°±è·³è¿‡äº† FFmpeg ç›´æ¥è½¬ä¸º Opus çš„è¿‡ç¨‹ã€‚\nä¸ç›´æ¥ä½¿ç”¨ opusenc çš„åŸå› æ˜¯ä»–åªæ”¯æŒå‡ ç§æ ¼å¼ï¼šThe input format can be Wave, AIFF, FLAC, Ogg/FLAC, or raw PCM.ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦è½¬æ¢ MP3 åˆ° Opus æ—¶éœ€è¦å…ˆè½¬ä¸º FLACã€‚\nç„¶åè¿™ç§æ–¹å¼ç”±å¼•å…¥äº†ä¸€ä¸ªæ–°çš„é—®é¢˜ï¼Œæœ‰äº›æ–‡ä»¶è½¬æ¢ä¸º Opus åï¼Œä½“ç§¯ç”šè‡³æ¯”åŸæ¥çš„ MP3 å¤§ä¸Šäº† 50%ï¼\nç»è¿‡ç ”ç©¶ï¼Œå‘ç°å¤šå‡ºæ¥çš„å¤§å°æ¥è‡ªä¸“è¾‘å°é¢ã€‚ä¼¼ä¹ FFmpeg åœ¨å°†æºæ–‡ä»¶è½¬ä¸º FLAC çš„æ—¶å€™é¡ºæ‰‹å°†ä¸“è¾‘å°é¢ä¹Ÿå¤„ç†äº†ã€‚\nåŸæœ¬ MP3 å†…åµŒçš„ 3000x3000 785.4kB JPEG çš„ä¸“è¾‘å°é¢ï¼Œè½¬æ¢åˆ° Opus ä¹‹åï¼Œå†…åµŒå°é¢å˜æˆäº† 3000x3000 12.0MB PNGã€‚\nè¿™å¯¼è‡´ä½“ç§¯ä»åŸæ¥çš„ 8.1MB æš´æ¶¨åˆ°äº† 23.5MBï¼Œæœ¬æ¥å°±æ˜¯ä¸ºäº†èŠ‚çœç©ºé—´æ‰è¿›è¡Œçš„è½¬ç ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸å¯æ¥å—çš„ã€‚\næƒ³è¦è½¬ç æ—¶ä¸å¤„ç†å°é¢ï¼Œéœ€è¦ä½¿ç”¨ -c:v copyï¼Œä¿®æ”¹åçš„å‘½ä»¤å¦‚ä¸‹ï¼š\nffmpeg -i input.mp3 -c:v copy -f flac - | opusenc - output.opus è¿™æ ·å°±èƒ½åšåˆ°ä» MP3 åˆ° Opus çš„è½¬ç äº†ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å­˜åœ¨ç€æºæ–‡ä»¶å†…çš„å°é¢å°±å·²ç»å¾ˆå¤§çš„æƒ…å†µï¼Œæˆ‘ä»¬æš‚ä¸”æŒ‰ä¸‹ä¸è¡¨ï¼Œåœ¨åç»­æ­¥éª¤å¤„ç†ã€‚\nç»“æ„åŒ–è¾“å‡º # ä¸ºäº†å°†æºæ–‡ä»¶è½¬æ¢åè¾“å‡ºåˆ°æŒ‡å®šçš„ç›®æ ‡ç›®å½•ï¼Œéœ€è¦å¯¹ç›®å½•è¿›è¡Œä¸€äº›æ‹¼æ¥ã€‚\nä½†æ˜¯é—®é¢˜æ¥äº†ï¼Œæˆ‘åœ¨è¿™é‡Œé‡åˆ°äº†è®¸å¤šä¹±ä¸ƒå…«ç³Ÿçš„å¼•å·åµŒå¥—é—®é¢˜ï¼Œæ€»ä¹‹ç›´æ¥æ”¾è§£å†³çš„è¾“å‡ºçš„è„šæœ¬åœ¨è¿™é‡Œã€‚\nconvert_to_opus() { input_file=$1 relative_path=\u0026#34;${input_file#\u0026#34;$SOURCE_DIR\u0026#34;/}\u0026#34; output_file=\u0026#34;$DEST_DIR/${relative_path%.*}.opus\u0026#34; # å·²å­˜åœ¨åˆ™è·³è¿‡ if [ -f \u0026#34;output_file\u0026#34; ]; then return 0; fi # åˆ›å»ºè¾“å‡ºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½• output_file_dir=$(dirname \u0026#34;$output_file\u0026#34;) mkdir -p \u0026#34;$output_file_dir\u0026#34; # -c:v copy is REQUIRED as FFmpeg will convert the album cover, cause extremely large files ffmpeg -hide_banner -loglevel warning -i \u0026#34;$input_file\u0026#34; -c:v copy -f flac - | opusenc --quiet --bitrate 128 - \u0026#34;$output_file\u0026#34; } # IMPORTANT export -f convert_to_opus find \u0026#34;$SOURCE_DIR\u0026#34; -type f -name \u0026#34;*.flac\u0026#34; | parallel --progress convert_to_opus å°† parallel çš„ command æ¢æˆå‡½æ•°èƒ½é¿å…ä½¿ç”¨å­—ç¬¦ä¸²ä¼ å‘½ä»¤é€ æˆçš„ globbing and word splitting é—®é¢˜ã€‚\nä¸è¦å¿˜äº† export -f å‘½ä»¤ï¼Œå¦åˆ™ parallel æ— æ³•è¯†åˆ«å‡½æ•°ã€‚\nåˆ°è¿™é‡Œå·²ç»å·®ä¸å¤šèƒ½ç”¨äº†ï¼Œæˆ‘ä»¬è¿˜æœ‰æœ€åä¸€ä¸ªé—®é¢˜éœ€è¦è§£å†³ã€‚\nä¸“è¾‘å°é¢å‹ç¼© # ä¸“è¾‘å°é¢å‹ç¼©ã€‚\nä¸ºä»€ä¹ˆè¦å‹ç¼©å‘¢ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œå¯¹äº 100M çš„ FLAC è€Œè¨€ï¼Œ5M çš„ä¸“è¾‘å°é¢åªå å…¶ä½“ç§¯çš„ 5%ï¼Œä¸æ˜¯ä»€ä¹ˆå¤§äº‹ï¼Œä¸ç¼ºè¿™ç‚¹ä½“ç§¯ã€‚\nä½†æ˜¯æˆ‘ä»¬ä¸ºäº†å‹æ¦¨ç©ºé—´æŠŠä»–è½¬ä¸º Opus åï¼Œä¸“è¾‘å°é¢å çš„ç©ºé—´ç›¸æ¯”å®é™…éŸ³é¢‘å°±å¤§çš„éš¾ä»¥æ¥å—äº†ï¼Œ100M çš„ FLAC è½¬ä¸º Opus åéŸ³é¢‘éƒ¨åˆ†ä»…æœ‰ 8M å·¦å³ï¼Œå¦‚æœç›´æ¥å°†å°é¢åµŒè¿›å»ï¼Œ8+5=13M çš„éŸ³é¢‘æ–‡ä»¶é‡Œ 40% çš„ä½“ç§¯éƒ½ç”¨æ¥å­˜å›¾ç‰‡äº†ï¼Œæ˜¾ç„¶æ˜¯éå¸¸ä¸åˆç†çš„ã€‚\nå› æ­¤æˆ‘ä»¬è¦åœ¨åµŒå…¥ä¹‹å‰å¯¹ä¸“è¾‘å°é¢è¿›è¡Œä¸€æ¬¡å‹ç¼©ï¼ŒéŸ³é¢‘éƒ½å‹äº†ä¸ç¼ºè¿™ç‚¹è´¨é‡æŸå¤±ã€‚\né¦–å…ˆæˆ‘ä»¬çš„æµç¨‹æ˜¯ï¼šä»æºæ–‡ä»¶æå–å‡ºä¸“è¾‘å°é¢ -\u0026gt; å‹ç¼© -\u0026gt; å°†æºæ–‡ä»¶çš„éŸ³é¢‘éƒ¨åˆ†å’Œå‹ç¼©åçš„å°é¢åˆå¹¶è½¬æ¢ä¸º FLACï¼ˆåŸå› å¦‚ä¸Šï¼‰ -\u0026gt; ä½¿ç”¨ opusenc è½¬ä¸º opusã€‚\nå¾—åˆ°äº†ä¸‹é¢çš„å‘½ä»¤\nffmpeg -i \u0026#34;$input_file\u0026#34; -an -vcodec copy -f image2pipe - | ffmpeg -i - -vf \u0026#34;scale=\u0026#39;if(gt(iw,1000),1000,iw)\u0026#39;:-1\u0026#34; \u0026#34;$cover_convert_file\u0026#34; # è½¬æ¢å¹¶åµŒå…¥å°é¢ ffmpeg -i \u0026#34;$input_file\u0026#34; -i \u0026#34;$cover_convert_file\u0026#34; -map 0:a -map 1:v -c:v copy -disposition:v attached_pic -metadata:s:v comment=\u0026#34;Cover (front)\u0026#34; -f flac - | opusenc - \u0026#34;$output_file\u0026#34; å…¶ä¸­ -vf \u0026quot;scale='if(gt(iw,1000),1000,iw)':-1\u0026quot; æ˜¯å°†ä¸“è¾‘å°é¢å¤§äº 1000x çš„ç¼©å°åˆ° 1000xï¼Œå°äº 1000x çš„ä¸å˜ã€‚\n-map 0:a -map 1:v -c:v copy -disposition:v attached_pic -metadata:s:v comment=\u0026quot;Cover (front)\u0026quot; è¿™ä¸€ä¸²éƒ½æ˜¯å†™å…¥ä¸“è¾‘å°é¢çš„ã€‚\næ³¨æ„åˆ°å…¶ä¸­æˆ‘ä»¬å¼•å…¥äº†ä¸€ä¸ªä¸­é—´æ–‡ä»¶ $cover_convert_fileï¼Œåœ¨å¹¶è¡Œä¸­éœ€è¦ä½¿ç”¨åˆé€‚çš„è·¯å¾„é¿å…å¤šçº¿ç¨‹åŒæ—¶è¯»å†™ä¸€ä¸ªæ–‡ä»¶é€ æˆçš„å†²çªï¼Œè¿™é‡Œå°†ä¸­é—´æ–‡ä»¶ä½¿ç”¨æºæ–‡ä»¶çš„ç›®å½•ç»“æ„å’Œæ–‡ä»¶åæ”¾åœ¨ä¸´æ—¶æ–‡ä»¶ç›®å½•ä¸­é¿å…å†²çªã€‚\nå˜é‡å¯¼å‡º # åˆ°è¿™é‡Œè„šæœ¬å·®ä¸å¤šå·²ç»å®Œæˆäº†ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨å‡½æ•°ä¸­ä½¿ç”¨å˜é‡æ—¶éœ€è¦æå‰å¯¼å‡ºå˜é‡ã€‚\nåœ¨ä¸Šé¢çš„ convert_to_opus() ä¸­ä½¿ç”¨äº† SOURCE_DIR å˜é‡ï¼Œè¿™æ ·å°±éœ€è¦åœ¨å‡½æ•°ä¸­å…ˆè¿›è¡Œå¯¼å‡ºï¼Œå¦åˆ™å‡½æ•°å†…æ­¤å˜é‡ä¸å­˜åœ¨å°±ä¼šä¸ºç©ºã€‚\nè¦åœ¨ä¸‹é¢çš„ parallel ä¸­è°ƒç”¨çš„å‡½æ•°ä¹Ÿéœ€è¦ç”¨ export -f å¯¼å‡º\nexport SOURCE_DIR export DEST_DIR convert_to_opus() { input_file=$1 relative_path=\u0026#34;${input_file#\u0026#34;$SOURCE_DIR\u0026#34;/}\u0026#34; } export -f convert_to_opus å®Œæ•´è„šæœ¬ # å°† source_path ä¸­çš„æ‰€æœ‰ .flac,.mp3,.wav è½¬ä¸º .opusï¼Œæ”¾å…¥ dest_path ä¸­ã€‚\n./converter.sh -b 128 source_path dest_path\n#!/bin/bash show_help() { echo \u0026#34;Usage: $0 [-b 96] [-c] SOURCE_PATH DEST_PATH\u0026#34; echo \u0026#34;\u0026#34; echo \u0026#34;Options:\u0026#34; echo \u0026#34; -b Opus Bitrate. E.g. -b 96, -b 128. Default is 96.\u0026#34; echo \u0026#34; -c --audio-only If copy other files in the source directory.\u0026#34; echo \u0026#34; -h, --help Show this help message and exit.\u0026#34; echo \u0026#34;\u0026#34; echo \u0026#34;Arguments:\u0026#34; echo \u0026#34; SOURCE_PATH Path to the directory containing files needs to be converted.\u0026#34; echo \u0026#34; DEST_PATH Path to the directory to save the converted files.\u0026#34; } # åˆå§‹åŒ–å˜é‡ BITRATE=96 CACHE_DIR=\u0026#34;/tmp/opus-convert\u0026#34; AUDIO_ONLY=false # è§£æå‘½ä»¤è¡Œé€‰é¡¹ while getopts \u0026#34;:b:ch-:\u0026#34; opt; do case \u0026#34;${opt}\u0026#34; in b) BITRATE=${OPTARG} ;; c) AUDIO_ONLY=true ;; h) show_help exit 0 ;; -) case \u0026#34;${OPTARG}\u0026#34; in audio-only) AUDIO_ONLY=true ;; help) show_help exit 0 ;; *) echo \u0026#34;Invalid option: --${OPTARG}\u0026#34; \u0026gt;\u0026amp;2 exit 1 ;; esac ;; \\?) echo \u0026#34;Invalid option: -$OPTARG\u0026#34; \u0026gt;\u0026amp;2 exit 1 ;; :) echo \u0026#34;Option -${OPTARG} requires an argument.\u0026#34; \u0026gt;\u0026amp;2 exit 1 ;; esac done # ç§»é™¤å·²å¤„ç†çš„é€‰é¡¹å‚æ•° shift $((OPTIND - 1)) # æ£€æŸ¥å‚æ•°æ˜¯å¦è¶³å¤Ÿ if [ $# -ne 2 ]; then echo \u0026#34;Error: SOURCE_PATH and DEST_PATH are required.\u0026#34; show_help exit 1 fi # è·å–å‚æ•° SOURCE_DIR=\u0026#34;${1%/}\u0026#34; DEST_DIR=\u0026#34;${2%/}\u0026#34; # æ£€æŸ¥æºç›®å½•æ˜¯å¦å­˜åœ¨ if [ ! -d \u0026#34;$SOURCE_DIR\u0026#34; ]; then echo \u0026#34;Error: Source directory does not exist.\u0026#34; exit 1 fi # åˆ›å»ºç›®æ ‡ç›®å½•ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ mkdir -p \u0026#34;$DEST_DIR\u0026#34; # å¯¼å‡ºç¯å¢ƒå˜é‡ export SOURCE_DIR export DEST_DIR export BITRATE export CACHE_DIR convert_to_opus_compress_cover() { input_file=$1 # è®¡ç®—è¾“å‡ºæ–‡ä»¶çš„è·¯å¾„ relative_path=\u0026#34;${input_file#\u0026#34;$SOURCE_DIR\u0026#34;/}\u0026#34; output_file=\u0026#34;$DEST_DIR/${relative_path%.*}.opus\u0026#34; # ç¼“å­˜ cover_convert_file=\u0026#34;$CACHE_DIR/${relative_path%.*}.jpg\u0026#34; mkdir -p \u0026#34;$(dirname \u0026#34;$cover_convert_file\u0026#34;)\u0026#34; # å·²å­˜åœ¨åˆ™è·³è¿‡ if [ -f \u0026#34;output_file\u0026#34; ]; then return 0; fi # åˆ›å»ºè¾“å‡ºæ–‡ä»¶æ‰€åœ¨çš„ç›®å½• output_file_dir=$(dirname \u0026#34;$output_file\u0026#34;) mkdir -p \u0026#34;$output_file_dir\u0026#34; # æå–å¹¶å‹ç¼©å°é¢ ffmpeg -hide_banner -loglevel warning -i \u0026#34;$input_file\u0026#34; -an -vcodec copy -f image2pipe - | ffmpeg -hide_banner -loglevel warning -i - -vf \u0026#34;scale=\u0026#39;if(gt(iw,1000),1000,iw)\u0026#39;:-1\u0026#34; \u0026#34;$cover_convert_file\u0026#34; # è½¬æ¢å¹¶åµŒå…¥å°é¢ ffmpeg -hide_banner -loglevel warning \\ -i \u0026#34;$input_file\u0026#34; -i \u0026#34;$cover_convert_file\u0026#34; -map 0:a -map 1:v -c:v copy -disposition:v attached_pic -metadata:s:v comment=\u0026#34;Cover (front)\u0026#34; -f flac - | opusenc --quiet --bitrate \u0026#34;$BITRATE\u0026#34; - \u0026#34;$output_file\u0026#34; # æ¸…ç†ç¼“å­˜ rm \u0026#34;$cover_convert_file\u0026#34; } export -f convert_to_opus_compress_cover find \u0026#34;$SOURCE_DIR\u0026#34; -type f -name \u0026#34;*.flac\u0026#34; -o -name \u0026#34;*.mp3\u0026#34; -o -name \u0026#34;*.wav\u0026#34; | parallel --progress convert_to_opus_compress_cover # å¤åˆ¶å…¶ä»–æ–‡ä»¶åˆ°ç›®æ ‡ç›®å½• if [ $AUDIO_ONLY = false ]; then rsync -a --include=\u0026#39;*/\u0026#39; --include=\u0026#39;*.lrc\u0026#39; --include=\u0026#39;*.jpg\u0026#39; --include=\u0026#39;*.png\u0026#39; --include=\u0026#39;*.webp\u0026#39; --exclude=\u0026#39;*\u0026#39; \u0026#34;$SOURCE_DIR/\u0026#34; \u0026#34;$DEST_DIR/\u0026#34; fi ","date":"2024-08-31","externalUrl":null,"permalink":"/posts/2024/ffmpeg-opus/","section":"Posts","summary":"å¦‚ä½•ä½¿ç”¨ FFmpeg å°†éŸ³é¢‘æ–‡ä»¶è½¬æ¢ä¸º Opusï¼Œä»¥åŠè½¬æ¢è¿‡ç¨‹ä¸­é‡åˆ°çš„å„ç§å‘","title":"ä½¿ç”¨ FFmpeg è½¬æ¢éŸ³é¢‘ä¸º Opusï¼šé¿å‘æŒ‡å—ä¸å®æˆ˜ç»éªŒ","type":"posts"},{"content":"è´­ä¹°ä½œå“æ—¶ï¼Œ1ç‚¹æ•°=1 JPYï¼Œå¯ç”¨äºæ”¯ä»˜ã€‚\nå‰è¨€ # DLsite ç›®å‰æä¾›çš„ç‚¹æ•°è´­å…¥ç½‘ç«™ä¸€å…±æœ‰ä¸‹é¢å‡ ç§ï¼š\nDianshu.JP\næ”¯æŒæ”¯ä»˜å®\næ±‡ç‡è¾ƒé«˜\nDLPay\næ”¯æŒç»‘å®šäº†é“¶è”çš„ PayPal è´¦æˆ· For Books\nå¤§æ¦‚åªæ”¯æŒå¢ƒå¤–å¡ï¼ˆæœªæµ‹è¯•ï¼‰ æ±‡ç‡é™·é˜± # Dianshu # Dianshu ä½œä¸º DLsite å®˜æ–¹æ¨èçš„ä¸­å›½å¤§é™†çš„æ”¯ä»˜æ–¹å¼ï¼Œè‡ªç„¶æ˜¯æœ€æ–¹ä¾¿çš„ï¼Œä½†æ˜¯ç›¸å¯¹çš„å…¶æ±‡ç‡è¾ƒé«˜\nç«™å†…ç»™å‡ºçš„é¢„ä¼°æ±‡ç‡ä¸ºå¤§æ¦‚ 1000JPY \u0026lt;-\u0026gt; 53RMB ï¼ˆæœªå®é™…è´­ä¹°ä¸ç¡®å®šæ˜¯å¦ä¸ºæœ€ç»ˆç»“ç®—æ±‡ç‡ï¼‰\nä½œä¸ºå‚è€ƒï¼Œæœ¬æ—¥ï¼ˆ2024-08-12ï¼‰çš„æ±‡ç‡ä¸º 1000JPY \u0026lt;-\u0026gt; 48.53RMBï¼Œè¶³è¶³è´µå‡º 5%ã€‚\nå› æ­¤åœ¨æ‹¥æœ‰å…¶ä»–æ”¯ä»˜æ–¹å¼æ—¶ä¸å»ºè®®ç›´æ¥ä½¿ç”¨ Dianshu\nDLPay # DLPay çš„è´­ä¹°è¦æ±‚è¾“å…¥ç”µå­é‚®ç®±ï¼Œä¹‹åä¼šå¾€é‚®ç®±å†…å‘é€ä¸€å°åŒ…æ‹¬è´­ä¹°ç‚¹æ•°è´­ä¹°é“¾æ¥çš„é‚®ä»¶ï¼Œç‚¹å‡»é“¾æ¥å¹¶ç™»å½• Paypal åè¿›å…¥ä»˜æ¬¾æ–¹å¼é€‰æ‹©çš„ç•Œé¢\nå¯ä»¥çœ‹åˆ°æ­¤æ—¶çš„æ±‡ç‡ä¸º 1000JPY \u0026lt;-\u0026gt; 51.21RMBï¼Œæ¯” Dianshu ä¾¿å®œä¸€äº›ï¼Œä½†ä»æ¯”æ±‡ç‡è´µä¸Šä¸å°‘\nç‚¹å‡» æŸ¥çœ‹æ±‡ç‡é€‰é¡¹ï¼Œå°†å¸ç§æ”¹ä¸º JPY\nè¿™æ ·ä¼šä½¿ç”¨å‘å¡ç»„ç»‡çš„æ±‡ç‡ç»“ç®—ï¼Œè€Œé Paypal æä¾›çš„æ±‡ç‡ç»“ç®—\næœ€ç»ˆå®é™…æ”¯ä»˜ 49.03RMBï¼Œè·Ÿæ±‡ç‡éå¸¸æ¥è¿‘\næ€»ç»“ # è´­ä¹° DLsite ç‚¹æ•°æ—¶ä½¿ç”¨ DLPay å¹¶ä¿®æ”¹ Paypal æ­¤æ¬¡è´­ç‰©ä½¿ç”¨çš„å¸ç§ä¸º JPY\n","date":"2024-08-12","externalUrl":null,"permalink":"/posts/2024/dlsite-202408/","section":"Posts","summary":"","title":"è®°ä¸€æ¬¡ DLsite ç‚¹æ•°è´­ç‰©","type":"posts"},{"content":" å‰è¨€ # ç½—æŠ€çš„æŸäº›é¼ æ ‡ ï¼ˆG502ã€G903ï¼‰çš„æ»šè½®ï¼Œå­˜åœ¨æ­¥è¿›/æ— ææ»šåŠ¨ä¸¤ç§æ¨¡å¼ï¼Œåœ¨ Linux ä¸‹ï¼Œæ­¥è¿›æ¨¡å¼çš„æ»šè½®ä¼šå‡ºç°æ»šä¸€ä¸‹ã€åŠ¨ä¸¤æ ¼çš„æƒ…å†µ\nè¿™ä¸ªé—®é¢˜è™½ç„¶åœ¨æµè§ˆå™¨ç­‰åœºæ™¯ä¸å¤ªæ˜æ˜¾ï¼Œæ»šåŠ¨å¯èƒ½åªä¼šå¯¼è‡´å‡ ä¸ªåƒç´ çš„å·®å¼‚ï¼Œä½†åœ¨ç»ˆç«¯ä¸­çš„æ»šåŠ¨å¾€å¾€ä¼šåç§»å‡ è¡Œï¼Œæˆ–è€…åœ¨éŸ³ä¹æ’­æ”¾å™¨ä¸­é€šè¿‡æ»šåŠ¨è°ƒæ•´éŸ³é‡ï¼ŒåŸºæœ¬ä¸Šæ°¸è¿œéƒ½æ²¡æ³•æ»šåŠ¨åˆ°æƒ³è¦çš„éŸ³é‡ä¸Š\nåœ¨ Minecraft ä¸­é—®é¢˜å°±æ›´ä¸¥é‡äº†ï¼Œæ»‘åŠ¨æ»šè½®ä¼šæ¥å›åœ¨å‡ ä¸ªå¿«æ·æ ä¹‹é—´è·³åŠ¨ï¼Œæƒ³è¦å‡†ç¡®åˆ©ç”¨æ»šè½®æ»šåŠ¨åˆ°ç›®æ ‡å¿«æ·æ ä¼šéå¸¸æ¼äºº\nè§£å†³æ–¹æ¡ˆ # ç›¸å…³çš„è®¨è®ºï¼š\nMouse scrolling behaves oddly on wayland\nHID++ Logitech G903 generates full scroll wheel events with every hi-res tick when attached via USB\nTL;DR\nè¿™ä¸ªé—®é¢˜æ˜¯ç”±å†…æ ¸æ¨¡å— hid_logitech_dj å’Œ hid_logitech_hidpp æ‰€é€ æˆçš„\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¸´æ—¶ç¦ç”¨è¿™ä¸¤ä¸ªæ¨¡å—ï¼šsudo rmmod hid_logitech_dj hid_logitech_hidpp\nå¦‚æœç¡®å®æœ‰ç”¨ï¼Œè¿›è¡Œå¦‚ä¸‹æ­¥éª¤æ°¸ä¹…ç¦ç”¨æ¨¡å—\næ–°å»ºæ–‡ä»¶ /etc/modprobe.d/99-custom-no-logitech-driver.conf\nåœ¨æ–‡ä»¶ä¸­æ·»åŠ ä»¥ä¸‹ä¸¤è¡Œ\nblacklist hid_logitech_dj blacklist hid_logitech_hidpp é‡æ–°æ’æ‹”æ— çº¿æ¥æ”¶å™¨ æ³¨æ„ï¼Œç¦ç”¨æ‰è¿™ä¸¤ä¸ªæ¨¡å—åï¼Œèƒ½ä¿®æ”¹é¼ æ ‡é…ç½®çš„ç¨‹åºï¼ˆå¦‚ Piper ç­‰ï¼‰ï¼Œå°†ä¼šæ— æ³•ä½¿ç”¨ï¼Œç¡®ä¿é…ç½®å®Œæˆä¹‹åå†è¿›è¡Œä»¥ä¸Šæ“ä½œ\n","date":"2024-08-12","externalUrl":null,"permalink":"/posts/2024/logitech-linux/","section":"Posts","summary":"","title":"ç½—æŠ€é¼ æ ‡æ— çº¿æ¨¡å¼ä¸‹åœ¨ Linux é‡Œçš„æ»šè½®é—®é¢˜","type":"posts"},{"content":"åœ¨ tmux ä¸­è¿›è¡Œ Arch Linux çš„æ»šåŠ¨æ›´æ–°\nå‰è¨€ # åœ¨ tmux ä¸­è¿›è¡Œæ»šåŠ¨æ›´æ–°ï¼Œæ¯”ç›´æ¥åœ¨ç»ˆç«¯ä¸­ç›´æ¥æ»šåŠ¨æœ‰ç€æ›´å¤šå¥½å¤„ï¼š\né˜²æ­¢æ›´æ–°è¿‡ç¨‹ä¸­è¯¯å…³é—­ç»ˆç«¯ æ›´æ–°åå…³é—­ç»ˆç«¯ä¹Ÿèƒ½é‡æ–°è¿æ¥å›å»æŸ¥çœ‹æ›´æ–°æ—¥å¿— ä½†æ˜¯å¦‚æœä¸æ˜¯é‡åº¦ tmux ç”¨æˆ·ï¼Œæ›´æ–°å‰æ‰‹åŠ¨è¿›å…¥ tmux å†æ›´æ–°æ˜¾å¾—æœ‰äº›ç¹ç\nå› æ­¤æœ¬æ–‡æå‡ºä¸€ä¸ªåœ¨æ™®é€šç»ˆç«¯ä¸‹ç›´æ¥å”¤èµ· tmux å¹¶è¿è¡Œæ›´æ–°å‘½ä»¤çš„è„šæœ¬ï¼Œæ­¤è„šæœ¬æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š\nåœ¨ç»ˆç«¯å†…è¿è¡Œè„šæœ¬ï¼Œå¦‚æœå¯¹åº”çš„ Session ä¸å­˜åœ¨ï¼Œåˆ™æ–°å»ºä¸€ä¸ª tmux Session å¹¶è¿è¡Œå‘½ä»¤ å¦‚æœå¯¹åº”çš„ Session å·²ç»å­˜åœ¨ï¼Œåˆ™ç›´æ¥è¿è¡Œå‘½ä»¤ï¼Œå¹¶è¿æ¥å›æ­¤ Session å¦‚æœå·²ç»åœ¨ tmux å†…ï¼Œç›´æ¥è¿è¡Œå‘½ä»¤ graph LR A[è¿è¡Œè„šæœ¬] B[Attach tmux Session] BN[New tmux Session] C[Command] A -- Session ä¸å­˜åœ¨ --- BN A -- Session å­˜åœ¨ --- B A -- å·²ç»åœ¨Sessionä¸­ --- C B --\u003e C BN --\u003e C ä½¿ç”¨ # å…¶ä¸­çš„ zsh æ˜¯ä¸ºäº†åœ¨å‘½ä»¤è¿è¡Œå®Œæ¯•åä¸é€€å‡ºï¼Œæ ¹æ®è‡ªå·±ä½¿ç”¨çš„æ›¿æ¢æˆ bash ç­‰ Shell\n#!/usr/bin/env bash session_name=\u0026#34;paru\u0026#34; cmd=\u0026#34;paru -Syu\u0026#34; # æ£€æŸ¥æ˜¯å¦å­˜åœ¨çš„tmux session if tmux has-session -t $session_name 2\u0026gt;/dev/null; then # æ£€æŸ¥æ˜¯å¦åœ¨tmuxå†… if [ -n \u0026#34;$TMUX\u0026#34; ]; then # åœ¨ tmux å†… bash -c \u0026#34;$cmd\u0026#34; else # ä¸åœ¨ tmux å†…ï¼Œåˆ™è¿æ¥åˆ°æ­¤sessionå¹¶è¿è¡Œå‘½ä»¤ tmux send-keys -t $session_name \u0026#34;$cmd\u0026#34; Enter tmux attach-session -t $session_name fi else # å¦‚æœä¸å­˜åœ¨ï¼Œåˆ™æ–°å»ºsessionå¹¶è¿è¡Œå‘½ä»¤ tmux new-session -s $session_name \u0026#34;${cmd}; zsh\u0026#34; fi ","date":"2024-05-07","externalUrl":null,"permalink":"/posts/2024/pacman-in-tmux/","section":"Posts","summary":"","title":"åœ¨ tmux ä¸­è¿›è¡Œ Arch Linux çš„æ»šåŠ¨æ›´æ–°","type":"posts"},{"content":"åœ¨ Linux ä¸Š ä½¿ç”¨ Steamcommunity 302 å¹¶ä½¿ç”¨ systemd å®ç°å¼€æœºè‡ªå¯\né…ç½® # æ ¹æ®éœ€è¦å‹¾é€‰æ‰€éœ€çš„åŠŸèƒ½\nchmod +x Steamcommunity_302 ./Steamcommunity_302 æµ‹è¯• # chmod +x steamcommunity_302.cli sudo ./steamcommunity_302.cli æµ‹è¯•æ˜¯å¦èƒ½æ­£å¸¸è®¿é—® steam åŠç¤¾åŒº\nè‡ªå¯ # ä¿®æ”¹è·¯å¾„\n# /etc/systemd/system/steamcommunity-302.service [Unit] Description=Steamcommunity_302 Steam Reverse Proxy After=network-online.target Wants=network-online.target [Service] WorkingDirectory=/path_to_302/Steamcommunity_302 ExecStart=/path_to_302/Steamcommunity_302/steamcommunity_302.cli [Install] WantedBy=multi-user.target ç„¶åå¯åŠ¨\nsystemctl enable --now steamcommunity-302.service v13 å·²ç»åŸç”Ÿæ”¯æŒ Linuxï¼Œä»¥ä¸‹ä¸ºæ—§ç‰ˆæœ¬é…ç½® åœ¨ Linux ä¸Š ä½¿ç”¨ Caddy åŸç”Ÿå®ç° Steamcommunity 302 çš„åŠŸèƒ½å¹¶å®ç°å¼€æœºè‡ªå¯\nä»¥ä¸‹æ“ä½œå‡åœ¨ Arch Linux ä¸‹è¿›è¡Œï¼Œå…¶ä»–å‘è¡Œç‰ˆå¯èƒ½éœ€è¦é€‚å½“ä¿®æ”¹è¯ä¹¦å®‰è£…çš„è·¯å¾„åŠæ‰€ç”¨å‘½ä»¤ ç”Ÿæˆé…ç½®æ–‡ä»¶ # ä¸ºäº†ç”Ÿæˆè‡ªå®šä¹‰é…ç½®ï¼Œéœ€è¦åœ¨ Wine ä¸‹è¿è¡Œ Steamcommunity302ï¼Œåœ¨è®¾ç½®é‡Œå‹¾é€‰éœ€è¦çš„æœåŠ¡ï¼Œå°†è¯ä¹¦æœŸé™ä¿®æ”¹ä¸º 10 å¹´ï¼Œç‚¹å‡» å¯¼å‡ºSteamDeckç‰ˆæœ¬ä¸€é”®å®‰è£…è„šæœ¬\nåœ¨ SteamDeck_302 æ–‡ä»¶å¤¹ä¸‹å°†å¦‚ä¸‹å‡ ä¸ªæ–‡ä»¶åˆ°ä»»æ„ç›®å½•ï¼Œè¿™é‡Œå‡å®šä¸º /data/caddyï¼Œæ ¹æ®éœ€è¦è‡ªè¡Œæ›¿æ¢ç›®å½•\nsteamcommunity.crt steamcommunity.key steamcommunity_302.caddy.json steamcommunityCA.pem å¤åˆ¶ Steamcommunity 302 è®¾ç½®é‡Œçš„ hosts åˆ° Linux çš„ /etc/hostsï¼Œæ ¹æ®åä»£æœåŠ¡é€‰æ‹©ä¸åŒï¼Œhosts æ¡ç›®ä¹Ÿä¸åŒï¼Œè¯·å¤åˆ¶è‡ªå·±è®¾ç½®å†…çš„ hosts\n127.0.0.1 steamcommunity.com #S302 127.0.0.1 www.steamcommunity.com #S302 127.0.0.1 store.steampowered.com #S302 127.0.0.1 checkout.steampowered.com #S302 127.0.0.1 api.steampowered.com #S302 127.0.0.1 help.steampowered.com #S302 127.0.0.1 login.steampowered.com #S302 127.0.0.1 store.akamai.steamstatic.com #S302 ä¸‹è½½ Caddy # åœ¨ caddy/release ä¸‹è½½å¯¹åº”å¹³å°çš„ caddyï¼ˆå¦‚ amd64 ä¸‹è½½ caddy_2.7.6_linux_amd64.tar.gz ï¼‰\nè§£å‹å‡ºæ¥ caddy äºŒè¿›åˆ¶æ–‡ä»¶æ”¾å…¥ /data/caddy\næ­¤æ—¶ä½ çš„ /data/caddy æ–‡ä»¶å¤¹ç»“æ„åº”å¦‚ä¸‹\ncaddy â”œâ”€â”€ caddy â”œâ”€â”€ steamcommunity_302.caddy.json â”œâ”€â”€ steamcommunityCA.pem â”œâ”€â”€ steamcommunity.crt â””â”€â”€ steamcommunity.key ç¼–è¾‘é…ç½® # ç›®å‰ä½¿ç”¨SteamDeckç‰ˆæœ¬ä¸€é”®å®‰è£…è„šæœ¬åˆ™æ— éœ€ä¿®æ”¹ï¼Œè¯·ç•¥è¿‡æœ¬èŠ‚ æ‰“å¼€ steamcommunity_302.caddy.json\næ‰¾åˆ°éšæœºç”Ÿæˆçš„ç«¯å£å·ï¼Œæ­¤å¤„ç«¯å£ä¸º 19736\nhttps://steamcommunity.com:19736 https://www.steamcommunity.com:19736 { tls steamcommunity.crt steamcommunity.key @steamcommunityrp { path /comment/* path /forum/* Â·Â·Â· https://store.steampowered.com:19736 https://api.steampowered.com:19736 https://help.steampowered.com:19736 https://login.steampowered.com:19736 https://store.akamai.steamstatic.com:19736 { #tls self_signed tls steamcommunity.crt steamcommunity.key Â·Â·Â· å°†æ‰€æœ‰çš„ :19736 åˆ é™¤ï¼Œå¤„ç†åçš„éƒ¨åˆ†å¦‚ä¸‹\nhttps://steamcommunity.com https://www.steamcommunity.com { tls steamcommunity.crt steamcommunity.key @steamcommunityrp { path /comment/* path /forum/* Â·Â·Â· https://store.steampowered.com https://api.steampowered.com https://help.steampowered.com https://login.steampowered.com https://store.akamai.steamstatic.com { #tls self_signed tls steamcommunity.crt steamcommunity.key Â·Â·Â· å®‰è£…è¯ä¹¦ # certutil -A -d sql:~/.pki/nssdb -n \u0026#34;Steamcommunity302\u0026#34; -t C,, -i \u0026#34;steamcommunityCA.pem\u0026#34; sudo cp steamcommunityCA.pem /etc/ca-certificates/trust-source/anchors/steamcommunityCA.crt sudo trust extract-compat å¯åŠ¨æœåŠ¡ # èµ‹äºˆ caddy å¯æ‰§è¡Œæƒé™\nchmod +x caddy èµ‹äºˆ caddy ç›‘å¬æ‰€éœ€ç«¯å£æƒé™\nsudo setcap CAP_NET_BIND_SERVICE=+eip caddy å¯åŠ¨\n./caddy run --config steamcommunity_302.caddy.json --adapter caddyfile å¦‚å¯åŠ¨æ— æŠ¥é”™ Ctrl+C å¼ºè¡Œåœæ­¢ï¼Œé…ç½® Systemd æœåŠ¡\næ–°å»ºç¼–è¾‘ .config/systemd/user/caddy.serviceï¼Œä¿®æ”¹ä¸¤å¤„ /data/caddy\n[Unit] Description=Caddy Steam Reverse Proxy [Service] WorkingDirectory=/data/caddy ExecStart=/data/caddy/caddy run --config steamcommunity_302.caddy.json --adapter caddyfile [Install] WantedBy=default.target è¿è¡Œå¹¶å¯åŠ¨æœåŠ¡\nsystemctl --user daemon-reload systemctl --user enable --now caddy.service æŸ¥çœ‹æœåŠ¡çŠ¶æ€\nsystemctl --user status caddy.service ç–‘éš¾è§£ç­” # steamcommunity_302.caddy.json ä¸å­˜åœ¨ï¼Ÿ steamcommunity 302 æœªæˆåŠŸè¿è¡Œï¼Œå°è¯•åœ¨ windows ç¯å¢ƒä¸‹é‡æ–°è¿è¡Œ ","date":"2024-05-07","externalUrl":null,"permalink":"/posts/2024/steam-caddy/","section":"Posts","summary":"åœ¨ Linux ä¸Š ä½¿ç”¨ Steamcommunity 302 å¹¶ä½¿ç”¨ systemd å®ç°å¼€æœºè‡ªå¯","title":"åœ¨ Linux ä¸Šåä»£ Steam ç¤¾åŒº","type":"posts"},{"content":"é€šè¿‡ä»£ç†è®¿é—®å®¶ä¸­æ‹¥æœ‰å…¬ç½‘ IP çš„ NAS\nå‰è¨€ # ä¼—æ‰€å‘¨çŸ¥ï¼Œç›´æ¥åœ¨æ‹¥æœ‰å…¬ç½‘ IP çš„å®¶å®½ä¸Šå¼€æ”¾ 80,443 ç­‰ç«¯å£æ˜¯å¯èƒ½ä¼šè¢«è¿è¥å•†æŸ¥æ°´è¡¨çš„ã€‚ä½†å½“ç”¨æˆ·æ‹¥æœ‰å¤§é‡å†…ç½‘æœåŠ¡æ—¶ï¼Œè®°ç«¯å£æ˜¯ä¸ªå¤§é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ç§èƒ½ç›´æ¥é€šè¿‡åŸŸåè®¿é—®å†…ç½‘æœåŠ¡ï¼Œä¸”å‡ºé—¨åœ¨å¤–æ—¶ä½¿ç”¨æ‰‹æœºä¹Ÿèƒ½è®¿é—®åˆ°å†…ç½‘æœåŠ¡çš„æ–¹æ¡ˆ\nå› æ­¤ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ ShadowSocks ä½œä¸ºè¿å›å†…ç½‘çš„æ¡¥æ¢ï¼Œä½¿ç”¨ Caddy ä¸ºå†…ç½‘æœåŠ¡æä¾›åå‘ä»£ç†ã€‚è¿™ç§æ–¹å¼æœ‰ä»¥ä¸‹å‡ ä¸ªä¼˜ç‚¹ï¼š\næ— æ„Ÿï¼šåœ¨å®é™…ä½¿ç”¨ä¸­ç”¨æˆ·ç›´æ¥ä½¿ç”¨åŸŸåè®¿é—®æœåŠ¡ å¿«é€Ÿï¼šä¸ frp è½¬å‘ç­‰æ–¹æ¡ˆç›¸æ¯”ï¼Œç”¨æˆ·ä¸æœåŠ¡ç›´è¿ï¼Œä¸ä¼šè¢«äº‘æœåŠ¡å™¨å¸¦å®½å¡è„–å­ æ‰©å±•æ€§é«˜ï¼šæ·»åŠ äº†æ–°æœåŠ¡ååªéœ€ä¿®æ”¹ Caddy é…ç½®å³å¯ç«‹å³ä½¿ç”¨ ä½†æ˜¯åŒæ—¶ä¹Ÿå¸¦æ¥äº†ä¸€äº›é—®é¢˜ï¼š\né…ç½®ç¨åŠ ç¹çï¼šç”¨æˆ·ç«¯éœ€è¦é…ç½® Clash ç­‰èƒ½å¤Ÿé“¾æ¥ ShadowSocks çš„è½¯ä»¶ ç¡¬æ€§è¦æ±‚å…¬ç½‘ IP è¦æ±‚ # å…·æœ‰å…¬ç½‘ IP çš„å®¶å®½ æ¥å…¥å®½å¸¦çš„ Linux è®¾å¤‡ å¯ä»¥ä½¿ç”¨ Clash æ¥å…¥ç½‘ç»œçš„ç»ˆç«¯ æ”¯æŒ DDNS åŠé€šé…ç¬¦è§£æçš„åŸŸå é…ç½® # å‡†å¤‡ # é¦–å…ˆç¡®å®šéœ€è¦è®¿é—®çš„æœåŠ¡çš„ IP åŠç«¯å£ï¼Œä¾‹å¦‚åœ¨å†…ç½‘ä¸­è¿è¡Œçš„ EMBY Serverã€Qbittorrentã€PVE ç­‰æœåŠ¡ï¼Œæ¥ä¸‹æ¥å°†ä¼šä»¥è¿™äº›æœåŠ¡ä½œä¸ºä¾‹å­\nEMBY Server: 192.168.50.254:8096 Qbittorrent: 192.168.50.254:8081 PVE: 192.168.50.10:8006 æœ¬ä¾‹ä¸­å°†ä½¿ç”¨åŸŸå example.com ä½œä¸ºä¾‹å­è¿›è¡ŒåŸŸåé…ç½®ï¼ŒåŸŸåæ‰˜ç®¡åœ¨ cloudflare ä¸Š\né…ç½® DNS # ä½¿ç”¨ DDNS è§£æå·¥å…·è¿›è¡Œå®¶å®½ IP çš„å›ºå®šè§£æï¼Œä¾‹å¦‚ ddns-goï¼Œå°† IP è§£æåˆ° a.example.com ä¸Šï¼Œå…·ä½“æ“ä½œæ­¥éª¤å‚è€ƒ ddns å·¥å…·æ–‡æ¡£\nå°† *.a.example.com è§£æåˆ° Caddy æ‰€åœ¨çš„åœ°å€ä¸Šï¼Œä¾‹å¦‚ 192.168.50.254\nè·å– cloudflare çš„ API Token\nè¿›å…¥ API Tokens é¡µé¢ï¼Œç‚¹å‡» Create Token æŒ‰é’®ï¼Œå†ç‚¹å‡» Get startedï¼Œå¡«å†™ Token nameï¼Œåœ¨ Permissions ä¸­æ·»åŠ ä¸¤ä¸ªæƒé™ï¼š\nZone / Zone / Read Zone / DNS / Edit é…ç½®å®Œæˆåè®°ä¸‹ Tokenï¼Œé…ç½® Caddy æ—¶éœ€è¦ç”¨åˆ°\né…ç½® Caddy # åœ¨å†…ç½‘ä¸­çš„æœåŠ¡å™¨ä¸Šé…ç½® Caddy æœåŠ¡ï¼Œæœ€å¥½åœ¨ä¸Šè¿°çš„ EMBY ç­‰æµé‡å¯èƒ½ä¼šå¾ˆå¤§çš„æœåŠ¡çš„åŒä¸€å°æœåŠ¡å™¨ä¸Šé…ç½®ï¼ŒåŒæ—¶éœ€è¦æ­¤æœåŠ¡å™¨çš„ 80,443 ç«¯å£å¯ä¾›å†…ç½‘è®¿é—®ï¼Œä½†æ— éœ€å¯¹å¤–ç½‘å¼€æ”¾ã€‚å°†è¦é…ç½® Caddy çš„æœåŠ¡å™¨çš„ IP ä¾‹ä¸º 192.168.50.254\nç¼–è¯‘é•œåƒ # ç”±äºæœ¬æ–‡ä½¿ç”¨ Cloudflare æ‰˜ç®¡åŸŸåï¼Œéœ€è¦ä½¿ç”¨å…·æœ‰ Cloudflare æ¨¡å—çš„ Caddy è¿›è¡Œè¯ä¹¦çš„é…ç½®ï¼Œé¦–å…ˆç¼–å†™ Dockerfileï¼š\nFROM caddy:2.7-builder AS builder RUN xcaddy build \\ --with github.com/caddy-dns/cloudflare FROM caddy:2.7 COPY --from=builder /usr/bin/caddy /usr/bin/caddy åœ¨ Dockerfile æ‰€åœ¨çš„ç›®å½•ä¸‹è¿è¡Œ docker build --tag=caddy-cf . ç¼–è¯‘é•œåƒ\né…ç½® Caddyfile # æ ¹æ®è‡ªå·±æœåŠ¡å¡«å†™ Caddyfileï¼Œå°†ä¸Šé¢å¾—åˆ°çš„ cloudflare API Token å¡«å…¥é…ç½®ä¸­\n{ http_port 80 https_port 443 } *.a.example.com { tls { dns cloudflare YOUR_API_TOKEN_HERE } } https://emby.a.example.com { reverse_proxy 192.168.50.254:8096 } https://qbit.a.example.com { reverse_proxy 192.168.50.254:8081 } https://pve.a.example.com { reverse_proxy 192.168.50.10:8006 { transport http { tls_insecure_skip_verify } } } å¯åŠ¨ Caddy # å®Œæˆåå¯åŠ¨ Caddyï¼Œæ³¨æ„éœ€è¦ --cap-add=NET_ADMINï¼Œä»¥åŠ 80,443 ç«¯å£æœªè¢«å…¶ä»–åº”ç”¨å ç”¨\ndocker run -d --cap-add=NET_ADMIN --name=caddy --restart=always \\ -v \u0026#34;$PWD\u0026#34;/Caddyfile:/etc/caddy/Caddyfile \\ -v \u0026#34;$PWD\u0026#34;/data:/data \\ --network=host \\ caddy-cf å®Œæˆåæ­¤æ—¶ä½¿ç”¨å†…ç½‘è®¾å¤‡åº”è¯¥å·²ç»èƒ½ä½¿ç”¨ https://emby.a.example.com ç­‰åœ¨ Caddy ä¸­é…ç½®è¿‡çš„åŸŸåè®¿é—®å¯¹åº”æœåŠ¡äº†ï¼Œä½†æ˜¯å› ä¸º *.a.example.com è§£æåˆ°äº†ä¸€ä¸ªå†…ç½‘åœ°å€ï¼Œæ‰€ä»¥æ— æ³•ä»å…¬ç½‘è®¿é—®\né…ç½® ShadowSocks # å’Œ Caddy åŒç†ï¼Œå› ä¸ºæµé‡ä¼šç»è¿‡ ShadowSocks è¿›è¡Œè½¬å‘ï¼Œæ‰€ä»¥å°½é‡å°† ShadowSocks å®‰è£…åœ¨å¤§æµé‡æœåŠ¡çš„åŒä¸€æœåŠ¡å™¨ä¸Š\nå®‰è£… shadowsocks-rust\nåœ¨ /etc/shadowsocks-rust/server.json ä¸­å¡«å†™ä»¥ä¸‹å†…å®¹\n{ \u0026#34;server\u0026#34;: \u0026#34;0.0.0.0\u0026#34;, \u0026#34;server_port\u0026#34;: 51888, \u0026#34;password\u0026#34;: \u0026#34;YOUR_PASSWORD_HERE\u0026#34;, \u0026#34;timeout\u0026#34;: 300, \u0026#34;method\u0026#34;: \u0026#34;chacha20-ietf-poly1305\u0026#34;, \u0026#34;dns\u0026#34;: \u0026#34;google\u0026#34; } å»ºè®®ä½¿ç”¨ ssservice genkey -m \u0026quot;chacha20-ietf-poly1305\u0026quot; ç”Ÿæˆè¾ƒå¼ºçš„å¯†ç \nå¯åŠ¨ ShadowSocks æœåŠ¡ systemctl enable --now shadowsocks-rust-server@server.service\nShadowSocks æ‰€éœ€è¦çš„ç«¯å£å¯ä»¥ä»»æ„æŒ‡å®šï¼Œä½†éœ€è¦åœ¨åé¢çš„æ­¥éª¤ä¸­é…ç½®ç«¯å£è½¬å‘ä¸”æš´éœ²è‡³å…¬ç½‘ï¼Œå»ºè®®ä½¿ç”¨éšæœºé«˜ç«¯å£å·ä»¥åŠè¾ƒå¼ºçš„å¯†ç ä¿è¯å®‰å…¨\nç«¯å£è½¬å‘ # åœ¨å†…ç½‘ä¸»è·¯ç”±å™¨ä¸Šé…ç½®ç«¯å£è½¬å‘ï¼Œé…ç½®æ–¹æ³•æ ¹æ®è·¯ç”±å“ç‰Œå„æœ‰ä¸åŒã€‚\nä»¥åç¡•ä¸ºä¾‹ï¼Œè¿›å…¥ å¤–éƒ¨ç½‘ç»œ-ç«¯å£è½¬å‘-æ·»åŠ è®¾ç½®æ–‡ä»¶\nå¤–éƒ¨ç«¯å£å¡«å†™ä»»æ„ç«¯å£ï¼Œåç»­é…ç½® Clash æ—¶éœ€è¦è¿™ä¸ªç«¯å£ä»¥è¿æ¥ ShadowSocks æœåŠ¡ å†…éƒ¨ç«¯å£å¡«å†™ä¸Šè¿°çš„ ShadowSocks é…ç½®æ–‡ä»¶ä¸­çš„ server_port æœ¬åœ° IP åœ°å€å¡«å†™ SHadowSocks æœåŠ¡æ‰€åœ¨çš„æœåŠ¡å™¨å†…ç½‘ IP æœ¬ä¾‹ä¸­ä¸º\nå¤–éƒ¨ç«¯å£ å†…éƒ¨ç«¯å£ æœ¬åœ° IP åœ°å€ é€šä¿¡åè®® 51888 51888 192.168.50.254 BOTH è¿™æ ·ç†è®ºä¸Šå°±èƒ½é€šè¿‡ è·¯ç”±å™¨å…¬ç½‘IP:51888 ç«¯å£è®¿é—® ShadowSocks æœåŠ¡äº†ï¼›ç”±äºæˆ‘ä»¬å·²ç»é…ç½®äº† DDNSï¼Œæ‰€ä»¥ä¹Ÿèƒ½é€šè¿‡ a.example.com:51888 ç«¯å£è®¿é—® ShadowSocks æœåŠ¡\né…ç½® Clash # åœ¨éœ€è¦åœ¨å¤–ç½‘è®¿é—®å†…ç½‘çš„è®¾å¤‡ä¸Šé…ç½® Clash å®¢æˆ·ç«¯\nåœ¨ Clash é…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®\nproxies: - name: \u0026#34;NAS\u0026#34; type: ss server: a.example.com port: 51888 cipher: chacha20-ietf-poly1305 password: \u0026#34;YOUR_PASSWORD_HERE\u0026#34; rules: - DOMAIN-SUFFIX,a.example.com,NAS æˆ–è€…å¦‚æœæƒ³è¦åœ¨å†…ç½‘ç¯å¢ƒä¸‹ä¸æµé‡ç»è¿‡ ShadowSocksï¼Œç›´æ¥ä½¿ç”¨ç›´è¿ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹é…ç½®\nproxies: - name: \u0026#34;NAS\u0026#34; type: ss server: a.example.com port: 51888 cipher: chacha20-ietf-poly1305 password: \u0026#34;YOUR_PASSWORD_HERE\u0026#34; proxy-groups: - { name: HOME, type: fallback, proxies: [DIRECT, NAS], url: \u0026#34;https://test.a.example.com\u0026#34;, interval: 3600, } rules: - DOMAIN-SUFFIX,a.example.com,HOME å†…ç½‘ä¸‹ test.a.example.com æŒ‡å‘ 192.168.50.254ï¼Œurl-test æ—¶è¿é€šï¼Œæ‰€ä»¥ a.example.com ä¼šèµ° DIRECT ç›´è¿\nå¤–ç½‘ç¯å¢ƒä¸‹ä¸è¿é€šï¼Œa.example.com çš„æµé‡ä¼šåˆ†æµåˆ° NAS è§„åˆ™ä¸‹ï¼Œç»è¿‡ ShadowSocks è½¬å‘è‡³å†…ç½‘ä¸­\næµ‹è¯• # è‡³æ­¤é…ç½®å®Œæˆï¼Œä½¿ç”¨ç»ˆç«¯æµ‹è¯•è¿æ¥ï¼Œåœ¨å¼€å¯äº† Clash åï¼Œè®¿é—® emby.a.example.com åº”èƒ½æ­£å¸¸è¿æ¥ï¼Œä¸”æ‹¥æœ‰å®Œæ•´çš„ TLS åŠ å¯†\n","date":"2024-05-05","externalUrl":null,"permalink":"/posts/2024/network-home/","section":"Posts","summary":"","title":"å®‰å…¨ä¾¿åˆ©åœ°è®¿é—®å®¶é‡Œçš„ NAS","type":"posts"},{"content":" æœ¬ç¯‡ä¸º https://ejmastnak.com/tutorials/arch/caps2esc çš„æ•´ç†ä¸ç¿»è¯‘ å‰è¨€ # ç›®æ ‡ # ä½¿ç”¨ caps2esc ï¼Œè®© Caps Lock é”®åœ¨å•ç‹¬æŒ‰ä¸‹æ—¶å……å½“ Escape é”®ï¼Œåœ¨ä¸å…¶ä»–é”®ç»„åˆæŒ‰ä¸‹æ—¶å……å½“ Control é”®ã€‚\nåŠ¨æœº # æ„‰å¿«ã€ç¬¦åˆäººä½“å·¥ç¨‹å­¦ï¼Œç³»ç»ŸèŒƒå›´åœ°å°† Caps Lock æ˜ å°„ä¸ºéå¸¸æœ‰ç”¨çš„ Escape å’Œ Control é”®ï¼Œä»¥åŠæ‹¥æœ‰æ›´å¥½çš„ Vim æˆ– Emacs ä½“éªŒã€‚\nå‚è€ƒ # caps2esc GitLab é¡µé¢ Ask Ubuntu: å¦‚ä½•å®‰è£… caps2escï¼Ÿ ä»‹ç» # caps2esc å®ç”¨ç¨‹åºå…è®¸æ‚¨åœ¨ libevdev åº“çº§åˆ«å°† Caps Lock é‡æ–°æ˜ å°„åˆ° Escape å’Œ Controlã€‚å› ä¸º libevdev ç›¸å¯¹åº•å±‚â€”â€”ä»…é«˜äºæ“ä½œç³»ç»Ÿå†…æ ¸â€”â€”æ‰€ä»¥æ­¤è§£å†³æ–¹æ¡ˆé™¤äº†å›¾å½¢ç¯å¢ƒå¤–ï¼Œè¿˜é€‚ç”¨äºçº¯ Linux æ§åˆ¶å°ã€‚\nå®‰è£…ä½¿ç”¨ # å®‰è£… # ä» Arch ä»“åº“å®‰è£… caps2esc åŒ…ï¼š\n# Install caps2esc sudo pacman -S interception-caps2esc è¿™è¿˜ä¼šå°† interception-tools åŒ…ä½œä¸ºä¾èµ–é¡¹è¿›è¡Œå®‰è£…ã€‚ interception-tools åŒ…å«ä¸€ä¸ªåä¸º udevmon çš„è¾“å…¥è®¾å¤‡ç›‘è§†ç¨‹åºï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒæ¥æ•è· Caps Lock å’Œ Escapeã€‚\né…ç½® # åˆ›å»ºé…ç½®æ–‡ä»¶ /etc/udevmon.yaml ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š\n- JOB: \u0026#34;intercept -g $DEVNODE | caps2esc | uinput -d $DEVNODE\u0026#34; DEVICE: EVENTS: EV_KEY: [KEY_CAPSLOCK, KEY_ESC] è¯´æ˜ï¼ˆç‚¹å‡»å±•å¼€ï¼‰\næ­¤ udevmon ä½œä¸šåœ¨æŒ‰ä¸‹ Caps Lock å’Œ Escape é”®ï¼ˆç”±åç§° KEY_CAPSLOCK å’Œ KEY_ESC æ ‡è¯†ï¼‰æ—¶è¿è¡Œ shell å‘½ä»¤ intercept -g $DEVNODE | caps2esc | uinput -d $DEVNODE ï¼›udevmon å°†æ ¹æ®éœ€è¦å°† $DEVNODE å˜é‡è®¾ç½®ä¸ºåŒ¹é…è®¾å¤‡çš„è·¯å¾„ï¼ˆ /dev ç›®å½•ä¸­çš„æŸä¸ªè™šæ‹Ÿæ–‡ä»¶ï¼‰ã€‚\nshell å‘½ä»¤ä½¿ç”¨ intercept ç¨‹åºè·å– Caps Lock æˆ– Escape é”®çš„è¾“å…¥è®¾å¤‡ï¼Œå°†é”®äº‹ä»¶ç®¡é“ä¼ è¾“åˆ° caps2esc ç¨‹åºï¼ˆè¯¥ç¨‹åºå®ç° Caps Lock åˆ° Escape/Control é€»è¾‘ï¼‰ï¼Œç„¶åä½¿ç”¨ uinput å°†å¤„ç†åçš„è¾“å‡ºç®¡é“ä¼ è¾“å›è™šæ‹Ÿé”®è®¾å¤‡ã€‚ï¼ˆä½ å¯ä»¥é˜…è¯» Interception Tools/How it works ä»¥äº†è§£è¯¦ç»†ä¿¡æ¯ã€‚ï¼‰\nTipï¼šä¸Šè¿° udevmon é…ç½®å°†ä½¿ Caps Lock ä½œä¸º Escape å’Œ Control é”®å·¥ä½œï¼Œå¹¶å°† Escape é”®ä½œä¸º Caps Lock é”®å·¥ä½œã€‚å¦‚æœæ‚¨å¸Œæœ› Escape é”®ä»ä½œä¸º Escape é”®å·¥ä½œï¼Œæ‚¨å¯ä»¥ç”¨ caps2esc -m 1 æ›¿æ¢ caps2esc ï¼Œå®ƒä½¿ç”¨ caps2esc â€œæœ€å°æ¨¡å¼â€å¹¶ä¸”ä¸å½±å“ Escape é”®ï¼ˆæœ‰å…³æ–‡æ¡£ï¼Œè¯·å‚è§ caps2esc -h ï¼‰ã€‚\næ‚¨ç°åœ¨åªéœ€å¯åŠ¨ udevmon ç¨‹åºï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ systemd å•å…ƒæ¥æ‰§è¡Œæ­¤æ“ä½œã€‚\né…ç½® udevmon çš„ systemd æœåŠ¡ # åˆ›å»º systemd æœåŠ¡å•å…ƒæ–‡ä»¶ /etc/systemd/system/udevmon.service ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰ï¼Œå¹¶åœ¨å…¶ä¸­æ·»åŠ å†…å®¹ï¼š\n[Unit] Description=udevmon Wants=systemd-udev-settle.service After=systemd-udev-settle.service # Use `nice` to start the `udevmon` program with very high priority, # using `/etc/udevmon.yaml` as the configuration file [Service] ExecStart=/usr/bin/nice -n -20 /usr/bin/udevmon -c /etc/udevmon.yaml [Install] WantedBy=multi-user.target æ­¤æœåŠ¡å•å…ƒä»¥éå¸¸é«˜çš„ä¼˜å…ˆçº§å¯åŠ¨ udevmon ç¨‹åºï¼ˆ nice å…è®¸æ‚¨è®¾ç½®ç¨‹åºçš„è°ƒåº¦ä¼˜å…ˆçº§ï¼› -20 niceness æ˜¯æœ€é«˜å¯èƒ½çš„ä¼˜å…ˆçº§ï¼‰ã€‚ç¡®ä¿ ExecStart è¡Œï¼ˆä¾‹å¦‚ /usr/bin/udevmon ï¼‰ä¸­çš„ uvdevmon è·¯å¾„ä¸ which udevmon çš„è¾“å‡ºç›¸åŒ¹é…ã€‚\nç„¶åå¯ç”¨å¹¶å¯åŠ¨ udevmon æœåŠ¡ï¼š\n# Enable and start the `udevmon` service sudo systemctl enable --now udevmon.service # Optionally verify the `udevmon` service is active and running systemctl status udevmon æ­¤æ—¶åº”è¯¥å·²ç»å®Œæˆäº†ï¼Œå°è¯•ä½¿ç”¨ä¾‹å¦‚ \u0026lt;CapsLock\u0026gt;-L æ¥æ¸…é™¤ç»ˆç«¯å±å¹•ï¼ˆå°±åƒä½ é€šå¸¸ä½¿ç”¨ \u0026lt;Ctrl\u0026gt;-L æ‰€åšçš„é‚£æ ·ï¼‰ã€‚å¦‚æœå¯ç”¨äº† udevmon æœåŠ¡ï¼Œåˆ™ udevmon ä¼šè‡ªåŠ¨åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶å¯åŠ¨ã€‚\n","date":"2024-04-19","externalUrl":null,"permalink":"/posts/2024/caps2esc/","section":"Posts","summary":"ä½¿ç”¨ caps2esc ï¼Œè®© Caps Lock é”®åœ¨å•ç‹¬æŒ‰ä¸‹æ—¶å……å½“ Escape é”®ï¼Œåœ¨ä¸å…¶ä»–é”®ç»„åˆæŒ‰ä¸‹æ—¶å……å½“ Control é”®","title":"å°† CapsLock é‡æ˜ å°„åˆ° Esc å’Œ Ctrl","type":"posts"},{"content":"","date":"2024-04-10","externalUrl":null,"permalink":"/tags/docker/","section":"Tags","summary":"","title":"Docker","type":"tags"},{"content":" https://danthesalmon.com/running-docker-on-proxmox/ åœ¨ PVE ä¸‹çš„ LXC å®¹å™¨å†…è¿è¡Œ Docker å®¹å™¨æ—¶ï¼Œè‹¥å‡ºç° unable to apply caps: operation not permitted: unknown. åˆ™éœ€è¦åœ¨ PVE ä¸‹è¿›è¡Œä¸€äº›é…ç½®\nåœ¨/etc/pve/lxc/\u0026lt;id\u0026gt;.confä¸­æ·»åŠ ï¼š\nlxc.apparmor.profile: unconfined lxc.cgroup.devices.allow: a lxc.cap.drop: ","date":"2024-04-10","externalUrl":null,"permalink":"/posts/2024/pve-lxc-docker/","section":"Posts","summary":"åœ¨PVEä¸‹çš„LXCå®¹å™¨ä¸­è¿è¡ŒDockerå®¹å™¨æ—¶ï¼Œè‹¥å‡ºç°unable to apply caps: operation not permitted: unknown.é”™è¯¯ï¼Œéœ€è¦åœ¨PVEä¸‹è¿›è¡Œä¸€äº›é…ç½®","title":"LXC å®¹å™¨ä¸­çš„ Docker è®¾ç½®","type":"posts"},{"content":"åœ¨ä½¿ç”¨æŸäº›è½¯ä»¶æ—¶å¯èƒ½ä¼šåœ¨ Log å†…çœ‹åˆ° Failed to set real-time priority for thread: Operation not permitted (1) ç±»ä¼¼çš„æç¤ºï¼Œå¯ä»¥é€šè¿‡å®‰è£…åŒ… realtime-privileges å¹¶å°†å½“å‰ç”¨æˆ·æ·»åŠ è¿› realtime ç»„ä¸­è§£å†³\nä½† rtkit-daemon ä¼šåœ¨ Log ä¸­è¾“å‡ºä¸€å¤§å †çš„ rtkit-daemon[1498]: Supervising 1 threads of 1 processes of 1 users. å½±å“å…¶ä»–æ—¥å¿—çš„æµè§ˆ\nè§£å†³æ–¹æ¡ˆ # ä¿®æ”¹ rtkit-daemon.service :\n# systemctl edit rtkit-daemon [Service] LogLevelMax=5 å…¶ä¸­ LogLevel å¯¹åº”çš„å¯ä»¥æœ‰ä»¥ä¸‹å‡ ä¸ªçº§åˆ«\n0 or emergency, (highest priority messages) 1 or alert, 2 or critical, 3 or error, 4 or warning, 5 or notice, 6 or info 7 or debuginfo (lowest priority messages) ","date":"2024-04-10","externalUrl":null,"permalink":"/posts/2024/silent-rtkit-daemon/","section":"Posts","summary":"\u0026ldquo;Failed to set real-time priority for thread: Operation not permitted\u0026rdquo;","title":"è®© rtkit-daemon é—­å˜´","type":"posts"},{"content":"ä¿®æ”¹ Captive Portal è§£å†³ç±»åŸç”Ÿâ€œæ— ç½‘ç»œâ€çš„æƒ…å†µ\nadb shell settings put global captive_portal_http_url http://connect.rom.miui.com/generate_204 adb shell settings put global captive_portal_https_url https://connect.rom.miui.com/generate_204 ","date":"2024-04-10","externalUrl":null,"permalink":"/posts/2024/captive-portal/","section":"Posts","summary":"ä¿®æ”¹ Captive Portal è§£å†³ç±»åŸç”Ÿâ€œæ— ç½‘ç»œâ€çš„æƒ…å†µ","title":"ä¿®æ”¹ Captive Portal","type":"posts"},{"content":"","date":"2024-02-04","externalUrl":null,"permalink":"/tags/git/","section":"Tags","summary":"","title":"Git","type":"tags"},{"content":" ouch stands for Obvious Unified Compression Helper.\nIt\u0026rsquo;s a CLI tool for compressing and decompressing for various formats.\nSupported formats # Format .tar .zip 7z .gz .xz, .lzma .bz, .bz2 .lz4 .sz (Snappy) .zst .rar Supported âœ“ âœ“Â¹ âœ“Â¹ âœ“Â² âœ“ âœ“ âœ“ âœ“Â² âœ“ âœ“Â³ âœ“: Supports compression and decompression.\nâœ“Â¹: Due to limitations of the compression format itself, (de)compression can\u0026rsquo;t be done with streaming.\nâœ“Â²: Supported, and compression runs in parallel.\nâœ“Â³: Due to RAR\u0026rsquo;s restrictive license, only decompression and listing can be supported. If you wish to exclude non-free code from your build, you can disable RAR support by building without the unrar feature.\nBenchmarks # Compress # compress tar tar.gz tar.zst tar.xz tar.bz2 tar.lz4 tar.sz 7z zip time 0.331 3.535 1.397 5:22.61 58.079 0.430 0.304 5:27.61 29.441 size 1G 761M 754M 768M 758M 1G 1G 768M 761M cpu 99% 1170% 99% 99% 99% 99% 641% 99% 99% compress tar tar.gz tar.zst tar.xz tar.bz2 7z zip ouch 0.331 3.535 1.397 5:22.61 58.079 5:27.61 29.441 tar 0.458 29.950 1.158 5:40.00 1:02.82 p7zip 43.131 zip 29.455 Decompress # decompress tar tar.gz tar.zst tar.xz tar.bz2 tar.lz4 tar.sz 7z zip time 0.529 3.212 2.703 34.474 35.898 0.769 0.690 41.182 3.166 cpu 99% 99% 99% 99% 99% 99% 99% 99% 99% decompress tar tar.gz tar.zst tar.xz tar.bz2 tar.lz4 tar.sz 7z zip ouch 0.529 3.212 2.703 34.474 35.898 0.769 0.690 41.182 3.166 tar 0.572 4.815 1.014 33.701 35.457 0.604 0.534 p7zip 30.890 unzip 4.885 ","date":"2024-02-04","externalUrl":null,"permalink":"/posts/2024/ouch-benchmark/","section":"Posts","summary":"Simple benchmark of ouch","title":"Ouch Benchmark","type":"posts"},{"content":"æ‰¹é‡ä¿®æ”¹ Git ä»“åº“ä¸­çš„ commit author email\nå®‰è£… # å®‰è£… git-filter-repo\nä¿®æ”¹ # å°† E1@example.com ä¿®æ”¹ä¸º E2@example.com\ngit filter-repo --email-callback \u0026#39;return email if email != b\u0026#34;E1@example.com\u0026#34;else b\u0026#34;E2@example.com\u0026#34;\u0026#39; æ³¨æ„ # ä¿®æ”¹åéœ€è¦å¼ºåˆ¶æ¨é€æ‰èƒ½ä¿®æ”¹è¿œç¨‹ä»“åº“ git push -f\n","date":"2024-02-04","externalUrl":null,"permalink":"/posts/2024/git-email/","section":"Posts","summary":"å¦‚ä½•æ‰¹é‡ä¿®æ”¹Gitä»“åº“ä¸­çš„æäº¤ä½œè€…é‚®ç®±ã€‚é€šè¿‡ä½¿ç”¨git filter-repoå‘½ä»¤ï¼Œå¹¶éœ€è¦å¼ºåˆ¶æ¨é€æ‰èƒ½ä¿®æ”¹è¿œç¨‹ä»“åº“ã€‚","title":"æ‰¹é‡ä¿®æ”¹ Git å†å²ä¸­çš„ç”¨æˆ·é‚®ç®±","type":"posts"},{"content":"å®‰è£…åŒ… webp-pixbuf-loader\n","date":"2024-02-04","externalUrl":null,"permalink":"/posts/2024/nemo-webp/","section":"Posts","summary":"è¦åœ¨Nemoä¸­æ˜¾ç¤ºWebPç¼©ç•¥å›¾ï¼Œéœ€è¦å®‰è£…webp-pixbuf-loaderè½¯ä»¶åŒ…ã€‚","title":"ä½¿ nemo å¯ä»¥æ˜¾ç¤º WebP ç¼©ç•¥å›¾","type":"posts"},{"content":"sudo pacman -S texlive-latexextra texlive-xetex texlive-langchinese texlive-formatsextra texlive-binextra ","date":"2024-02-04","externalUrl":null,"permalink":"/posts/2024/arch-latex/","section":"Posts","summary":"","title":"åœ¨ Arch Linux ä¸Šä½¿ç”¨ LaTeX éœ€è¦å®‰è£…çš„åŒ…","type":"posts"},{"content":" æœ¬æ–‡å†…å®¹æ¥è‡ªï¼šSSH å¯†é’¥ä¸€é”®é…ç½®è„šæœ¬ ä½¿ç”¨æ•™ç¨‹ - P3TERX ğŸ“ è¯­æ³•åŠé€‰é¡¹è¯´æ˜ # bash \u0026lt;(curl -fsSL s.sakari.top/key.sh) [é€‰é¡¹...] \u0026lt;å‚æ•°\u0026gt;\no - è¦†ç›–æ¨¡å¼ï¼Œå¿…é¡»å†™åœ¨æœ€å‰é¢æ‰ä¼šç”Ÿæ•ˆ g - ä» GitHub è·å–å…¬é’¥ï¼Œå‚æ•°ä¸º GitHub ç”¨æˆ·å u - ä» URL è·å–å…¬é’¥ï¼Œå‚æ•°ä¸º URL f - ä»æœ¬åœ°æ–‡ä»¶è·å–å…¬é’¥ï¼Œå‚æ•°ä¸ºæœ¬åœ°æ–‡ä»¶è·¯å¾„ p - ä¿®æ”¹ SSH ç«¯å£ï¼Œå‚æ•°ä¸ºç«¯å£å· d - ç¦ç”¨å¯†ç ç™»å½• ğŸ¤— ä½¿ç”¨æ–¹æ³• # å®‰è£…å…¬é’¥ # ä» GitHub è·å–å…¬é’¥ # åœ¨ GitHub å¯†é’¥ç®¡ç†é¡µé¢ æ·»åŠ å…¬é’¥ï¼Œæ¯”å¦‚æˆ‘çš„ç”¨æˆ·åæ˜¯ sakarie9ï¼Œé‚£ä¹ˆåœ¨ä¸»æœºä¸Šè¾“å…¥ä»¥ä¸‹å‘½ä»¤å³å¯ï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -g sakarie9 ä» URL è·å–å…¬é’¥ # æŠŠå…¬é’¥ä¸Šä¼ åˆ°ç½‘ç›˜ï¼Œé€šè¿‡ç½‘ç›˜é“¾æ¥è·å–å…¬é’¥ï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -u https://example.com/key.pub ä»æœ¬åœ°æ–‡ä»¶è·å–å…¬é’¥ # é€šè¿‡ FTP çš„æ–¹å¼æŠŠå…¬é’¥ä¼ åˆ° VPS ä¸Šï¼Œç„¶åæŒ‡å®šå…¬é’¥è·¯å¾„ï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -f ~/key.pub è¦†ç›–æ¨¡å¼ # ä½¿ç”¨è¦†ç›–æ¨¡å¼ï¼ˆ-oï¼‰å°†è¦†ç›– /.ssh/authorized_keys æ–‡ä»¶ï¼Œä¹‹å‰çš„å¯†é’¥ä¼šè¢«å®Œå…¨æ›¿æ¢æ‰ï¼Œé€‰é¡¹å¿…é¡»å†™åœ¨æœ€å‰é¢æ‰ä¼šç”Ÿæ•ˆï¼Œæ¯”å¦‚ï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -o -g sakarie9 æˆ–è€…\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -og sakarie9 ç¦ç”¨å¯†ç ç™»å½• # åœ¨ç¡®å®šä½¿ç”¨å¯†é’¥èƒ½æ­£å¸¸ç™»å½•åç¦ç”¨å¯†ç ç™»å½•ï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -d ä¿®æ”¹ SSH ç«¯å£ # æŠŠ SSH ç«¯å£ä¿®æ”¹ä¸º 2222ï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -p 2222 ä¸€é”®æ“ä½œ # å®‰è£…å¯†é’¥ã€ä¿®æ”¹ç«¯å£ã€ç¦ç”¨å¯†ç ç™»å½•ä¸€é”®æ“ä½œï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -og sakarie9 -p 2222 -d ä¸€é”®æ“ä½œ ä¸ä¿®æ”¹ç«¯å£ # å®‰è£…å¯†é’¥ã€ç¦ç”¨å¯†ç ç™»å½•ä¸€é”®æ“ä½œï¼š\nbash \u0026lt;(curl -fsSL s.sakari.top/key.sh) -og sakarie9 -d ","date":"2023-12-23","externalUrl":null,"permalink":"/posts/2023/ssh-key-installer/","section":"Posts","summary":"","title":"SSH å¯†é’¥ä¸€é”®é…ç½®è„šæœ¬","type":"posts"},{"content":"ä½¿ç”¨ dae å’Œ clash å®ç°å…¨å±€ä»£ç†ï¼Œé€æ˜ä¸”é«˜æ€§èƒ½\nGithub ä»“åº“\nä½¿ç”¨é¡¹ç›® # daeï¼šé«˜æ€§èƒ½å…¨å±€é€æ˜ä»£ç† Clash.Metaï¼šä½œä¸º dae çš„ä¸Šæ¸¸æä¾›ä»£ç† caddyï¼šå¯é€‰ï¼Œä¸ºæŸäº›å—åˆ° SNI é˜»æ–­çš„æœåŠ¡æä¾›ç›´è¿ å®‰è£… # daeï¼Œæ³¨æ„ dae å¯¹å†…æ ¸ç‰ˆæœ¬æœ‰è¦æ±‚\nä¸€ä¸ªæ­£å¸¸å·¥ä½œçš„ä»£ç†å®¢æˆ·ç«¯ï¼Œclashã€clash-metaã€clash for windowsã€v2ray ç­‰å‡å¯\né…ç½® # clash # æœ¬èŠ‚å¯è·³è¿‡ï¼Œå¯ä½¿ç”¨ç°æœ‰çš„æ­£å¸¸å·¥ä½œçš„é…ç½®æ–‡ä»¶ï¼Œä»…éœ€è¦ä¿è¯ clash çš„ç«¯å£å’Œ dae node ä¸­é…ç½®çš„ä¸€è‡´ã€‚ä¸ dae å…±åŒä½¿ç”¨æ—¶è¯·ä¿è¯ä»£ç†çš„å„ç§å…¨å±€ä»£ç†æ–¹æ¡ˆï¼ˆtunã€iptables ç­‰ï¼‰å‡å·²å…³é—­\nè½¬æ¢è®¢é˜… # è‡ªè¡Œæ­å»º proxy-provider-converterï¼Œæˆ–ä½¿ç”¨ proxy-converter.sakari.topï¼Œå°† clash è®¢é˜…è½¬æ¢æˆ Proxy Provider æ”¯æŒçš„æ ¼å¼ï¼Œæˆ–ç›´æ¥ä½¿ç”¨ v2ray è®¢é˜…è¿æ¥\nä¿®æ”¹é…ç½® # ç¼–è¾‘ clash/config.yamlï¼Œå°†è½¬æ¢åçš„é“¾æ¥å¡«å…¥ url ä¸­\nä¸‹è½½ Yacd-metaï¼Œè§£å‹è‡³é…ç½®æ–‡ä»¶ä¸­ external-ui æ‰€åœ¨ç›®å½•\næ ¹æ®éœ€è¦ä¿®æ”¹åˆ†æµè§„åˆ™\ndae # ä¿®æ”¹ dae/config.daeï¼Œå°† wan_interface çš„å€¼ä¿®æ”¹ä¸ºè‡ªå·±çš„ç½‘å¡ï¼Œå¯ä»¥ä½¿ç”¨ ip a æŸ¥çœ‹\næ ¹æ®ä½¿ç”¨çš„ä»£ç†åœ¨ routing ä¸‹æ·»åŠ è§„åˆ™ï¼Œå¦‚ pname(clash) -\u0026gt; must_direct\ncaddy # æ— ç›´è¿éœ€æ±‚å¯è·³è¿‡ï¼Œå‚è€ƒ åœ¨Linuxä¸Šä½¿ç”¨Caddyåä»£Steamç¤¾åŒº\n","date":"2023-04-05","externalUrl":null,"permalink":"/posts/2023/dae-clash/","section":"Posts","summary":"","title":"ä½¿ç”¨ dae å’Œ clash å®ç°çš„å…¨å±€ä»£ç†æ–¹æ¡ˆ","type":"posts"},{"content":"ä½œä¸º github-actions[bot] è¿›è¡Œ commitï¼Œé¿å…æ±¡æŸ“ commit è®°å½•\nä½¿ç”¨æ–¹å¼ # git config user.email \u0026#34;41898282+github-actions[bot]@users.noreply.github.com\u0026#34; git config user.name \u0026#34;github-actions[bot]\u0026#34; git commit æ•ˆæœ # ","date":"2023-03-10","externalUrl":null,"permalink":"/posts/2023/github-actions-bot/","section":"Posts","summary":"","title":"ä½œä¸º github-actions[bot] è¿›è¡Œ commit","type":"posts"},{"content":"WM ä¸‹é…ç½®ç³»ç»Ÿå…¨å±€å…‰æ ‡ä¸»é¢˜\nå®‰è£… # ä»¥ Catppuccin-Cursors ä¸ºä¾‹\nå‚è€ƒ Installation\nparu -S catppuccin-cursors-frappe é…ç½® # nwg-look # ä½¿ç”¨ nwg-look é…ç½®\nåœ¨é¼ æ ‡å…‰æ ‡å¤„é€‰æ‹©ç›®æ ‡ä¸»é¢˜ï¼Œåº”ç”¨\nç¯å¢ƒå˜é‡ # export XCURSOR_THEME=catppuccin-frappe-light-cursors export XCURSOR_SIZE=32 GTK # è‹¥å·²ä½¿ç”¨ nwg-look é…ç½®,åˆ™æ— éœ€ä¿®æ”¹\ngsettings set org.gnome.desktop.interface cursor-theme catppuccin-frappe-light-cursors gsettings set org.gnome.desktop.interface cursor-size 32 è¿‡æ—¶çš„å†…å®¹ ä¸‹è½½ # ä»¥ Catppuccin-Frappe-Light-Cursors ä¸ºä¾‹\nä»ä»“åº“ä¸‹è½½ Catppuccin-Frappe-Light-Cursors.zipï¼Œè§£å‹è‡³ ~/.local/share/icons\nicons â”œâ”€â”€ Catppuccin-Frappe-Light-Cursors â”‚Â â”œâ”€â”€ cursors â”‚Â â””â”€â”€ index.theme é…ç½® # Qt # ~/.icons/default/index.theme\n[icon theme] Inherits=Catppuccin-Frappe-Light-Cursors ç¯å¢ƒå˜é‡ # ~/.zlogin\nexport XCURSOR_THEME=Catppuccin-Frappe-Light-Cursors export XCURSOR_SIZE=32 GTK # gsettings set org.gnome.desktop.interface cursor-theme Catppuccin-Frappe-Light-Cursors gsettings set org.gnome.desktop.interface cursor-size 32 Hyprland # ~/.config/hypr/hyprland.conf\nexec-once = hyprctl setcursor Catppuccin-Frappe-Light-Cursors 32 ","date":"2022-12-24","externalUrl":null,"permalink":"/posts/2022/linux-cursor/","section":"Posts","summary":"WM ä¸‹é…ç½®ç³»ç»Ÿå…¨å±€å…‰æ ‡ä¸»é¢˜","title":"Linux å…‰æ ‡ä¸»é¢˜é…ç½®","type":"posts"},{"content":"","date":"2022-07-23","externalUrl":null,"permalink":"/tags/cloudflare/","section":"Tags","summary":"","title":"Cloudflare","type":"tags"},{"content":" 2022/12/28, Heroku å°†ç»“æŸå…è´¹æ–¹æ¡ˆï¼Œæ­¤æ•™ç¨‹åŒæ­¥ä½œåºŸ\nHeroku çš„å…è´¹æ–¹æ¡ˆä¸‹ï¼Œå•ä¸ªç”¨æˆ·æ‰€æœ‰ app æ¯æœˆçš„æ€»è¿è¡Œæ—¶é•¿ä¸è¶…è¿‡550å°æ—¶ï¼Œä¸”ä¸èƒ½ç»‘å®šè‡ªå·±çš„åŸŸåï¼Œå¦‚æœéœ€è¦å…¨å¤©åœ¨çº¿éœ€è¦ç»‘å®šé“¶è¡Œå¡ï¼Œå¯¹äºç™½å«–ç”¨æˆ·ç›¸å½“ä¸å‹å¥½ã€‚ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç»™ Heroku å¥—ä¸Šä¸€å±‚ Cloudflare æ¥å®ç°å…¨æœˆåœ¨çº¿å’ŒåŸŸåç»‘å®š\nåŸç† # ä½¿ç”¨ Cloudflare Workers å¯¹ Heroku è¿›è¡Œåä»£å¹¶æ‰‹åŠ¨å®ç°ç®€å•çš„è´Ÿè½½å‡è¡¡\néœ€æ±‚ # ä¸€ä¸ªä½¿ç”¨ Cloudflare è¿›è¡ŒåŸŸåè§£æçš„åŸŸå ä¸¤ä¸ª Heroku è´¦æˆ·ï¼ˆæ— éœ€éªŒè¯ä¿¡ç”¨å¡ï¼‰ é…ç½® # Heroku é…ç½® # åœ¨ä¸¤ä¸ªè´¦å·ä¸‹åˆ†åˆ«é…ç½®ä¸¤ä¸ªé¡¹ç›®ï¼Œåˆ‡å‹¿é…ç½®åœ¨åŒä¸€è´¦æˆ·ä¸‹ï¼Œå…è´¹æ—¶é—´æ˜¯ä»¥è´¦æˆ·ä¸ºå•ä½è€Œéå®ä¾‹ã€‚é…ç½®è¿‡ç¨‹ç•¥ï¼Œæ ¹æ®è‡ªå·±éœ€è¦é€‰æ‹©ï¼Œæœ€åéœ€è¦ä¸¤ä¸ªè¿™æ ·çš„ URL https://******.herokuapp.com/\nCloudflare é…ç½® # æ·»åŠ  DNS è®°å½•ï¼Œç±»å‹ AAAAï¼Œåç§°è‡ªå®šï¼ŒIPv6 åœ°å€ä¸º 100::ï¼Œä»£ç†çŠ¶æ€æ‰“å‹¾ï¼Œä¿å­˜\nWorkers - ç®¡ç† Workers - åˆ›å»ºæœåŠ¡ï¼ŒæœåŠ¡åç§°è‡ªå®šï¼Œè¿™é‡Œå‡è®¾ä¸º heroku-dnsï¼Œåˆ›å»ºæœåŠ¡\nç‚¹å‡»å¿«é€Ÿç¼–è¾‘ï¼Œå¡«å…¥ä»¥ä¸‹ä»£ç ï¼Œæ‰‹åŠ¨æ›¿æ¢ url1 å’Œ url2ï¼Œä¿å­˜å¹¶éƒ¨ç½²\naddEventListener( \u0026#34;fetch\u0026#34;,event =\u0026gt; { let url=new URL(event.request.url); let localDate = new Date(); let day = localDate.getDate(); if (day\u0026lt;15) //æ¯æœˆå‰åäº”å¤©ä½¿ç”¨url1,ååäº”å¤©ä½¿ç”¨url2 { url.hostname=\u0026#34;******.herokuapp.com\u0026#34;; //url1 } else { url.hostname=\u0026#34;******.herokuapp.com\u0026#34;; //url2 } //console.log(`Request url: ${url.hostname}`); let request=new Request(url,event.request); event. respondWith( fetch(request) ) } ) Workers - HTTP è·¯ç”± - æ·»åŠ è·¯ç”±ï¼Œè·¯ç”± å¤„å¡«å†™ åç§°.åŸŸå.é¡¶çº§åŸŸå/*ï¼Œåç§°å¤„å¡«å†™ç¬¬ä¸€æ­¥ä¸­ DNS è®°å½•é‡Œå¡«å†™çš„åç§°ï¼ŒåŸŸåå¡«å†™å½“å‰åœ¨ Cloudflare æ·»åŠ è§£æçš„åŸŸåï¼Œåˆ«å¿˜äº†åé¢çš„ /*ï¼›æœåŠ¡é€‰æ‹©ç¬¬äºŒæ­¥æ–°å»ºçš„ heroku-dnsï¼Œç¯å¢ƒ productionï¼Œä¿å­˜\næ­¤æ—¶è®¿é—®åŸŸåå°±èƒ½è®¿é—®åˆ°éƒ¨ç½²åœ¨ Heroku ä¸Šçš„æœåŠ¡ï¼Œå¯ä»¥åœ¨ Workers çš„ç¼–è¾‘ç•Œé¢æµ‹è¯•ï¼Œå–æ¶ˆæ‰ console.log è¡Œçš„æ³¨é‡Šï¼Œå‘é€è¯·æ±‚å°±èƒ½åœ¨æ§åˆ¶å°çœ‹åˆ°å½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸ª URL\næœ€å # å•ä¸ªè´¦æˆ·çš„ 550 å°æ—¶ç”¨åŠä¸ªæœˆæ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜çš„ï¼Œå¯ä»¥ä½¿ç”¨ uptime ç­‰ç›‘æ§ç¨‹åºæ¯15åˆ†é’Ÿä¸€æ¬¡ä½¿ Heroku æ°¸ä¸ä¼‘çœ ï¼Œé¿å…å”¤é†’æ—¶çš„å·¨å¤§è®¿é—®å»¶è¿Ÿ\n","date":"2022-07-23","externalUrl":null,"permalink":"/posts/2022/heroku-cf/","section":"Posts","summary":"","title":"Heroku+Cloudflare å…è´¹è´¦å·å®ç°24/7åœ¨çº¿åŠåŸŸåç»‘å®š","type":"posts"},{"content":"ä¼—æ‰€å‘¨çŸ¥ï¼ŒJavaç‰ˆçš„Minecraftæ˜¯ä¼šåƒæ‰å¾ˆå¤šå†…å­˜çš„ï¼Œä½†æœ€å¤§å†…å­˜ä¹Ÿä¼šå—åˆ° -Xmx ç­‰JVMå‚æ•°çš„é™åˆ¶ã€‚å¦‚æœå®ƒå ç”¨çš„å†…å­˜èƒ½è¾¾åˆ°ä¸¤å€çš„æœ€å¤§å†…å­˜é™åˆ¶ï¼Œç”šè‡³èƒ½åƒæ‰æ‰€æœ‰çš„ç‰©ç†å†…å­˜+è™šæ‹Ÿå†…å­˜ï¼Œæ˜¾ç„¶æ˜¯ä¸åˆç†çš„ã€‚\nç›¸å…³ Issue # radeonsi: VRAM Leak/abnormally high usage in Minecraft mod pack é—®é¢˜å·²åœ¨æ–°ç‰ˆ mesa ä¸­æœ‰æ‰€ç¼“è§£\nç¯å¢ƒ # OS: Arch Linux x86_64 Kernel: 5.18.12-zen1-1-zen CPU: AMD Ryzen 5 5600G with Radeon Graphics (12) GPU: AMD ATI Cezanne GPU: AMD ATI Radeon RX 580 Memory: 16GB mesa 22.1.3-1 Minecraft 1.7.10 GTNewHorizons-1.7.10-2.1.2.3qf polymc 1.3.2 è¿‡ç¨‹ # åˆé‡é—®é¢˜ # ç»™ Minecraft åˆ†é…æœ€å¤§ 8GB å†…å­˜ï¼ŒåŠ ä¸Šå…¶ä»–ç¨‹åºå’Œç³»ç»Ÿçš„å ç”¨ï¼Œæ¸¸æˆæ‰“å¼€è¿›å…¥æœåŠ¡å™¨åå†…å­˜å ç”¨ä¼šåœ¨ 10GB å·¦å³æµ®åŠ¨ï¼Œæ¸¸æˆè¿‡ç¨‹ä¸­å†…å­˜å ç”¨ä¼šä¸æ–­å¢åŠ ï¼Œç”šè‡³ç”¨å°½ç‰©ç†å†…å­˜ã€‚æ­¤æ—¶çš„ java å†…å­˜å ç”¨åœ¨ 10GB å·¦å³ï¼Œä½† free -h æ˜¾ç¤ºå¦‚ä¸‹ï¼ˆå…·ä½“æ•°å€¼æ˜¯æˆ‘ç¼–çš„å¯èƒ½å¯¹ä¸ä¸Šä½†å¤§æ¦‚æ˜¯è¿™ä¸ªæ„æ€ï¼‰\ntotal used free shared buff/cache available å†…å­˜ï¼š 15Gi 14.9Gi 0.5Gi 228Mi 0.5Gi 1.1Gi äº¤æ¢ï¼š 17Gi 8Gi 9Gi å¯ä»¥çœ‹å‡ºä¸ä»…ç‰©ç†å†…å­˜ç”¨å°½ï¼Œè™šæ‹Ÿå†…å­˜ä¹Ÿä½¿ç”¨äº†å¾ˆå¤§ä¸€éƒ¨åˆ†ï¼Œä½†å¾ˆæ˜æ˜¾å·²ä½¿ç”¨çš„å†…å­˜å’Œå„è¿›ç¨‹çš„å†…å­˜å ç”¨æ€»å’Œå¯¹ä¸ä¸Šã€‚æ­¤æ—¶ Minecraft å·²ç»å¼€å§‹ç”±äºå†…å­˜ä¸è¶³è¿›è¡Œé«˜å¼ºåº¦ GC è€Œäº§ç”Ÿé—´æ­‡æ€§å¡é¡¿ï¼Œæ­¤æ—¶å¦‚æœä¸å…³é—­MCï¼Œå¾…è™šæ‹Ÿå†…å­˜æ¶ˆè€—æ®†å°½æ—¶ä¼šå› ä¸º OOM å¼ºè¡Œç»ˆæ­¢æ‰ java è¿›ç¨‹ï¼Œæˆ–è€…å´©æ‰å…¶ä»–è¿›ç¨‹ã€‚æœ€ä¸¥é‡çš„ä¸€æ¬¡ä¼¼ä¹æ˜¯å´©æ‰äº† systemdï¼Œ poweroff å’Œ journalctl éƒ½æ²¡æœ‰å“åº”ï¼Œå…¶æ¬¡æ˜¯å´©æ‰äº† sway çª—å£ç®¡ç†å™¨\nä½†é—®é¢˜å°±æ¥äº†ï¼Œ java è¿›ç¨‹ç»ˆæ­¢åï¼Œå†…å­˜å ç”¨ä¾æ—§å¼‚å¸¸ï¼Œå¾ˆæ˜æ˜¾æˆ‘çš„æ‰€æœ‰è¿›ç¨‹çš„å†…å­˜ä½¿ç”¨é‡æ€»å’Œæ˜¯ä¸å¯èƒ½æœ‰ä¸‹å›¾æ‰€ç¤º10.8GiBè¿™ä¹ˆå¤šçš„ï¼Œé‚£ä¹ˆå¤šå‡ºæ¥çš„å†…å­˜éƒ½å»å“ªäº†å‘¢\nåˆ†æå†…å­˜ # æ ¹æ® /proc/meminfoä¹‹è°œ ç»™å‡ºçš„å…¬å¼åˆ†æå†…å­˜\nMemTotal = MemFree +ã€Slab+ VmallocUsed + PageTables + KernelStack + HardwareCorrupted + Bounce + Xã€‘+ã€Active + Inactive + Unevictable + (HugePages_Total * Hugepagesize)ã€‘ å‘ç°å¤šå ç”¨çš„å†…å­˜æ•°é‡ä¸å…¬å¼é‡Œçš„ X æ¥è¿‘ï¼Œæ³¨è§£é‡Œè¡¨ç¤º Xè¡¨ç¤ºç›´æ¥é€šè¿‡alloc_pages/__get_free_pageåˆ†é…çš„å†…å­˜ï¼Œæ²¡æœ‰åœ¨/proc/meminfoä¸­ç»Ÿè®¡ï¼Œä¸çŸ¥é“æœ‰å¤šå°‘ï¼Œå°±åƒä¸ªé»‘æ´ã€‚ çŒœæµ‹æˆ–è®¸æ˜¯ java å¼•å‘äº†å†…å­˜æ³„æ¼\næ›´æ¢ jdk # æ­¤å‰ä½¿ç”¨çš„ä¸€ç›´æ˜¯ AUR ä¸­çš„ jdk8-graalvm-binï¼Œå°è¯•æ›´æ¢å¦‚ä¸‹å‡ ä¸ªç‰ˆæœ¬çš„ jdkï¼Œå¹¶è®¾ç½®å¯¹åº”çš„ JVM å‚æ•°ï¼Œä½†å¹¶æ²¡æœ‰æ˜æ˜¾æ”¹å–„\nOracle jdk8 jdk8-dragonwell jdk8-adoptopenjdk jdk8-openjdk-shenandoah jdk8-openj9 é¢˜å¤–è¯ï¼Œè¿™äº› jdk ä¹‹ä¸­ï¼Œå†…å­˜å ç”¨å’Œæ€§èƒ½è¡¨ç°æœ€ä¼˜ç§€çš„å¤§æ¦‚æ˜¯ jdk8-dragonwellï¼Œæœ‰å…´è¶£çš„å¯ä»¥è¯•è¯• Alibaba Dragonwell8 JDK\nå¢åˆ  mod # ç”±äº GTNH è¿™ä¸ªæ•´åˆåŒ…çš„ mod æ•°é‡æœ‰250+ä¸ªï¼Œæ²¡åŠæ³•ä¸€ä¸ªä¸ªæµ‹è¯•å†…å­˜é—®é¢˜ï¼Œåªå•ç‹¬æŠŠå‡ ä¸ªä¼˜åŒ–ç›¸å…³çš„ mod åŠ åŠ å‡å‡æµ‹è¯•æ•°æ¬¡ä½†é—®é¢˜ä¾æ—§ï¼Œç›´åˆ°æ·»åŠ äº†ä¸€ä¸ªæ€§èƒ½åˆ†æ modï¼Œå®ƒå‘Šè¯‰æˆ‘ç°åœ¨åœ¨ç”¨æ ¸æ˜¾è·‘ Minecraftï¼Œä½¿ç”¨ nvtop è§‚å¯Ÿï¼Œåˆ†é…çš„ 512MB æ ¸æ˜¾æ˜¾å­˜æ­¤æ—¶å°†è¿‘æ»¡è½½ï¼Œjava è¿›ç¨‹æ¶ˆè€—äº†å¤§çº¦ 200MB çš„æ˜¾å­˜ï¼ˆè‡³å°‘ä»–æ˜¯è¿™ä¹ˆå†™çš„ï¼‰\næ ¸æ˜¾ç‹¬æ˜¾ # åœ¨åŒæ˜¾å¡çš„ Linux å¹³å°ä¸Šï¼Œæ ¸æ˜¾ç‹¬æ˜¾çš„åˆ‡æ¢å¯ä»¥é€šè¿‡ä½¿ç”¨ DRI_PRIME å®ç°ï¼Œæ¯”å¦‚ DRI_PRIME=1 vkcube å°±ä¼šè°ƒç”¨æˆ‘çš„ç‹¬æ˜¾è¿è¡Œ\nè€Œåœ¨ polymc ä¸Šï¼Œæˆ‘è®¾ç½®çš„ env DRI_PRIME=1 å¹¶æ²¡æœ‰ç”Ÿæ•ˆï¼Œ Minecraft ä¾ç„¶åœ¨ä½¿ç”¨é»˜è®¤å€¼ä¹Ÿå°±æ˜¯æ ¸æ˜¾è¿è¡Œã€‚é‡æ–°è®¾ç½® polymcï¼Œåœ¨ è‡ªå®šä¹‰å‘½ä»¤-åŒ…è£…å™¨å‘½ä»¤ ä¸­å¡«å…¥ sh -c \u0026quot;export DRI_PRIME=1;gamemoderun $INST_JAVA \\\u0026quot;$@\\\u0026quot;\u0026quot; ï¼Œå¯åŠ¨ï¼Œé€šè¿‡ radeontop å’Œ nvtop ç›‘æ§ï¼ŒæˆåŠŸåœ¨ç‹¬æ˜¾ä¸Šè¿è¡Œ\næ˜¾å­˜ # é‚£é—®é¢˜æ˜¯ä¸æ˜¯è§£å†³äº†ï¼Ÿå¹¶æ²¡æœ‰ï¼Œå†…å­˜ä¾ç„¶ä¼šæº¢å‡ºï¼Œä½†æ˜¯æ¯”ä»¥å‰æ’‘çš„æ—¶é—´æ›´é•¿äº†ï¼Œä½¿ç”¨ radeontop å’Œ nvtop æŸ¥çœ‹ï¼Œå‘ç°ç‹¬æ˜¾çš„ 4GB æ˜¾å­˜å·²ç»æ»¡äº†ï¼ŒMinecraft è¿™ä¸ªæ¸¸æˆèƒ½ä½¿ç”¨æ»¡ 4GB çš„æ˜¾å­˜æ˜æ˜¾æ˜¯å¾ˆä¸åˆç†çš„ï¼Œå³ä½¿æ˜¯è¿™ä¹ˆå¤š mod çš„å¤§å‹æ•´åˆåŒ…ã€‚é‡å¯å†å¼€å‘ç°ï¼Œæ˜¾å­˜å ç”¨æ»¡ä¹‹å‰å†…å­˜å ç”¨éƒ½æ˜¯æ­£å¸¸çš„ï¼Œè€Œæ˜¾å­˜æ»¡äº†ä¹‹åï¼Œå†…å­˜å ç”¨å°±å¼€å§‹ä¸æ­£å¸¸äº†\næ‰€ä»¥ç°åœ¨è°œåº•å·²ç»å¾ˆæ˜æ˜¾äº†ï¼Œå¤šå‡ºæ¥çš„é‚£éƒ¨åˆ† X ï¼Œå°±æ˜¯è¢«å½“æˆæ˜¾å­˜ä½¿ç”¨çš„å†…å­˜ã€‚\nä½¿ç”¨æ ¸æ˜¾çš„æ—¶å€™åˆ†é…çš„ 512MB çš„æ˜¾å­˜æ˜¯ä¸å¤Ÿç”¨çš„ï¼Œå°±ä¼šæŠŠç‰©ç†å†…å­˜å½“æˆæ˜¾å­˜æ¥ç”¨ï¼Œè¿™éƒ¨åˆ†å°±æ˜¯ radeontop ä¸­çš„ GTTã€‚ç‹¬æ˜¾ä¹Ÿä¸€æ ·ï¼Œç‹¬ç«‹çš„æ˜¾å­˜èƒ½ç¼“è§£å†…å­˜çˆ†æ‰çš„é€Ÿåº¦ï¼Œä½†æ€»è¿˜æ˜¯ä¼šçˆ†çš„\nç¼–è¯‘ # çŸ¥é“äº†æ˜¯æ˜¾å­˜å ç”¨é—®é¢˜è€Œéå†…å­˜é—®é¢˜åï¼Œæœåˆ°äº†è¿™ä¹ˆä¸€ä¸ª issue\nradeonsi: VRAM Leak/abnormally high usage in Minecraft mod pack\nç—‡çŠ¶å‡ ä¹å’Œæˆ‘é‡åˆ°çš„ä¸€æ¨¡ä¸€æ ·ï¼Œè¯„è®ºæŒ‡å‡ºäº†å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡é™ä½ mesa æŸæ®µä»£ç ä¸­çš„ buffer size å¯ä»¥ç¼“è§£æ˜¾å­˜å ç”¨é—®é¢˜ï¼Œå¼€å§‹å‡†å¤‡é‡æ–°ç¼–è¯‘ mesa\nä»¥ä¸‹æ­¥éª¤åŸºäº ArchLinuxï¼Œå…¶ä»–å‘è¡Œç‰ˆä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œä½†å¯ä»¥å‚è€ƒå¹¶æ‰‹åŠ¨ä¿®æ”¹ç¼–è¯‘\nä½¿ç”¨ asp è·å– mesa çš„ PKGBUILD\nmkdir ~/build cd ~/build asp update mesa asp export mesa cd mesa ä¿®æ”¹ PKGBUILD\nåœ¨ prepare() ä¸­æ·»åŠ ä¸€è¡Œ sed å‘½ä»¤\nprepare() { cd mesa-$pkgver sed -i \u0026#39;s/20\\*1024\\*1024/20\\*1024/g\u0026#39; src/mesa/vbo/vbo_save.h } ç¼–è¯‘\nmakepkg -s è‹¥æç¤º PGP é”™è¯¯å¯å°è¯•\nmakepkg -s --skippgpcheck å®‰è£…\nç¼–è¯‘å®Œæˆåç›®å½•ä¸‹ä¼šæœ‰è®¸å¤šåŒ…ï¼Œå®‰è£…è‡ªå·±éœ€è¦çš„åŒ…\nsudo pacman -U mesa-22.1.3-1-x86_64.pkg.tar.zst æµ‹è¯• # é‡å¯ä¹‹åæ‰“å¼€ Minecraft æµ‹è¯•ï¼Œå››ä¸ªå°æ—¶å·¦å³æ˜¾å­˜å ç”¨åªæœ‰ 1GBï¼Œè™½ç„¶å¯èƒ½æ²»äº†æ ‡æ²¡æ²»æœ¬ï¼Œä½†èµ·ç ä¸ç”¨æ¯ä¸€ä¸ªå°æ—¶é‡å¯ç”µè„‘é‡Šæ”¾å†…å­˜äº†\næ€»ç»“ # TL;DRï¼Œè§£å†³æ­¤é—®é¢˜æœ€æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯é‡æ–°ç¼–è¯‘ä¿®æ”¹è¿‡çš„ mesaï¼Œä½†ä¸ºä»€ä¹ˆä»–ä»¬ä¼šè®¾ç½®è¿™ä¹ˆå¤§çš„æ•°å€¼å’±ä¹Ÿä¸çŸ¥é“ï¼Œè‡³å°‘åœ¨è¿™ä¸ªåŸºäº Minecraft 1.7.10 çš„ GTNH æ•´åˆåŒ…ä¹‹å¤–çš„æ¸¸æˆé‡Œæ˜¾å­˜è¡¨ç°éƒ½æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå¯èƒ½æ˜¯æ—§ç‰ˆJDK + æ—§ç‰ˆMinecraft + å¤§å‹æ•´åˆåŒ…å¸¦æ¥çš„ä¸‰é‡ DEBUFF å§\n","date":"2022-07-19","externalUrl":null,"permalink":"/posts/2022/minecraft-memory/","section":"Posts","summary":"","title":"Minecraft åœ¨ Linux ä¸‹å†…å­˜å ç”¨æå¤šçš„é—®é¢˜","type":"posts"},{"content":"ä½¿ç”¨ ADB å¼€å¯ Lawnchair åº”ç”¨æŠ½å±‰çš„ä¸­è‹±æ··æ’ æ— éœ€root\né—®é¢˜æè¿° # åœ¨ç±»åŸç”Ÿç³»ç»Ÿçš„åˆæ¬¡å¼€æœºè®¾ç½®æ—¶ï¼Œå¦‚æœæ£€æµ‹åˆ°å›½å†…SIMå¡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å°†è¯­è¨€åˆ‡æ¢æˆ ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰ ï¼Œè€Œè¿™ä¸ªè¯­è¨€åœ¨ç³»ç»Ÿçš„ æ·»åŠ è¯­è¨€ åˆ—è¡¨é‡Œé¢æ˜¯æ²¡æœ‰çš„ï¼Œä½ åªèƒ½æ‰¾åˆ° ç®€ä½“ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰\nç±»åŸç”Ÿè‡ªå¸¦çš„å¯åŠ¨å™¨ï¼ˆQuickStepã€Lawnchair ç­‰ï¼‰åœ¨ ç®€ä½“ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰ ä¸‹ï¼Œåº”ç”¨æŠ½å±‰ä¼šæŒ‰ç…§ä¸­æ–‡åœ¨å‰ï¼Œè‹±æ–‡åœ¨åï¼ˆæˆ–è€…åè¿‡æ¥ï¼‰çš„æ–¹å¼æ’åºï¼Œå¹¶ä¸”ç¼ºå°‘ç›¸å…³çš„è®¾ç½®é¡¹ï¼›è€Œåœ¨ ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰ ä¸‹ï¼Œè¿™äº›å¯åŠ¨å™¨å¯ä»¥æ­£å¸¸æŒ‰ç…§ä¸­æ–‡æ‹¼éŸ³é¦–å­—æ¯è¿›è¡Œä¸­è‹±æ··æ’\nç®€ä½“ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰Â |Â ä¸­æ–‡ï¼ˆä¸­å›½ï¼‰ è§£å†³æ–¹æ¡ˆ # æ‰‹æœºè¿æ¥ç”µè„‘å¼€å¯USBè°ƒè¯•ï¼Œè¾“å…¥\nadb shell settings put system system_locales zh-CN,zh-Hans-CN é‡å¯ï¼Œå®Œæˆ\n","date":"2022-07-13","externalUrl":null,"permalink":"/posts/2022/android-language/","section":"Posts","summary":"","title":"Lawnchair åº”ç”¨æŠ½å±‰ä¸­è‹±æ··æ’","type":"posts"},{"content":"","date":"2022-01-20","externalUrl":null,"permalink":"/tags/windows/","section":"Tags","summary":"","title":"Windows","type":"tags"},{"content":"ç»•è¿‡ä½¿ç”¨åŸç‰ˆ Windows 11 é•œåƒå®‰è£…æ—¶çš„ç¡¬ä»¶è¦æ±‚ï¼ˆTPM/SecureBootï¼‰\nä½¿ç”¨ Windows é•œåƒå¯åŠ¨ # Uç›˜å†™å…¥é•œåƒæˆ–è™šæ‹ŸæœºæŒ‚è½½é•œåƒå¯åŠ¨\næ‰“å¼€å‘½ä»¤æç¤ºç¬¦ # åœ¨ Windows å®‰è£…ç¨‹åºçš„è¯­è¨€é€‰æ‹©ç•Œé¢ï¼ŒæŒ‰ä¸‹ Shift+F10 æ‰“å¼€ CMD çª—å£\nç¼–è¾‘æ³¨å†Œè¡¨ # åœ¨ CMD ä¸­è¾“å…¥ regedit æ‰“å¼€æ³¨å†Œè¡¨ç¼–è¾‘å™¨\nè¿›å…¥ HKEY_LOCAL_MACHINE\\SYSTEM\\Setup\nå³é”® Setup é€‰æ‹© æ–°å»º-é¡¹ï¼Œé‡å‘½åä¸º LabConfig\nç‚¹å‡» LabConfigï¼Œåœ¨å³é¢çš„çª—å£å³é”®æ–°å»ºä¸€å…±ä¸‰ä¸ª DWORDï¼ˆ32ä½ï¼‰å€¼ï¼Œé‡å‘½åå¦‚ä¸‹ï¼Œå¹¶å°†ä»–ä»¬çš„æ•°å€¼æ•°æ®æ”¹ä¸º 1\n- BypassTPMCheck - BypassRAMCheck - BypassSecureBootCheck å…³é—­ CMD å’Œ æ³¨å†Œè¡¨ç¼–è¾‘å™¨ ç»§ç»­å®‰è£…ç³»ç»Ÿ # ","date":"2022-01-20","externalUrl":null,"permalink":"/posts/2022/win11-bypass/","section":"Posts","summary":"","title":"æ‰‹åŠ¨ç»•è¿‡ Windows 11 å®‰è£…ç¡¬ä»¶é™åˆ¶","type":"posts"},{"content":"","date":"2021-11-15","externalUrl":null,"permalink":"/tags/telegram/","section":"Tags","summary":"","title":"Telegram","type":"tags"},{"content":"ä½¿ç”¨ Bot åœ¨ Telegram åŠ QQ é—´è½¬å‘æ¶ˆæ¯ï¼ŒåŸºæœ¬å¯ä»¥åšåˆ°å» QQ åŒ–ï¼Œä»…åœ¨ Telegram ä¸Šä¸ QQ å¥½å‹/ç¾¤ç»„äº’åŠ¨\nç®€ä»‹ # ä½¿ç”¨ Bot åœ¨ Telegram åŠ QQ é—´è½¬å‘æ¶ˆæ¯ï¼ŒåŸºæœ¬å¯ä»¥åšåˆ°å» QQ åŒ–ï¼Œä»…åœ¨ Telegram ä¸Šä¸ QQ å¥½å‹/ç¾¤ç»„äº’åŠ¨\næœ¬é¡¹ç›®ä½¿ç”¨ Docker Compose ç®€åŒ–äº† Telegram Bot å’Œ QQ Bot çš„å®‰è£…ä¸é…ç½®ï¼Œä»…éœ€è¦ Docker Compose ä¸æµç•…çš„å›½é™…äº’è”ç½‘è¿æ¥å³å¯ä½¿ç”¨\nç¯å¢ƒè¦æ±‚ # Docker Docker Compose èƒ½ç¨³å®šè¿æ¥åˆ°TelegramæœåŠ¡å™¨çš„ç½‘ç»œ ä½¿ç”¨é¡¹ç›® # TG-EFB-QQ-Docker\nEFB-Docker\nEH Forwarder Bot Telegram Master QQ Slave QQ Plugin Mirai QQ Plugin go-cqhttp efb-filter-middleware Go-CQHttp-Docker\ngo-cqhttp é…ç½® # å…‹éš†é¡¹ç›® # # å…‹éš† git clone -b go-cqhttp https://github.com/sakarie9/TG-EFB-QQ-Docker.git # è¿›å…¥æ–‡ä»¶å¤¹ cd TG-EFB-QQ-Docker é…ç½®GOCQç«¯ # ç¼–è¾‘ gocq/config.yml é…ç½®æ–‡ä»¶\naccount: # è´¦å·ç›¸å…³ uin: 000000000 # QQ è´¦å· password: \u0026#39;\u0026#39; # QQ å¯†ç ï¼Œä¸ºç©ºæ—¶ä½¿ç”¨æ‰«ç ç™»å½• ï¼ˆå¯é€‰ï¼‰ä¿®æ”¹ç™»é™†åè®®ï¼Œè¿è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¾…æç¤ºç”Ÿæˆ device.json å ctrl+c é€€å‡ºï¼Œç¼–è¾‘ gocq/device.jsonï¼Œå‚è€ƒ è®¾å¤‡ä¿¡æ¯\ndocker run --rm -it --name=\u0026#34;gocq\u0026#34; -v $PWD/gocq:/data xzsk2/gocqhttp-docker:latest é…ç½®EFBç«¯ # è·å–token\nåˆ›å»ºä¸€ä¸ªBotï¼Œå‘ @BotFather å‘èµ·ä¼šè¯ï¼Œå‘é€æŒ‡ä»¤ /newbot å¼€å§‹åˆ›å»ºBotï¼Œåˆ›å»ºå®Œæˆåå¯è·å–token\næŸ¥çœ‹è‡ªå·±çš„Telegram ID\nå‘ @get_id_bot å‘é€/startï¼Œå¾—åˆ°çš„Chat IDå³ä¸ºç”¨æˆ·çš„Telegram ID\næ‰“å¼€./efb/profiles/default/blueset.telegram/config.yamlï¼Œä¿®æ”¹ä¸‹åˆ—å­—æ®µï¼Œtokenä¿®æ”¹ä¸ºä¸Šé¢è·å–åˆ°çš„Bot tokenï¼Œadminsä¿®æ”¹ä¸ºTelegram IDï¼Œæ³¨æ„æ ¼å¼\ntoken: 123456789:ABCDEFG1ABCDEFG1ABCDEFG1 admins: - 987654321 è¿è¡Œ # å¯åŠ¨ # docker-compose up -d å¦‚éœ€æ‰«ç ç™»é™†è¾“å…¥ docker logs gocq æŸ¥çœ‹äºŒç»´ç \nåœæ­¢ # docker-compose down è‡ªåŠ¨æ›´æ–° # docker run -d \\ --name watchtower \\ --restart unless-stopped \\ -v /var/run/docker.sock:/var/run/docker.sock \\ containrrr/watchtower -c \\ --interval 3600 \\ efb gocq æœ¬åœ°ä»£ç† # å¦‚æœä½ çš„æœåŠ¡å™¨ç¯å¢ƒå¯ä»¥è¿æ¥åˆ°TelegramæœåŠ¡å™¨ï¼Œå¯è·³è¿‡æœ¬ç« èŠ‚\næœ¬æ•™ç¨‹ä½¿ç”¨ ssr-command-client ä½œä¸ºæœ¬åœ°ä»£ç†ï¼Œå¯å‚è€ƒæ­¤é¡¹ç›®æ–‡æ¡£é…ç½®\nå®‰è£…\npip3 install shadowsocksr-cli ä½¿ç”¨\n# æ·»åŠ è®¢é˜…é“¾æ¥ shadowsocksr-cli --add-url ä½ çš„ssrè®¢é˜…é“¾æ¥ # æ›´æ–°è®¢é˜… shadowsocksr-cli -u # å¯åŠ¨ shadowsocksr-cli --fast-node ä¿®æ”¹EFBé…ç½®\nç¼–è¾‘./TG-EFB-QQ-Docker/efb/profile/default/blueset.telegram/config.yamlï¼Œæ·»åŠ ä»£ç†\ntoken: xxx:xxx admins: - xxxxxxxx # æ·»åŠ ä¸‹é¢çš„ä¸¤è¡Œ request_kwargs: proxy_url: socks5h://127.0.0.1:1080/ é‡å¯\ndocker-compose down docker-compose up -d å¸¸è§é—®é¢˜ # æ— æ³•å‘é€ç¾¤æ¶ˆæ¯ï¼Œåªèƒ½æ¥æ”¶ï¼Ÿ\næ— æ³•å‘é€å¤§äºä¸‰ä¸ªå­—ç¬¦çš„ç¾¤æ¶ˆæ¯ï¼Œæ¥æ”¶æ­£å¸¸ï¼›å¥½å‹æ¶ˆæ¯çš„æ”¶å‘æ­£å¸¸ã€‚è¿™ç§æƒ…å†µæ˜¯è§¦å‘äº†TXçš„é£æ§ï¼Œä¸€èˆ¬æœåŠ¡å™¨ä¸ŠæŒ‚12å°æ—¶-2å¤©å³å¯æ­£å¸¸\n","date":"2021-11-15","externalUrl":null,"permalink":"/posts/2021/tg-qq-gocq/","section":"Posts","summary":"","title":"Telegram æ”¶å‘ QQ ä¿¡æ¯ - EFB å’Œ GO-CQHTTP çš„ Docker éƒ¨ç½²æ•™ç¨‹","type":"posts"},{"content":"","date":"2021-05-08","externalUrl":null,"permalink":"/categories/archived/","section":"Categories","summary":"","title":"Archived","type":"categories"},{"content":" äº‘ç©ºè°ƒï¼Œä¾¿æºå°ç©ºè°ƒï¼Œä¸ºä½ çš„å¤æ—¥å¸¦å»æ¸…å‡‰ï¼\n","date":"2021-05-08","externalUrl":null,"permalink":"/posts/2021/air-conditioner-room/","section":"Posts","summary":"","title":"ç©ºè°ƒæˆ¿","type":"posts"},{"content":"ä½¿ç”¨ Bot åœ¨ Telegram åŠ QQ é—´è½¬å‘æ¶ˆæ¯ï¼ŒåŸºæœ¬å¯ä»¥åšåˆ°å» QQ åŒ–ï¼Œä»…åœ¨ Telegram ä¸Šä¸ QQ å¥½å‹/ç¾¤ç»„äº’åŠ¨\nç®€ä»‹ # ä½¿ç”¨ Bot åœ¨ Telegram åŠ QQ é—´è½¬å‘æ¶ˆæ¯ï¼ŒåŸºæœ¬å¯ä»¥åšåˆ°å» QQ åŒ–ï¼Œä»…åœ¨ Telegram ä¸Šä¸ QQ å¥½å‹/ç¾¤ç»„äº’åŠ¨\næœ¬é¡¹ç›®ä½¿ç”¨ Docker Compose ç®€åŒ–äº† Telegram Bot å’Œ QQ Bot çš„å®‰è£…ä¸é…ç½®ï¼Œä»…éœ€è¦ Docker Compose ä¸æµç•…çš„å›½é™…äº’è”ç½‘è¿æ¥å³å¯ä½¿ç”¨\næœ¬æ•™ç¨‹ä¸º Mirai ç‰ˆæœ¬ï¼Œæ¨èä½¿ç”¨æ–°ç‰ˆ\nTelegram æ”¶å‘ QQ ä¿¡æ¯ - EFB å’Œ GO-CQHTTP çš„ Docker éƒ¨ç½²æ•™ç¨‹ 2021-11-15\u0026middot;850 å­— æŠ€æœ¯åˆ†äº« Linux Docker Telegram ç¯å¢ƒè¦æ±‚ # Docker Docker Compose èƒ½ç¨³å®šè¿æ¥åˆ°TelegramæœåŠ¡å™¨çš„ç½‘ç»œ ä½¿ç”¨é¡¹ç›® # TG-EFB-QQ-Docker\nEFB-Docker\nEH Forwarder Bot Telegram Master QQ Slave QQ Plugin Mirai Mirai-Docker\nMirai Console Loader mirai-api-http é…ç½® # å…‹éš†é¡¹ç›® # # å…‹éš† git clone -b mirai https://github.com/xzsk2/TG-EFB-QQ-Docker.git # è¿›å…¥æ–‡ä»¶å¤¹ cd TG-EFB-QQ-Docker é…ç½®Miraiç«¯ # ç¼–è¾‘./mirai/config/net.mamoe.mirai-api-http/setting.ymlï¼Œä¿®æ”¹authKeyï¼Œæœ€å°‘8ä½ï¼Œè®°ä¸‹è¿™ä¸ªauthKeyï¼Œä¼šåœ¨ä¸‹é¢é…ç½®EFBçš„è¿‡ç¨‹ä¸­ç”¨åˆ°\nauthKey: xxxxxxxx é…ç½®EFBç«¯ # è·å–token\nåˆ›å»ºä¸€ä¸ªBotï¼Œå‘ @BotFather å‘èµ·ä¼šè¯ï¼Œå‘é€æŒ‡ä»¤ /newbot å¼€å§‹åˆ›å»ºBotï¼Œåˆ›å»ºå®Œæˆåå¯è·å–token\næŸ¥çœ‹è‡ªå·±çš„Telegram ID\nå‘ @get_id_bot å‘é€/startï¼Œå¾—åˆ°çš„Chat IDå³ä¸ºç”¨æˆ·çš„Telegram ID\næ‰“å¼€./efb/profiles/default/blueset.telegram/config.yamlï¼Œä¿®æ”¹ä¸‹åˆ—å­—æ®µï¼Œtokenä¿®æ”¹ä¸ºä¸Šé¢è·å–åˆ°çš„Bot tokenï¼Œadminsä¿®æ”¹ä¸ºTelegram IDï¼Œæ³¨æ„æ ¼å¼\ntoken: 123456789:ABCDEFG1ABCDEFG1ABCDEFG1 admins: - 987654321 æ‰“å¼€./efb/profiles/default/milkice.qq/config.yamlï¼Œä¿®æ”¹qqå’ŒauthKey\nClient: mirai mirai: qq: xxxxxxxx # è¿™é‡Œæ¢æˆç™»å½•çš„ QQ å· host: \u0026#34;mirai\u0026#34; # è¿™ä¸ªä¸è¦æ”¹ port: 8080 # åŒä¸Š authKey: \u0026#34;xxxxxxxx\u0026#34; # è¿™é‡Œå¡«å…¥åœ¨é…ç½® Mirai API HTTP æ—¶ç”Ÿæˆçš„ authKey è¿è¡Œ # ç™»å½•QQï¼Œåœ¨docker-compose.ymlæ–‡ä»¶å¤¹ä¸‹è¿è¡Œ\ndocker run --rm -it --name=\u0026#34;mirai\u0026#34; -p 8080:8080 -v $PWD/mirai/config:/app/config -v $PWD/mirai/bots:/app/bots xzsk2/mirai-docker:latest ä½¿ç”¨/loginç™»å½•è´¦å·\n/login \u0026lt;qq\u0026gt; \u0026lt;password\u0026gt; # ç™»å½•ä¸€ä¸ªè´¦å· å‡ºç°Login successfulåç™»å½•æˆåŠŸï¼Œå†æ¬¡è¿è¡Œ\ndocker run --rm -it --name=\u0026#34;mirai\u0026#34; -p 8080:8080 -v $PWD/mirai/config:/app/config -v $PWD/mirai/bots:/app/bots xzsk2/mirai-docker:latest ä½¿ç”¨/autologinè®¾ç½®è‡ªåŠ¨ç™»å½•\n/autoLogin add \u0026lt;account\u0026gt; \u0026lt;password\u0026gt; # æ·»åŠ è‡ªåŠ¨ç™»å½• ä¹‹åä½¿ç”¨CTRL+Cé€€å‡ºå®¹å™¨ï¼Œä½¿ç”¨docker-composeå¯åŠ¨\ndocker-compose up -d æœ¬åœ°ä»£ç† # å¦‚æœä½ çš„æœåŠ¡å™¨ç¯å¢ƒå¯ä»¥è¿æ¥åˆ°TelegramæœåŠ¡å™¨ï¼Œå¯è·³è¿‡æœ¬ç« èŠ‚\næœ¬æ•™ç¨‹ä½¿ç”¨ ssr-command-client ä½œä¸ºæœ¬åœ°ä»£ç†ï¼Œå¯å‚è€ƒæ­¤é¡¹ç›®æ–‡æ¡£é…ç½®\nå®‰è£…\npip3 install shadowsocksr-cli ä½¿ç”¨\n# æ·»åŠ è®¢é˜…é“¾æ¥ shadowsocksr-cli --add-url ä½ çš„ssrè®¢é˜…é“¾æ¥ # æ›´æ–°è®¢é˜… shadowsocksr-cli -u # å¯åŠ¨ shadowsocksr-cli --fast-node # ä¿®æ”¹ç›‘å¬åœ°å€ shadowsocksr-cli --setting-address 0.0.0.0 ä¿®æ”¹EFBé…ç½®\nç¼–è¾‘./TG-EFB-QQ-Docker/efb/profile/default/blueset.telegram/config.yamlï¼Œæ·»åŠ ä»£ç†\ntoken: xxx:xxx admins: - xxxxxxxx # æ·»åŠ ä¸‹é¢çš„ä¸¤è¡Œ request_kwargs: proxy_url: socks5h://172.17.0.1:1080/ é‡å¯\ndocker-compose down docker-compose up -d å¸¸è§é—®é¢˜ # Miraiç™»é™†å¤±è´¥/éªŒè¯ç /ç‰ˆæœ¬è¿‡ä½ï¼Ÿ\nè¯·å°è¯•å…ˆåœ¨æœ¬åœ°æ¡Œé¢ç¯å¢ƒä¸‹éƒ¨ç½²Miraiï¼Œå¦‚éœ€è¦æ»‘åŠ¨éªŒè¯ç è¯·ä½¿ç”¨ mirai-login-solver-seleniumï¼Œæˆ–ä¿®æ”¹ç™»å½•åè®®\næ— æ³•å‘é€ç¾¤æ¶ˆæ¯ï¼Œåªèƒ½æ¥æ”¶ï¼Ÿ\næ— æ³•å‘é€å¤§äºä¸‰ä¸ªå­—ç¬¦çš„ç¾¤æ¶ˆæ¯ï¼Œæ¥æ”¶æ­£å¸¸ï¼›å¥½å‹æ¶ˆæ¯çš„æ”¶å‘æ­£å¸¸ã€‚è¿™ç§æƒ…å†µæ˜¯è§¦å‘äº†TXçš„é£æ§ï¼Œä¸€èˆ¬æœåŠ¡å™¨ä¸ŠæŒ‚12å°æ—¶-2å¤©å³å¯æ­£å¸¸\n","date":"2021-05-05","externalUrl":null,"permalink":"/posts/2021/tg-qq-mirai/","section":"Posts","summary":"","title":"ï¼ˆæ—§ï¼‰Telegram æ”¶å‘ QQ ä¿¡æ¯ - EFB å’Œ Mirai çš„ Docker éƒ¨ç½²æ•™ç¨‹","type":"posts"},{"content":" ç—‡çŠ¶ # åœ¨ä½¿ç”¨Chrome+SwitchyOmega+Clashçš„ç¯å¢ƒä¸‹ï¼ŒSwitchyOmegaçš„â€œä»£ç†â€æ“ä½œä¼šå°†ä»£ç†è¯·æ±‚å‘é€è‡³Clashï¼Œç”±Clashåˆ¤æ–­æ˜¯å¦ä½¿ç”¨ä»£ç†ã€‚è¿™æ ·å°±é€ æˆäº†ç”¨æˆ·æƒ³è¦æŸä¸ªåŸŸåèµ°ä»£ç†ï¼Œä½†æ˜¯Clashè§„åˆ™ä¸­é»˜è®¤è¯¥åŸŸåç›´è¿ï¼Œæœ€ç»ˆè¿˜æ˜¯ç›´è¿çš„æƒ…å†µã€‚\nè§£å†³æ–¹æ¡ˆ # Clashé…ç½® # é…ç½®Clashå°†æ¥è‡ªChromeçš„æµé‡å…¨éƒ¨ä½¿ç”¨ä»£ç†\nè¿›å…¥Clashçš„Settingsé¡µé¢ï¼Œé€‰æ‹©Profilesä¸‹çš„Parsersï¼Œç¼–è¾‘é…ç½®æ–‡ä»¶é¢„å¤„ç†ï¼Œå‚è€ƒ é…ç½®æ–‡ä»¶é¢„å¤„ç†\nå…¶ä¸­URLä¿®æ”¹ä¸ºé…ç½®æ–‡ä»¶çš„URLï¼ŒèŠ‚ç‚¹é€‰æ‹©ä¿®æ”¹ä¸ºé…ç½®æ–‡ä»¶å†…çš„proxy-groupsä¸‹çš„nameï¼Œæ ¹æ®æƒ…å†µé€‰æ‹©\nparsers: # array - url: URL yaml: prepend-rules: - PROCESS-NAME,chrome.exe,èŠ‚ç‚¹é€‰æ‹© SwitchyOmegaé…ç½® # è®¾ç½®è‡ªåŠ¨åˆ‡æ¢è§„åˆ™ï¼Œå¯ä»¥å‚è€ƒ Proxy SwitchyOmega é…ç½®\næ³¨æ„åœ¨SwitchyOmegaå†…è®¾ç½®ä¸ºç›´è¿çš„åŸŸåå°†ä¸ç»è¿‡Clashç›´æ¥è®¿é—®ï¼Œè®¾ç½®ä¸ºä»£ç†çš„åŸŸåå°†æ— è§†Clashè§„åˆ™ç›´æ¥ä»£ç†\n","date":"2021-04-03","externalUrl":null,"permalink":"/posts/2021/chrome-clash/","section":"Posts","summary":"","title":"Chrome+SwitchyOmega+Clashçš„å¤„ç†","type":"posts"},{"content":" tsæ–‡ä»¶å¡æ­»æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿtsæ–‡ä»¶ç›¸ä¿¡å¤§å®¶éƒ½å¾ˆç†Ÿæ‚‰ï¼Œä½†æ˜¯å¡æ­»æ˜¯æ€ä¹ˆå›äº‹å‘¢ï¼Ÿä¸‹é¢å°±è®©å°ç¼–å¸¦å¤§å®¶ä¸€èµ·äº†è§£å§ã€‚ tsæ–‡ä»¶å¡æ­»ï¼Œå…¶å®å°±æ˜¯å¡æ­»äº†ã€‚é‚£ä¹ˆtsæ–‡ä»¶ä¸ºä»€ä¹ˆä¼šå¡æ­»ï¼Œç›¸ä¿¡å¤§å®¶éƒ½å¾ˆå¥½å¥‡æ˜¯æ€ä¹ˆå›äº‹ã€‚å¤§å®¶å¯èƒ½ä¼šæ„Ÿåˆ°å¾ˆæƒŠè®¶ï¼Œtsæ–‡ä»¶æ€ä¹ˆä¼šå¡æ­»å‘¢ï¼Ÿä½†äº‹å®å°±æ˜¯è¿™æ ·ï¼Œå°ç¼–ä¹Ÿæ„Ÿåˆ°éå¸¸æƒŠè®¶ã€‚é‚£ä¹ˆè¿™å°±æ˜¯å…³äºtsæ–‡ä»¶å¡æ­»çš„äº‹æƒ…äº†ï¼Œå¤§å®¶æœ‰æ²¡æœ‰è§‰å¾—å¾ˆç¥å¥‡å‘¢ï¼Ÿ çœ‹äº†ä»Šå¤©çš„å†…å®¹ï¼Œå¤§å®¶æœ‰ä»€ä¹ˆæƒ³æ³•å‘¢ï¼Ÿæ¬¢è¿åœ¨è¯„è®ºåŒºå‘Šè¯‰å°ç¼–ä¸€èµ·è®¨è®ºå“¦ã€‚\nç—‡çŠ¶ # å³é”®å¤§å°è¾ƒå¤§çš„.tsæ–‡ä»¶ç»å¸¸ä¼šå‡ºç°èµ„æºç®¡ç†å™¨å¡æ­»æˆ–é•¿æ—¶é—´æœªå“åº”çš„æƒ…å†µ\nè§£å†³ # æš´åŠ›æ–¹æ¡ˆ # ç›´æ¥åˆ é™¤mfmpeg2srcsnk.dll\næ­£å¸¸æ–¹æ¡ˆ # ä¸‹è½½å¹¶æ‰“å¼€ shexview ï¼Œæ‰¾åˆ°MF MPEG Property Handlerï¼Œå³é”®Disableå³å¯\nIcaros # ä½¿èµ„æºç®¡ç†å™¨æ”¯æŒæ‰€æœ‰åª’ä½“æ ¼å¼çš„ç¼©ç•¥å›¾ä»¥åŠè¯¦ç»†ä¿¡æ¯çš„è½¯ä»¶\nä¸‹è½½é“¾æ¥\nå¯ç”¨å‰ å¯ç”¨å ","date":"2021-03-22","externalUrl":null,"permalink":"/posts/2021/windows-ts/","section":"Posts","summary":"","title":"Windows10 å³é”® ts æ–‡ä»¶å¡æ­»","type":"posts"},{"content":" PowerShell # 1. åœ¨ PowerShell çª—å£ä¸­è¿è¡Œå¦‚ä¸‹æŒ‡ä»¤ # if (!(Test-Path -Path $PROFILE )) { New-Item -Type File -Path $PROFILE -Force } notepad $PROFILE 2. åœ¨æ‰“å¼€çš„è®°äº‹æœ¬ä¸­æ·»åŠ å¦‚ä¸‹ä»£ç  # æ³¨æ„ä¿®æ”¹ç¬¬ä¹è¡Œä»£ç†åœ°å€\n# Set-Proxy command if ($env:HTTP_PROXY -ne $null){ Write-Output \u0026#34;Proxy Enabled as $env:HTTP_PROXY\u0026#34;; } Function SetProxy() { Param( # æ”¹æˆè‡ªå·±çš„ä»£ç†åœ°å€ $Addr = \u0026#39;http://127.0.0.1:19810\u0026#39;, [switch]$ApplyToSystem ) $env:HTTP_PROXY = $Addr; $env:HTTPS_PROXY = $Addr; $env:http_proxy = $Addr; $env:https_proxy = $Addr; [Net.WebRequest]::DefaultWebProxy = New-Object Net.WebProxy $Addr; if ($ApplyToSystem) { $matchedResult = ValidHttpProxyFormat $Addr; # Matched result: [URL Without Protocol][Input String] if (-not ($matchedResult -eq $null)) { SetSystemProxy $matchedResult.1; } } Write-Output \u0026#34;Successful set proxy as $Addr\u0026#34;; } Function ClearProxy() { Param( $Addr = $null, [switch]$ApplyToSystem ) $env:HTTP_PROXY = $Addr; $env:HTTPS_PROXY = $Addr; $env:http_proxy = $Addr; $env:https_proxy = $Addr; [Net.WebRequest]::DefaultWebProxy = New-Object Net.WebProxy; if ($ApplyToSystem) { SetSystemProxy $null; } Write-Output \u0026#34;Successful unset all proxy variable\u0026#34;; } Function SetSystemProxy($Addr = $null) { Write-Output $Addr $proxyReg = \u0026#34;HKCU:\\Software\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\u0026#34;; if ($Addr -eq $null) { Set-ItemProperty -Path $proxyReg -Name ProxyEnable -Value 0; return; } Set-ItemProperty -Path $proxyReg -Name ProxyServer -Value $Addr; Set-ItemProperty -Path $proxyReg -Name ProxyEnable -Value 1; } Function ValidHttpProxyFormat ($Addr) { $regex = \u0026#34;(?:https?:\\/\\/)(\\w+(?:.\\w+)*(?::\\d+)?)\u0026#34;; $result = $Addr -match $regex; if ($result -eq $false) { throw [System.ArgumentException]\u0026#34;The input $Addr is not a valid HTTP proxy URI.\u0026#34;; } return $Matches; } Set-Alias set-proxy SetProxy Set-Alias clear-proxy ClearProxy 3. ä¿å­˜ï¼Œé‡æ–°æ‰“å¼€PowerShell # è®¾ç½®å½“å‰çª—å£ä»£ç† ï¼šset-proxy\nè®¾ç½®å½“å‰çª—å£ä»£ç† + ç³»ç»Ÿä»£ç†ï¼šset-proxy -ApplyToSystem\nå–æ¶ˆå½“å‰çª—å£ä»£ç†ï¼šclear-proxy\nå–æ¶ˆå½“å‰çª—å£ä»£ç† + ç³»ç»Ÿä»£ç†ï¼šclear-proxy -ApplyToSystem\nset-proxyå’ŒSetProxyï¼Œclear-proxyå’ŒClearProxyå¯ä»¥äº’ç›¸æ›¿æ¢\nCMD # è®¾ç½®ä»£ç†ï¼Œçª—å£å…³é—­åå¤±æ•ˆ\nset http_proxy=http://127.0.0.1:19810 set https_proxy=http://127.0.0.1:19810 Git # è®¾ç½®Httpä»£ç†ï¼Œæ°¸ä¹…ç”Ÿæ•ˆ\ngit config --global https.proxy https://127.0.0.1:19810 git config --global http.proxy http://127.0.0.1:19810 å–æ¶ˆä»£ç†\ngit config --global --unset http.proxy git config --global --unset https.proxy ","date":"2021-03-17","externalUrl":null,"permalink":"/posts/2021/windows-proxy/","section":"Posts","summary":"","title":"Windows ä¸‹ä¸º PowerShell/CMD/Git è®¾ç½®ä»£ç†","type":"posts"},{"content":"æµ‹è¯•å¹³å°ï¼šOpenwrt\nåœ¨/etc/hotplug.d/iface/ä¸‹æ·»åŠ 30-routesæ–‡ä»¶,ç³»ç»Ÿå°†åœ¨æ¥å£çŠ¶æ€å‘ç”Ÿç”Ÿå˜åŒ–æ—¶æ‰§è¡Œè¯¥è„šæœ¬ã€‚\nç„¶ååœ¨30-routesä¸­å†™å…¥\n#!/bin/sh if [ \u0026#34;$ACTION\u0026#34; = \u0026#34;ifdown\u0026#34; -a \u0026#34;$INTERFACE\u0026#34; = \u0026#34;pptp-vpn0\u0026#34; ] then #åœ¨æ­¤æ·»åŠ æ–­å¼€åçš„ä»£ç  fi if [ \u0026#34;$ACTION\u0026#34; = \u0026#34;ifup\u0026#34; -a \u0026#34;$INTERFACE\u0026#34; = \u0026#34;pptp-vpn0\u0026#34; ] then #åœ¨æ­¤æ·»åŠ è¿æ¥åéœ€è¦æ‰§è¡Œçš„ä»£ç  fi æŠŠpptp-vpn0ä¿®æ”¹ä¸ºè‡ªå·±æƒ³è¦çš„æ¥å£åã€‚\næ¯”å¦‚æˆ‘ç°åœ¨éœ€è¦åœ¨pptp-vpn0æ–­å¼€åè‡ªåŠ¨æ·»åŠ 192.168.0.1ä¸ºé»˜è®¤è·¯ç”±ï¼Œåˆ™è®¾ç½®å¦‚ä¸‹\nif [ \u0026#34;$ACTION\u0026#34; = \u0026#34;ifdown\u0026#34; -a \u0026#34;$INTERFACE\u0026#34; = \u0026#34;virtual**\u0026#34; ] then route add default gw 192.168.0.1 fi åŠ å…¥äº†ä¸€è¡Œroute add default gw 192.168.0.1\n","date":"2018-10-19","externalUrl":null,"permalink":"/posts/2018/pptp-route/","section":"Posts","summary":"","title":"å¦‚ä½•è®©pptpè¿æ¥/æ–­å¼€åè‡ªåŠ¨æ·»åŠ è·¯ç”±","type":"posts"},{"content":"ç¬¬åä¸€å±Šæ²³å—çœACMç¨‹åºè®¾è®¡ç«èµ› Ié¢˜\n#include \u0026#34;stdafx.h\u0026#34; #include \u0026lt;iostream\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;cstring\u0026gt; using namespace std; long long source[101][101];//åŸå§‹çŸ©é˜µ long long sourcesum; long long newm[101][101];//æ–°çŸ©é˜µ int m, n; long long a[101], b[101];//aä¸ºæ¯è¡Œçš„æœ€å¤§æ•°ï¼Œbä¸ºæ¯åˆ—æœ€å¤§æ•° bool av[101], bv[101];//visited long long minsum; //æ—¶é—´åˆ¤æ–­å˜é‡å®šä¹‰ long long totaltime = 0; int requiretime = 0; int T; struct zeroSave { int x; int y; }; vector\u0026lt;zeroSave\u0026gt; zs; //åˆå§‹åŒ– void init() { memset(source, -1, sizeof(source)); memset(newm, -1, sizeof(newm)); memset(a, 0, sizeof(a)); memset(b, 0, sizeof(b)); memset(av, 0, sizeof(av)); memset(bv, 0, sizeof(bv)); minsum = 0; sourcesum = 0; zs.clear(); zs.push_back({ 0 }); } //çŸ©é˜µè¾“å…¥ void input() { cin \u0026gt;\u0026gt; totaltime \u0026gt;\u0026gt; requiretime; cin \u0026gt;\u0026gt; m \u0026gt;\u0026gt; n; for (int i = 1; i \u0026lt;= m; i++) for (int j = 1; j \u0026lt;= n; j++) { int tmp = 0; cin \u0026gt;\u0026gt; tmp; source[i][j] = tmp; sourcesum += tmp; if (!tmp) { newm[i][j] = 0; } } } //æ¯è¡Œæ¯åˆ—æœ€å¤§å€¼è®¡ç®— void maxcal() { long long max; for (int i = 1; i \u0026lt;= m; i++) { max = 0; for (int j = 1; j \u0026lt;= n; j++) { if (max \u0026lt; source[i][j]) max = source[i][j]; } a[i] = max; } for (int j = 1; j \u0026lt;= n; j++) { max = 0; for (int i = 1; i \u0026lt;= m; i++) { if (max \u0026lt; source[i][j]) max = source[i][j]; } b[j] = max; } } //çŸ©é˜µæ„é€  void construct() { //ä»ä¸»è§†å›¾å’Œå·¦è§†å›¾çœ‹ï¼Œæœ€ä¼˜çŸ©é˜µç”Ÿæˆ for (int i = 1; i \u0026lt;= m; i++) for (int j = 1; j \u0026lt;= n; j++) if (a[i] == b[j] \u0026amp;\u0026amp; bv[j] == 0) { av[i] = 1; bv[j] = 1; if (source[i][j] != 0) { newm[i][j] = a[i]; break; } else {//ç¢°åˆ°åˆå¹¶åˆ°0çš„æƒ…å†µå…ˆä¿å­˜ï¼Œåé¢å¤„ç† zeroSave temp; temp.x = i; temp.y = j; zs.push_back(temp); break; } } //å‰©ä½™æœ€å¤§å€¼æ’å…¥ //è¡Œå‰©ä½™å¤„ç† for (int i = 1; i \u0026lt;= m; i++) { if (av[i] == 1) continue; for (int j = 1; j \u0026lt;= n; j++) { if (a[i] \u0026lt;= b[j] \u0026amp;\u0026amp; source[i][j] != 0) { newm[i][j] = a[i]; av[i] = 1; break; } } } //åˆ—å‰©ä½™å¤„ç† for (int j = 1; j \u0026lt;= n; j++) { if (bv[j] == 1) continue; for (int i = 1; i \u0026lt;= m; i++) { if (b[j] \u0026lt;= a[i] \u0026amp;\u0026amp; source[i][j] != 0) { newm[i][j] = b[j]; bv[j] = 1; break; } } } } //å¯¹æœ€å¤§å€¼åˆå¹¶åˆ°0ä¸Šæ—¶çš„å¤„ç† void zero() { for (unsigned k = 1; k \u0026lt; zs.size(); k++) { int flag = 0; //æŸ¥è¯¢å½“å‰0çš„æ¨ªæ–¹å‘ä¸Šæ˜¯å¦æœ‰è·Ÿæœ€å¤§å€¼ç›¸ç­‰çš„æ•° for (int i = 1; i \u0026lt;= n; i++) { if (a[zs[k].x] == b[i] \u0026amp;\u0026amp; i != zs[k].y)//å¦‚æœå­˜åœ¨ { flag = 1; break; } } if (flag == 0)//å¦‚æœä¸å­˜åœ¨ { //æ¨ªå‘åˆ†æ•£ for (int i = 1; i \u0026lt;= n; i++) if (newm[zs[k].x][i] == -1) { newm[zs[k].x][i] = a[zs[k].x]; break; } //çºµå‘åˆ†æ•£ for (int i = 1; i \u0026lt;= m; i++) if (newm[i][zs[k].y] == -1) { newm[i][zs[k].y] = b[zs[k].y]; break; } } } } //è®¡ç®—æ–°çŸ©é˜µå¤§å° void newMatrixSum() { minsum = 0; for (int i = 1; i \u0026lt;= m; i++) for (int j = 1; j \u0026lt;= n; j++) if (newm[i][j] != -1) minsum += newm[i][j]; else { minsum++; newm[i][j] = 1; } } //ojè¾“å‡º void oj() { cin \u0026gt;\u0026gt; T; long long diff; while (T--) { init(); input(); maxcal(); construct(); zero(); newMatrixSum(); diff = sourcesum - minsum; if (totaltime / (double)requiretime \u0026gt; diff) { cout \u0026lt;\u0026lt; diff \u0026lt;\u0026lt; endl; } else { cout \u0026lt;\u0026lt; totaltime / requiretime \u0026lt;\u0026lt; endl; } } } int main() { oj(); system(\u0026#34;pause\u0026#34;); } ","date":"2018-06-05","externalUrl":null,"permalink":"/posts/2018/zznuoj-2113/","section":"Posts","summary":"","title":"Image Recognition","type":"posts"},{"content":"é›·è¾¾å®‰è£…\npoj1328\nä»¥å²›å±¿ä¸ºåœ†å¿ƒï¼Œé›·è¾¾èŒƒå›´ä¸ºåŠå¾„ï¼Œè®¡ç®—æ­¤åœ†ä¸xè½´äº¤ç‚¹çš„çº¿æ®µï¼Œä»¥æ­¤æŠŠæ‰€æœ‰å²›å±¿çš„åŒºé—´è®¡ç®—å‡ºæ¥ã€‚\nå› æ­¤ï¼Œè¿™é“é¢˜å°±å˜æˆäº†åœ¨æ•°è½´ä¸Šé€‰æœ€å°‘çš„ç‚¹ï¼Œè¦†ç›–ç»™å®šçº¿æ®µã€‚\næŠŠæ¯æ¡çº¿æ®µä»¥å³ç«¯ç‚¹æ’åºï¼Œç„¶åè¿›è¡Œé€‰æ‹©å³å¯ã€‚\nsqrtå‡½æ•°ä½¿ç”¨æ—¶è¦ä¿è¯æ•°æ®ç±»å‹ä¸€è‡´ã€‚\næ³¨æ„è¾“å‡ºæ ¼å¼ä»¥åŠCaseçš„Cè¦å¤§å†™= =\n#include \u0026#34;stdafx.h\u0026#34; #include \u0026lt;iostream\u0026gt; #include \u0026lt;algorithm\u0026gt; #include \u0026lt;cmath\u0026gt; using namespace std; struct radarRange { double left; double right; bool operator \u0026lt; (const radarRange \u0026amp;x) const //\u0026lt;é‡è½½ï¼Œç”¨äºsortå‡½æ•° { if (right != x.right) return right \u0026lt; x.right; return left \u0026lt; x.left; } }; struct islandPosition { int x; int y; }; int radar() { int n, d; cin \u0026gt;\u0026gt; n \u0026gt;\u0026gt; d; if (n == 0 \u0026amp;\u0026amp; d == 0) return -2; islandPosition *p = new islandPosition[n]; radarRange *r = new radarRange[n]; for (int i = 0; i \u0026lt; n; i++) { cin \u0026gt;\u0026gt; p[i].x \u0026gt;\u0026gt; p[i].y; } if (d == 0) return -1; for (int i = 0; i \u0026lt; n; i++) if (p[i].y \u0026gt; d) { return -1; } for (int i = 0; i \u0026lt; n; i++)//è®¡ç®—é›·è¾¾å®‰è£…èŒƒå›´ { double tmp = sqrt(double(d *d) - double(p[i].y * p[i].y)); r[i].left = p[i].x - tmp; r[i].right = p[i].x + tmp; } //for (int i = 0; i \u0026lt; n; i++)//debug //{ //\tcout \u0026lt;\u0026lt; r[i].left \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; r[i].right \u0026lt;\u0026lt; endl; //} sort(r, r + n); //for (int i = 0; i \u0026lt; n; i++)//debug //{ //\tcout \u0026lt;\u0026lt; r[i].left \u0026lt;\u0026lt; \u0026#39; \u0026#39; \u0026lt;\u0026lt; r[i].right \u0026lt;\u0026lt; endl; //} double start, end; int sum = 1; start = r[0].left; end = r[0].right; for (int i = 1; i \u0026lt; n; i++)//è®¡ç®—æ‰€éœ€é›·è¾¾æ•° { if (r[i].left \u0026lt;= end \u0026amp;\u0026amp; r[i].left \u0026gt;= start) { start = r[i].left; } /*if (r[i].left \u0026lt;= end \u0026amp;\u0026amp; r[i].left \u0026lt; start) { ; }*/ if (r[i].left \u0026gt; end) { start = r[i].left; end = r[i].right; sum++; } } delete[] p; delete[] r; return sum; } int main() { int tmp; int sum = 1; while (1) { tmp = radar(); if (tmp == -2) break; cout \u0026lt;\u0026lt; \u0026#34;Case \u0026#34; \u0026lt;\u0026lt; sum++ \u0026lt;\u0026lt; \u0026#34;: \u0026#34; \u0026lt;\u0026lt; tmp \u0026lt;\u0026lt; endl; } system(\u0026#34;pause\u0026#34;); } /* Sample Input 3 2 1 2 -3 1 2 1 1 2 0 2 0 0 Sample Output Case 1: 2 Case 2: 1 */ ","date":"2018-05-07","externalUrl":null,"permalink":"/posts/2018/1328/","section":"Posts","summary":"","title":"poj1328 é›·è¾¾å®‰è£…","type":"posts"},{"content":"æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦\npoj.org 1458\nçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦C++ä»£ç å®ç°ï¼š\n#include \u0026lt;iostream\u0026gt; #include \u0026lt;string\u0026gt; #include \u0026lt;vector\u0026gt; #include \u0026lt;algorithm\u0026gt; using namespace std; int LCS(string a, string b) { int la, lb; la = a.length(); lb = b.length(); vector\u0026lt;vector\u0026lt;int\u0026gt;\u0026gt; c(la + 1, vector\u0026lt;int\u0026gt;(lb + 1, 0)); for (int i = 1; i \u0026lt;= la; i++) for (int j = 1; j \u0026lt;= lb; j++) { if (a[i - 1] == b[j - 1]) c[i][j] = c[i - 1][j - 1] + 1; else c[i][j] = max(c[i - 1][j], c[i][j - 1]); } return c[la][lb]; } int main() { string a, b; while (cin \u0026gt;\u0026gt; a \u0026gt;\u0026gt; b) { cout \u0026lt;\u0026lt; LCS(a, b) \u0026lt;\u0026lt; endl; } return 0; } ","date":"2018-04-21","externalUrl":null,"permalink":"/posts/2018/1458/","section":"Posts","summary":"","title":"poj1458 æœ€é•¿å…¬å…±å­åºåˆ—é•¿åº¦","type":"posts"},{"content":"Primç®—æ³•\npoj.org 2485.\n#include \u0026#34;stdafx.h\u0026#34; #include \u0026lt;iostream\u0026gt; using namespace std; #define MAX 1000 #define MAXCOST 0x3f3f3f3f int graph[MAX][MAX]; int prim(int graph[][MAX], int n) //né¡¶ç‚¹ä¸ªæ•° { int lowcost[MAX]; //lowcost[i]:ä»¥iä¸ºç»ˆç‚¹çš„è¾¹çš„æœ€å°æƒå€¼,lowcost[i]=0è¡¨ç¤ºiç‚¹åŠ å…¥äº†MST int mst[MAX]; //mst[i]:å¯¹åº”lowcost[i]çš„èµ·ç‚¹,mst[i]=0è¡¨ç¤ºèµ·ç‚¹iåŠ å…¥MST int i, j, min, minid; int max = 0; for (i = 2; i \u0026lt;= n; i++) { lowcost[i] = graph[1][i]; //ä»1å¼€å§‹åˆ°æ‰€æœ‰ç‚¹çš„æƒå€¼ mst[i] = 1; //å¯¹åº”lowcost[i]çš„èµ·ç‚¹ä¸º1 } mst[1] = 0; //1ç‚¹åœ¨MSTä¸­ for (i = 2; i \u0026lt;= n; i++) { min = MAXCOST; //minä¸ºæœ€å°æƒå€¼ minid = 0; //æœ€å°æƒå€¼å¯¹åº”çš„ç‚¹ for (j = 2; j \u0026lt;= n; j++) { if (lowcost[j] \u0026lt; min \u0026amp;\u0026amp; lowcost[j] != 0) { min = lowcost[j]; minid = j; } } //è¾“å‡ºç¤ºä¾‹V1-V3=1 if (min \u0026gt; max) max = min; //æœ€å°æƒå€¼ç´¯åŠ  lowcost[minid] = 0; //åŠ å…¥MST for (j = 2; j \u0026lt;= n; j++) //æ›´æ–°lowcost[]å’Œmst[] { if (graph[minid][j] \u0026lt; lowcost[j] \u0026amp;\u0026amp; lowcost[j] != 0) { lowcost[j] = graph[minid][j]; mst[j] = minid; } } } return max; } int main() { int T; int s; int sum; memset(graph, MAXCOST, sizeof(graph)); scanf(\u0026#34;%d\u0026#34;, \u0026amp;T); while (T--) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;s); for (int i = 1; i \u0026lt; s + 1; i++) for (int j = 1; j \u0026lt; s + 1; j++) { scanf(\u0026#34;%d\u0026#34;, \u0026amp;graph[i][j]); if (!graph[i][j]) graph[i][j] = MAXCOST; } sum = prim(graph, s); cout \u0026lt;\u0026lt; sum \u0026lt;\u0026lt; endl; } system(\u0026#34;pause\u0026#34;); } ","date":"2018-03-22","externalUrl":null,"permalink":"/posts/2018/2485/","section":"Posts","summary":"","title":"poj2485 Primç®—æ³•","type":"posts"},{"content":" About Me # About Site # ","externalUrl":null,"permalink":"/about/","section":"Sakari's Blog","summary":"","title":"About","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]